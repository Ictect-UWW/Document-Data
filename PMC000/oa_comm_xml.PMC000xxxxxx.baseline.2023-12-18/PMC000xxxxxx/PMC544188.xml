<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15574202</article-id><article-id pub-id-type="pmc">PMC544188</article-id><article-id pub-id-type="publisher-id">1471-2105-5-188</article-id><article-id pub-id-type="doi">10.1186/1471-2105-5-188</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Haplotype frequency estimation error analysis in the presence of missing genotype data</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Kelly</surname><given-names>Enda D</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>enda.kelly@hitachi-eu.com</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Sievers</surname><given-names>Fabian</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>fabian.sievers@hitachi-eu.com</email></contrib><contrib id="A3" contrib-type="author"><name><surname>McManus</surname><given-names>Ross</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>rmcmanus@tcd.ie</email></contrib></contrib-group><aff id="I1"><label>1</label>Hitachi Dublin Lab., Hitachi Europe Ltd., O'Reilly Institute, Trinity College, Dublin 2, Ireland</aff><aff id="I2"><label>2</label>Dept. of Clinical Medicine, Trinity College Dublin and Dublin Molecular Medicine Centre at St. James's Hospital, Dublin, Ireland</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>1</day><month>12</month><year>2004</year></pub-date><volume>5</volume><fpage>188</fpage><lpage>188</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/5/188"/><history><date date-type="received"><day>29</day><month>7</month><year>2004</year></date><date date-type="accepted"><day>1</day><month>12</month><year>2004</year></date></history><copyright-statement>Copyright &#x000a9; 2004 Kelly et al; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>Increasingly researchers are turning to the use of haplotype analysis as a tool in population studies, the investigation of linkage disequilibrium, and candidate gene analysis. When the phase of the data is unknown, computational methods, in particular those employing the Expectation-Maximisation (EM) algorithm, are frequently used for estimating the phase and frequency of the underlying haplotypes. These methods have proved very successful, predicting the phase-known frequencies from data for which the phase is unknown with a high degree of accuracy. Recently there has been much speculation as to the effect of unknown, or missing allelic data &#x02013; a common phenomenon even with modern automated DNA analysis techniques &#x02013; on the performance of EM-based methods. To this end an EM-based program, modified to accommodate missing data, has been developed, incorporating non-parametric bootstrapping for the calculation of accurate confidence intervals.</p></sec><sec><title>Results</title><p>Here we present the results of the analyses of various data sets in which randomly selected known alleles have been relabelled as missing. Remarkably, we find that the absence of up to 30% of the data in both biallelic and multiallelic data sets with moderate to strong levels of linkage disequilibrium can be tolerated. Additionally, the frequencies of haplotypes which predominate in the complete data analysis remain essentially the same after the addition of the random noise caused by missing data.</p></sec><sec><title>Conclusions</title><p>These findings have important implications for the area of data gathering. It may be concluded that small levels of drop out in the data do not affect the overall accuracy of haplotype analysis perceptibly, and that, given recent findings on the effect of inaccurate data, ambiguous data points are best treated as unknown.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Haplotype analysis has become a valuable tool for researchers in population genetics. In particular, the value attached to the prediction of the constituent haplotypes of a given sample and their frequency of occurrence is such that a variety of methods have been developed for this purpose. Many of these methods, however, depend on knowledge of the phase of the data supplied. In general, genotypic data from polymorphic loci are ascertained phase-unknown. Various methods for determining the gametic phase exist. With sufficient data from the genotyping of family members, definitive haplotypes may be inferred. However, in particular for late-onset disorders, these data may be difficult or even impossible to obtain. At the laboratory level, techniques such as chromosomal isolation or long-range PCR [<xref ref-type="bibr" rid="B1">1</xref>] may be utilised in the prediction of haplotypes, but they suffer the dual drawbacks of being both technologically demanding and in many cases prohibitively expensive in practice. Thus researchers have moved towards computational solutions to this problem. Prominent among the techniques employed for the estimation of the true haplotype frequencies of a phase-unknown sample are those based on the Expectation-Maximisation (EM) algorithm. Hill [<xref ref-type="bibr" rid="B2">2</xref>] originally proposed the use of the EM algorithm in genetics, and three years later the term was first coined by Dempster et al. [<xref ref-type="bibr" rid="B3">3</xref>] and the method put on a more formal footing. A number of EM-based methods for haplotype frequency estimation (HFE) have been produced [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>]. Excoffier and Slatkin [<xref ref-type="bibr" rid="B6">6</xref>] provide a thorough outline of the implementation of the EM algorithm as applied to the problem of HFE.</p><p>Reliable computational techniques for the estimation of haplotype frequencies have been around for some time, and extensive studies of the accuracy of the EM-based methods have been carried out [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>], but until recently there has been little investigation of the effect of missing data on these techniques. This is surprising considering that, even with modern automated DNA analysis methods, the problem of missing data is not uncommon, whether due to the failure of amplification or insufficient DNA. Zhao et al. [<xref ref-type="bibr" rid="B9">9</xref>] have developed the GENECOUNTING software specifically to take into account missing data in a sample, but have not produced any validation of the method. The HAPLO [<xref ref-type="bibr" rid="B5">5</xref>] program is also capable of analysing multiallelic data with missing alleles, using jackknife techniques for error analysis. The SNPHAP [<xref ref-type="bibr" rid="B10">10</xref>] algorithm can handle large numbers of loci and unknown alleles, but is restricted to the analysis of biallelic loci. In order to carry out an investigation of the effect of missing data on HFE, a program, based on the algorithm outlined in [<xref ref-type="bibr" rid="B6">6</xref>], has been developed which can accommodate multiallelic loci and a significant percentage of unknown alleles. The necessary alterations to the existing implementation of the EM algorithm are outlined in the Methods section. Following this, biallelic and multiallelic data sets were analysed with varying quantities of unknown alleles randomly substituted. The analysis is similar to previous work by Kirk and Cardon [<xref ref-type="bibr" rid="B11">11</xref>], which described the effect of genotyping error on HFE. Here we investigate the effect of missing data on the sizes of the confidence intervals (CIs) about the haplotype frequency point estimates (or simply "point estimates"). Surprisingly, the loss of as much as 30% of the allelic data did not have a significantly detrimental effect on the quality of the results. The frequencies of haplotypes which predominate in the complete data analysis remain essentially the same after randomly selected data have been relabelled as missing. The error estimates associated with the predicted frequencies, which are generated via a bootstrap method, are also quite stable, but increase as the proportion of missing data increases.</p></sec><sec><title>Results</title><sec><title>Source of data</title><p>Two sources of data were used for the principal part of this study. The first is real single nucleotide polymorphism (SNP) data; the second is multiallelic data generated via population generation software. Three additional sets of data containing 10%, 20% and 30% missing alleles respectively were generated from each of the two original sets. The process of generation is described in the Methods section. HFE was carried out on the eight data sets listed above. In each case 1,000 bootstrap iterations were performed for each HFE analysis and the 95% CIs about the point results were selected. For the sake of clarity the results from analyses of the 20% unknown alleles data sets have been omitted from the displayed graphs. Further tests were performed to investigate the effect of sample size upon the quality of the results. To this end two sets of progressively smaller data sets, with and without missing alleles, were generated from the SNP and multiallelic data sets, and HFE was carried out. The method of selecting these data is outlined in the Methods section.</p><p>An additional data set, unrelated to those previously described, consisting of data from five SNP loci was generated for the purposes of performing tests on data with weak LD between the loci. A further data set with 10% missing alleles was generated from these additional data.</p></sec><sec><title>Seven loci biallelic data sets</title><p>Figure <xref ref-type="fig" rid="F1">1</xref> displays point estimate results from the analyses of the seven loci SNP data sets with 536 sample points. Figure <xref ref-type="fig" rid="F1">1</xref> is a comparison of the frequencies of the 26 haplotypes present in the phase-known data, and their predicted frequencies when the phase is assumed unknown and data are missing. The percentage of missing alleles varies from zero (labelled "complete data") to 30. The haplotypes derived from the phase-known data were labelled from 1 to 26 in non-increasing order of the magnitude of their frequency, hence the "haplotype label" of the x-axis. For a quantitative measure of the discrepancies in the frequencies between the phase-known and phase-unknown frequency predictions we use the measure <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B11">11</xref>] given by</p><p><inline-graphic xlink:href="1471-2105-5-188-i2.gif"/></p><p>where <italic>h</italic><sub><italic>i </italic></sub>and <inline-graphic xlink:href="1471-2105-5-188-i3.gif"/> are the haplotype frequencies derived from the phase-known and phase-unknown data respectively, and <italic>N </italic>is the number of possible haplotypes in the sample. As these data are from seven biallelic loci, <italic>N </italic>= 2<sup>7 </sup>= 128 in this case. The results are displayed in Table <xref ref-type="table" rid="T1">1</xref>. Also recorded in Table <xref ref-type="table" rid="T1">1</xref> is the percentage increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) as the percentage of unknown alleles in the sample increases. In each case it is the percentage increase relative to the complete data value that is measured. Three haplotypes absent from the phase-known data set appear in the results of the HFE analysis of the complete data. Their frequencies are 2.3 &#x000d7; 10<sup>-3</sup>, 1.4 &#x000d7; 10<sup>-3</sup>, and 1.1 &#x000d7; 10<sup>-3</sup>. Of the haplotypes present in the phase-known data, only one haplotype appears with a frequency less than these, the given frequency being 9.3 &#x000d7; 10<sup>-4</sup>. Figure <xref ref-type="fig" rid="F1">1</xref> and Table <xref ref-type="table" rid="T1">1</xref> offer complementary illustrations of the effect of missing data. Table <xref ref-type="table" rid="T1">1</xref> provides a good overall picture of how the accuracy of the HFE method deteriorates with inferior data quality. The effect is most marked in the initial jump from complete to 10% missing data, where a 35% increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) is recorded. The subsequent percentage increases going from 10% to 20% and 20% to 30% unknown alleles are 22% and 16%, respectively, of the value of <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) for the complete data. Figure <xref ref-type="fig" rid="F1">1</xref> allows us to view specifically where this deterioration is most evident, in the mid-range frequency haplotypes. Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> display the effect of increasing quantities of missing data on the 95% CIs of the haplotype frequencies estimated from the phase-unknown data. In an attempt to quantify this effect, the spread of the CIs for each haplotype (the difference between the two bootstrap haplotype frequencies which give the limits of the 95% CI) was summed for each data set. The sum for each data set containing missing data was compared with the sum for the complete data set (no missing data). The ratio of the two values (the ratio of the extent of the CIs or RCI) for each comparison is displayed in Table <xref ref-type="table" rid="T2">2</xref>. Here we see a superlinear increase in the RCI with increasing proportions of missing data. Despite this, we note from Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> that, even for the 30% missing data case, the CIs for the complete data are not entirely contained within the CIs for the data with unknown alleles for many of the haplotypes.</p></sec><sec><title>Multiallelic data sets</title><p>Similar computations to those carried out for the SNP data sets were carried out for the four multiallelic data sets. Figure <xref ref-type="fig" rid="F4">4</xref> is a comparison of the frequencies of the most prominent haplotypes in the phase-known data, and their predicted frequencies when the phase is assumed unknown and data are missing. As with the seven loci SNP data sets, the percentage of missing data varies from zero to 30. The haplotypes are labelled as before. However, as 118 distinct haplotypes appear in the phase-known data, only the frequencies for the 40 most common are illustrated in Figures <xref ref-type="fig" rid="F4">4</xref> to <xref ref-type="fig" rid="F6">6</xref> for reasons of clarity. No haplotype with a frequency greater than 0.005, as given by the phase-known data, was excluded from the graphs by this trimming. As with the biallelic data, the discrepancy between the phase-known and phase-unknown frequency predictions, <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>), was measured. As the allele counts at each of the seven loci are 8, 2, 2, 9, 2, 5, and 2 respectively, the sum in Equation 1 is over the <italic>N </italic>= 5760 possible haplotypes in the sample. The results are displayed in Table <xref ref-type="table" rid="T3">3</xref>. As in Table <xref ref-type="table" rid="T1">1</xref>, the percentage increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) as the percentage of unknown alleles in the sample increases is also recorded.</p><p>129 distinct haplotypes were estimated to have a frequency of greater than 10<sup>-6 </sup>as a result of the HFE analysis. 29 of these do not appear in the phase-known data, with the most common of these having a frequency of 2.187 &#x000d7; 10<sup>-3</sup>. 68 haplotypes in the phase-known data display a frequency greater than this. As with the SNP case, Figure <xref ref-type="fig" rid="F4">4</xref> and Table <xref ref-type="table" rid="T3">3</xref> together provide a good overall picture of the effect of missing data on the accuracy of the HFE method. Table <xref ref-type="table" rid="T3">3</xref> displays similar percentage increases in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) with the 10% and 20% missing data cases to those of Table <xref ref-type="table" rid="T1">1</xref> (42% and 18% respectively), though there the similarity ends, as the jump in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) going from 20% to 30% unknown alleles comes to 40% of the value of <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) for the complete data. In Figure <xref ref-type="fig" rid="F4">4</xref> we see how the phase-unknown frequency predictions match well the observed phase-known frequencies for the more prominent haplotypes, but less well for the less common haplotypes, particularly for the 30% missing data case.</p><p>Similarly to the SNP case, Figures <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref> display the effect of increasing quantities of missing data on the 95% CIs of the haplotype frequencies estimated from the phase-unknown data. As before, measurement of this effect was made by observing the relative increase in the sizes of the CIs. The results are displayed in Table <xref ref-type="table" rid="T4">4</xref>. In contrast to the SNP case, we see a linear increase in the RCI with increasing proportions of missing data. This contrast is further marked by Figures <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref> where we note that the CIs for the complete data are, in the case of most haplotypes, entirely contained within the CIs for the data with unknown alleles.</p></sec><sec><title>Sample sizes</title><p>Investigations were made into the effect of the sample size on the performance of the HFE method when 10% of the data was missing. Three further data sets of sizes 300, 100 and 50 individuals were generated by random selection from the original seven loci SNP and multiallelic sets. From these data, six additional sets with 10% missing alleles were created. HFE was performed upon these additional data, and the <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) results for each were displayed in Table <xref ref-type="table" rid="T5">5</xref>. In each case the phase-known haplotype frequencies used in the computation of <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) were those derived from the respective smaller samples (e.g. the accuracy of the HFE method as applied to the SNP sample with 300 individuals was calculated relative to the haplotype frequencies observed in the phase-known sample with 300 individuals, and not those observed in the original data). As may be expected, in all cases we see an increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) as we move from the complete data to the data sets with missing alleles. <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) also is seen to increase as the sample size decreases. However, what is of note is the pattern involved. For the seven loci SNP case, the percentage increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) from complete to missing data itself increases monotonically as the sample size is reduced. A similar pattern is not observed in the multiallelic data.</p></sec><sec><title>Performance at low LD levels</title><p>Fallin and Schork [<xref ref-type="bibr" rid="B7">7</xref>] illustrate how the performance of the EM-based HFE method diminishes with falling LD strength. Here we investigated how the accuracy of our implementation behaves on a data set exhibiting weak LD when 10% of the alleles are missing. A population of 500 individuals with data at five SNP loci was generated specifically for this part of the study. Lewontin's <italic>D</italic>' [<xref ref-type="bibr" rid="B12">12</xref>] was found to range between 0.117 and 0.014 for all adjacent loci. Table <xref ref-type="table" rid="T6">6</xref> displays <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) readings for this particular case. Here we see a large percentage increase of 60% in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) as we move from the complete data to 10% missing data.</p></sec></sec><sec><title>Discussion</title><p>The results displayed here show the impact of the addition of increasing quantities of missing alleles on the quality of haplotype frequency estimates. Studying Figure <xref ref-type="fig" rid="F1">1</xref> in tandem with Table <xref ref-type="table" rid="T1">1</xref>, and Figure <xref ref-type="fig" rid="F4">4</xref> in tandem with Table <xref ref-type="table" rid="T3">3</xref>, we see a loss of accuracy of the HFE method as the quality of the data degrades. This is particularly true for the multiallelic data set with 30% missing alleles. Here the loss of accuracy is most apparent with the rarer haplotypes as may be seen in Figure <xref ref-type="fig" rid="F4">4</xref>, whereas for the seven loci SNP case, Figure <xref ref-type="fig" rid="F1">1</xref> illustrates that the low frequency haplotypes are dealt with remarkably well, even at high missing data proportions. For both sets of data the ability of the method to predict the frequencies of the most prominent haplotypes in the samples holds up well as the percentage of unknown alleles increases. Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3</xref> and Figures <xref ref-type="fig" rid="F5">5</xref> and <xref ref-type="fig" rid="F6">6</xref> display a similar behaviour in the bootstrap generated CIs. To summarise, there are two significant aspects of the analysis of genotypic data containing incompletely typed individuals evident here. Firstly, that the HFE algorithm, given phase-unknown data with moderate to high levels of LD, predicts the frequencies of the underlying haplotypes with a high degree of accuracy, as is evident from the point estimate graphs, Figures <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F4">4</xref>. Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T3">3</xref> quantify how the quality of the frequency predictions behave with increasing percentages of missing data. For the multiallelic case where 30% of the alleles are unknown, Table <xref ref-type="table" rid="T3">3</xref> shows that the discrepancy between the phase-known and phase-unknown predicted frequencies has doubled when compared with the complete data case, though from the study of Figure <xref ref-type="fig" rid="F4">4</xref> the bulk of this discrepancy would appear to originate from the lower frequency haplotypes. The second aspect is the extent of the 95% CIs. We see a steady increase in the spread of the CIs with the addition of missing alleles, reflecting the growing uncertainty in the data. However, the most prominent haplotypes in both the SNP and multiallelic data sets maintain their distinctiveness, even at the 30% unknown alleles level. These data show that, in particular for the SNP data set, the effect of relabelling significant proportions of the data as unknown on the performance of the HFE algorithm is minor.</p><p>Although study of the illustrated graphs suggests that the impact of missing data is more pronounced with the more complex multiallelic data sets, Tables <xref ref-type="table" rid="T2">2</xref> and <xref ref-type="table" rid="T4">4</xref> demonstrate that the relative increase in the size of the CIs is similar across the biallelic and multiallelic data sets, and is almost identical for the 30% missing data sets. There appears to be a discrepancy between the two measures, namely <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) and the RCI, used here to quantify the degradation in the quality of the results with increasing percentages of unknown alleles. Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T3">3</xref> imply that the HFE method works significantly better for biallelic data than for multiallelic data, whereas this phenomenon is much less evident in Tables <xref ref-type="table" rid="T2">2</xref> and <xref ref-type="table" rid="T4">4</xref>. This may be explained by the fact that <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) is an <italic>absolute </italic>measure of the performance of the algorithm, as the phase-known data are available for each data set and thus the exact sample haplotype frequencies are known. This discrepancy is to be expected; <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) is a sum over all possible haplotypes and there exist only 128 (2<sup>7</sup>) possible haplotypes for the seven loci SNP data, whereas the multiallelic data, as noted in the Results section, have 5760 possible haplotypes. Also, it is not surprising that haplotype frequencies estimated from the multiallelic data set are found to be less accurate than those estimated from SNPs, given the more complex nature of the data. The RCI is a relative measure, and illustrates not so much the accuracy of the algorithm, rather the effect of additional missing data. The results displayed in Tables <xref ref-type="table" rid="T2">2</xref> and <xref ref-type="table" rid="T4">4</xref> show that the algorithm handles the increase in the proportion of unknown alleles equally well for both SNPs and multiallelic data, although it should be pointed out that the RCI measure gives no indication of the accuracy of the point estimates, and should generally be considered in tandem with a measure such as <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>). Interestingly, the results for the multiallelic data set were achieved despite departure from Hardy-Weinberg equilibrium (HWE) at two of the seven loci (see Methods section). Although this technique relies on the assumption of HWE, Niu et al. [<xref ref-type="bibr" rid="B13">13</xref>] have demonstrated it to be reliable and robust even when the HWE assumption has been violated. Fallin and Schork [<xref ref-type="bibr" rid="B7">7</xref>] have shown that HWE violation which results in an excess of heterozygosity leads to an increase in HFE error, though their results are based on a five-locus system, and the observed error increase when two of the five loci were found to be in disequilibrium was minimal. As we are dealing here with a seven-locus system, the effect on the error was likely to have been even less apparent.</p><p>The investigation into the effect of smaller sample sizes has produced some surprising results. Comparing Table <xref ref-type="table" rid="T1">1</xref> with Table <xref ref-type="table" rid="T5">5</xref>, we see that the relative increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) observed when 10% of the seven loci SNP data is relabelled as missing does not change substantially as the size of the sample reduces. For the full sample of 536 individuals, the percentage jump in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) moving from the complete data to 10% missing data is approximately 35%. For the sample of size 300, this increase is 37%. Likewise for the samples of size 100 and 50, the increases are 41% and 47% respectively. However, for the multiallelic data, we see a contrasting trend. The percentage jump in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) decreases rather than increases with increasing missing data proportions. Inspection of Tables <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T5">5</xref> shows us that the percentage increase in <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) when moving from the complete data to 10% missing data for the full sample of 500 individuals is approximately 42%, whereas for the sample of size 300 this drops to 32%. The recorded increase for the sample of size 100, 5%, is even more striking. (The sample of size 50 is not considered here, as the matching observed between the phase-known and phase-unknown frequencies was of poor quality (figure not shown), and any conclusions drawn from analysis of this case would be highly suspect). Thus no definitive conclusions may be made as to the effect of missing data as the sample size is reduced, other that to say that the matching between the phase-known and phase-unknown frequencies deteriorates with falling sample size, as would be expected.</p><p>Table <xref ref-type="table" rid="T6">6</xref> underlines the relationship between strong LD and superior performance of the EM method [<xref ref-type="bibr" rid="B7">7</xref>]. For the weak LD data set, we see that <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) for the complete data is comparable to that of the seven loci SNP data with 30% missing alleles. It should also be borne in mind that, as the weak LD data set features only five SNP loci, the sum for <italic>D </italic>(<italic>h</italic>, <inline-graphic xlink:href="1471-2105-5-188-i1.gif"/>) is over a mere 32 possible haplotypes, as compared to 128 for the seven loci SNP data, emphasising the fall-off in accuracy. Also of note is the similarity in the sample sizes -500 in the weak LD case, and 536 in the moderate to strong LD case. Moving to the 10% missing allele case, we witness a further 60% drop in accuracy, a considerably greater percentage that was observed for the medium to high LD data sets, a result which again calls into question the reliability of the method in the presence of weak LD.</p></sec><sec><title>Conclusions</title><p>Here we show that the EM method, with the modifications to the implementation for complete data detailed here, can generate accurate estimates of haplotype frequencies even when large amounts of data are missing, in this case up to 30%. Moreover, using this method, the degree of accuracy can easily be estimated using conventional bootstrapping approaches. This is of considerable importance in the design of experiments, as it is therefore obvious that small levels of drop out in the data for whatever reason do not affect the overall accuracy of the approach perceptibly. Furthermore, considering the strongly deleterious effects of even small amounts of inaccurate data [<xref ref-type="bibr" rid="B11">11</xref>], this analysis shows that large amounts of missing data are much less detrimental to the overall quality of the results than incorrectly typed sites. Thus from a practical standpoint it is clearly preferable that if any doubt exists as to a genotype's identity, it should be excluded rather than included using a "best guess".</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Seven loci biallelic data</title><p>The data used in this part of the study are derived from a genetic investigation of cystic fibrosis sufferers [<xref ref-type="bibr" rid="B14">14</xref>]. The haplotypes used here are actual haplotypes composed of a subset of the markers typed in the vicinity of the CFTR gene locus. The haplotypes comprise seven biallelic loci. From these haplotypes 536 phase-known genotypes were constructed via random resampling. Thus the data set comprised of 536 individuals each with seven SNP loci. In common with Kirk and Cardon [<xref ref-type="bibr" rid="B11">11</xref>] a linkage disequilibrium (LD) analysis was carried out on the data. For adjacent loci, <italic>D</italic>' was found to be &#x02265; 0.9 for all intervals but the third and fifth, where <italic>D</italic>' &#x02264; 0.25. As HWE is assumed for HFE, each locus was tested and found to be in HWE.</p></sec><sec><title>Multiallelic data</title><p>An initial population of fifty individuals with data from seven loci spaced 1 cM apart was generated <italic>in silico</italic>. The number of distinct alleles at each locus ranged from two to nine. A trait marker was introduced between the 3<sup>rd </sup>and 4<sup>th </sup>loci for 10 of the 50 founders. The population was evolved for thirty generations as an isolated group with random mating. The birth rate per couple was binomially distributed, with a range of zero to ten offspring and a mean of 2.5. 500 individuals bearing the trait were randomly selected from the final generation for analysis. As with the SNP data, the level of LD across the interval was measured. <italic>D</italic>' was found to lie between 0.5 and 0.8 for all adjacent loci except between the second and third loci where <italic>D</italic>' = 1.0 and the fifth and sixth where <italic>D</italic>' = 0.24. A test for HWE [<xref ref-type="bibr" rid="B15">15</xref>] was performed, and it was found that the fourth and fifth loci were not in HWE (P-values &#x0003c; 0.001 and 0.003 respectively). In both cases an excess of heterozygosity was evident (observed heterozygosities of 0.848 and 0.232, respectively compared with expected heterozygosities of 0.729 and 0.205, respectively).</p></sec><sec><title>Smaller sample sizes</title><p>The data sets of reduced size used in this analysis were generated from the original seven loci SNP and multiallelic data sets via a random sampling process. The process was identical for both. Initially 300 individuals were chosen from the original data. Following this, 100 individuals were chosen from the newly created set of size 300. Finally 50 individuals were chosen from the set of size 100. In each case the selection process was random and done without replacement. From each of these six smaller data sets, six additional sets of data with 10% missing alleles were generated by the process outlined below.</p></sec><sec><title>Low LD data</title><p>A population of 500 individuals with data from five SNP loci was generated <italic>in silico </italic>specifically for the testing of the performance of the HFE algorithm in low LD circumstances. <italic>D</italic>' was found to range between 0.117 and 0.014 for all adjacent loci. The data were also tested for HWE. The first locus was found to be marginally not in HWE (P = 0.0465), with excess homozygosity in evidence. All other loci were found to be in HWE.</p></sec><sec><title>Phase-unknown data</title><p>The HFE algorithm assumes that the input data are phase-unknown, and thus no alteration was necessary to the sample data sets which were phase-known before input. Comparison tests on the phase-known data, and phase-unknown data generated from the phase-known data via a process of phase-randomisation have confirmed that no bias is introduced by the use of phase-known data (results not shown).</p></sec><sec><title>Generation of missing data</title><p>Data sets containing unknown alleles were generated from the original data via the following procedure:</p><p>1. Each individual is selected in turn.</p><p>2. For each locus a random number between 0 and 100 is generated.</p><p>3. If this random number falls below the desired percentage of unknowns, both of the individual's alleles at the locus in question are redefined as unknown. This ensures that all unknowns appear in homologous pairs.</p><p>4. The process is repeated until all loci for all individuals are exhausted.</p><p>Thus the desired percentage of unknown alleles is achieved globally, and the percentage of missing data at each locus may vary. Three additional sets of data were generated from each of the two original sets in this way, with 10%, 20% and 30% missing data respectively, giving eight data sets in all for the principal component of the study.</p></sec><sec><title>Expectation-Maximisation algorithm</title><p>For known gametic phase, HFE is a straightforward process of counting the constituent haplotypes in the sample. For the case where the gametic phase is unknown, maximum-likelihood haplotype frequencies are computed using the EM algorithm. The particular implementation used here for the finding of the haplotype frequencies is similar to that outlined by Excoffier and Slatkin [<xref ref-type="bibr" rid="B6">6</xref>]. The operation of the algorithm is based on the assumption of HWE, though as mentioned above, the method has been found to be quite robust in the presence of deviations from HWE [<xref ref-type="bibr" rid="B13">13</xref>].</p><sec><title>Implementation of the EM algorithm</title><p>Missing data in a sample necessitate alterations to the implementation for complete data of the EM-based algorithm. When all alleles in an individual are known, there exist <italic>c</italic><sub><italic>j </italic></sub>possible genotypes consistent with this phenotype where</p><p><inline-graphic xlink:href="1471-2105-5-188-i4.gif"/></p><p>and <italic>s</italic><sub><italic>j </italic></sub>is the number of heterozygous loci in phenotype <italic>j</italic>. However, when unknown alleles appear at a locus, the situation is considerably more complex. In this case each unknown allele may take on the identity of any of the alleles observed at that locus. We require that unknown alleles always appear in pairs &#x02013; the amplification of one allele only would result in the appearance of a homozygote which may bias results. Thus if there are <italic>N</italic><sub><italic>i </italic></sub>distinct alleles (forms) observed at locus <italic>i </italic>in the entire sample, the number of possible <italic>complete </italic>phenotypes consistent with the observed phenotype is increased by a factor of <italic>N</italic><sub><italic>i</italic></sub>(<italic>N</italic><sub><italic>i </italic></sub>+ 1)/2 by the presence of an unknown site. This factor is the number of ways of selecting two alleles from a pool of <italic>N</italic><sub><italic>i </italic></sub>distinct alleles when repetition is allowed. Thus the number of possible complete phenotypes given by phenotype <italic>j </italic>is given by</p><p><inline-graphic xlink:href="1471-2105-5-188-i5.gif"/></p><p>where <italic>M </italic>is the number of loci in the sample and</p><p><inline-graphic xlink:href="1471-2105-5-188-i6.gif"/></p><p>where <italic>N</italic><sub><italic>i </italic></sub>is the number of distinct alleles observed in the sample at locus <italic>i</italic>. For each possible complete phenotype <italic>i </italic>of the <italic>&#x003ba;</italic><sub><italic>j </italic></sub>complete phenotypes possible for individual <italic>j</italic>, there exist <italic>c</italic><sub><italic>i </italic></sub>possible genotypes, as given by Equation 2. Thus the number possible complete <italic>genotypes </italic>for phenotype <italic>j </italic>is given by</p><p><inline-graphic xlink:href="1471-2105-5-188-i7.gif"/></p><p>Then, following [<xref ref-type="bibr" rid="B6">6</xref>], the probability <italic>P</italic><sub><italic>j </italic></sub>of the <italic>j</italic><sup><italic>th </italic></sup>phenotype, assuming random mating, is given by:</p><p><inline-graphic xlink:href="1471-2105-5-188-i8.gif"/></p><p>where <italic>P</italic><sub><italic>i</italic></sub>(<italic>h</italic><sub><italic>k</italic></sub><italic>h</italic><sub><italic>l</italic></sub>)is the probability of the <italic>i</italic><sup><italic>th </italic></sup>genotype made up of haplotypes <italic>k </italic>and <italic>l</italic>, and</p><p><inline-graphic xlink:href="1471-2105-5-188-i9.gif"/></p><p>where <italic>p</italic><sub><italic>k </italic></sub>and <italic>p</italic><sub><italic>l </italic></sub>are the population frequencies of the <italic>k</italic><sup><italic>th </italic></sup>and <italic>l</italic><sup><italic>th </italic></sup>haplotypes.</p></sec><sec><title>Expectation step</title><p>At the <italic>t</italic><sup><italic>th </italic></sup>step of the EM iterative process, the probability of resolving each phenotype into the different possible genotypes is given by:</p><p><inline-graphic xlink:href="1471-2105-5-188-i10.gif"/></p><p>where <italic>n</italic><sub><italic>j </italic></sub>is the number of individuals with phenotype <italic>j</italic>, and <italic>n </italic>is the total number of individuals in the sample. Thus <italic>n</italic><sub><italic>j</italic></sub>/<italic>n </italic>is the proportion of the total sample that has phenotype <italic>j</italic>, and <italic>P</italic><sub><italic>j</italic></sub>(<italic>h</italic><sub><italic>k</italic></sub><italic>h</italic><sub><italic>l</italic></sub>)/<italic>P</italic><sub><italic>j </italic></sub>is the conditional probability of the particular genotype given the phenotype.</p></sec><sec><title>Maximisation step</title><p>The haplotype frequencies are then computed using a form of gene-counting [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] :</p><p><inline-graphic xlink:href="1471-2105-5-188-i11.gif"/></p><p>where <italic>N </italic>is the number of globally distinct haplotypes (the number of different possible haplotypes in the sample), <inline-graphic xlink:href="1471-2105-5-188-i12.gif"/> is the frequency of haplotype <italic>v, m </italic>is the number of distinct phenotypes in the sample, and <italic>&#x003b5;</italic><sub><italic>iv </italic></sub>is equal to the number of times haplotype <italic>v </italic>appears in genotype <italic>i</italic>.</p></sec></sec><sec><title>Generation of confidence intervals</title><p>The technique of bootstrapping [<xref ref-type="bibr" rid="B18">18</xref>] was used to generate CIs about the point haplotype frequencies estimated from the phase-unknown data. Specifically, the percentile bootstrap approach was used.</p></sec></sec><sec><title>Authors' contributions</title><p>EDK carried out the main programming work, performed the tests and drafted the manuscript. FS designed the population generation tool and assisted in the programming effort. RM assisted in the drafting of the manuscript and provided the SNP data. All authors read and approved the final manuscript.</p></sec></body><back><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Michalatos-Beloin</surname><given-names>S</given-names></name><name><surname>Tishkoff</surname><given-names>SA</given-names></name><name><surname>Bentley</surname><given-names>KL</given-names></name><name><surname>Kidd</surname><given-names>KK</given-names></name><name><surname>Ruano</surname><given-names>G</given-names></name></person-group><article-title>Molecular haplotyping of genetic markers 10 kb apart by allele-specific long-range PCR</article-title><source>Nucleic Acids Res</source><year>1996</year><volume>24</volume><fpage>4841</fpage><lpage>4843</lpage><pub-id pub-id-type="pmid">8972876</pub-id><pub-id pub-id-type="doi">10.1093/nar/24.23.4841</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname><given-names>WG</given-names></name></person-group><article-title>Estimation of linkage disequilibrium in randomly mating populations</article-title><source>Heredity</source><year>1974</year><volume>33</volume><fpage>229</fpage><lpage>239</lpage><pub-id pub-id-type="pmid">4531429</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title><source>J Royal Stat Soc B</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>JC</given-names></name><name><surname>Williams</surname><given-names>RC</given-names></name><name><surname>Urbanek</surname><given-names>M</given-names></name></person-group><article-title>An E-M algorithm and testing strategy for multiple-locus haplotypes</article-title><source>Am J Hum Genet</source><year>1995</year><volume>56</volume><fpage>799</fpage><lpage>810</lpage><pub-id pub-id-type="pmid">7887436</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hawley</surname><given-names>ME</given-names></name><name><surname>Kidd</surname><given-names>KK</given-names></name></person-group><article-title>HAPLO: A program using the EM algorithm to estimate the frequencies of multi-site haplotypes</article-title><source>J Hered</source><year>1995</year><volume>86</volume><fpage>409</fpage><lpage>411</lpage><pub-id pub-id-type="pmid">7560877</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname><given-names>L</given-names></name><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Maximum-likelihood estimation of molecular haplotype frequencies in a diploid population</article-title><source>Mol Biol Evol</source><year>1995</year><volume>12</volume><fpage>921</fpage><lpage>927</lpage><pub-id pub-id-type="pmid">7476138</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fallin</surname><given-names>D</given-names></name><name><surname>Schork</surname><given-names>NJ</given-names></name></person-group><article-title>Accuracy of haplotype frequency estimation for biallelic loci, via the Expectation-Maximisation algorithm for unphased diploid genotype data</article-title><source>Am J Hum Genet</source><year>2000</year><volume>67</volume><fpage>947</fpage><lpage>959</lpage><pub-id pub-id-type="pmid">10954684</pub-id><pub-id pub-id-type="doi">10.1086/303069</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Tishkoff</surname><given-names>SA</given-names></name><name><surname>Pakstis</surname><given-names>AJ</given-names></name><name><surname>Ruano</surname><given-names>G</given-names></name><name><surname>Kidd</surname><given-names>KK</given-names></name></person-group><article-title>The accuracy of statistical methods for estimation of haplotype frequencies: An example from the CD4 locus</article-title><source>Am J Hum Genet</source><year>2000</year><volume>67</volume><fpage>518</fpage><lpage>522</lpage><pub-id pub-id-type="pmid">10859209</pub-id><pub-id pub-id-type="doi">10.1086/303000</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>JH</given-names></name><name><surname>Lissarrague</surname><given-names>S</given-names></name><name><surname>Essioux</surname><given-names>L</given-names></name><name><surname>Sham</surname><given-names>PC</given-names></name></person-group><article-title>GENECOUNTING: haplotype analysis with missing genotypes</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1694</fpage><lpage>1695</lpage><pub-id pub-id-type="pmid">12490459</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.12.1694</pub-id></citation></ref><ref id="B10"><citation citation-type="other"><person-group person-group-type="author"><collab>SNPHAP</collab></person-group><article-title>A program for estimating frequencies of large haplotypes of SNPs</article-title><ext-link ext-link-type="uri" xlink:href="http://www-gene.cimr.cam.ac.uk/clayton/software/snphap.txt"/></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kirk</surname><given-names>KM</given-names></name><name><surname>Cardon</surname><given-names>LR</given-names></name></person-group><article-title>The impact of genotyping error on haplotype reconstruction and frequency estimation</article-title><source>Eur J Hum Genet</source><year>2002</year><volume>10</volume><fpage>616</fpage><lpage>622</lpage><pub-id pub-id-type="pmid">12357332</pub-id><pub-id pub-id-type="doi">10.1038/sj.ejhg.5200855</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lewontin</surname><given-names>RC</given-names></name></person-group><article-title>The interaction of selection and linkage I. General considerations; heterotic models</article-title><source>Genetics</source><year>1964</year><volume>49</volume><fpage>49</fpage><lpage>67</lpage></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Niu</surname><given-names>T</given-names></name><name><surname>Qin</surname><given-names>ZS</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><article-title>Bayesian haplotype inference for multiple linked single-nucleotide polymorphisms</article-title><source>Am J Hum Genet</source><year>2002</year><volume>70</volume><fpage>157</fpage><lpage>169</lpage><pub-id pub-id-type="pmid">11741196</pub-id><pub-id pub-id-type="doi">10.1086/338446</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kerem</surname><given-names>B</given-names></name><name><surname>Rommens</surname><given-names>JM</given-names></name><name><surname>Buchanan</surname><given-names>JA</given-names></name><name><surname>Markiewicz</surname><given-names>D</given-names></name><name><surname>Cox</surname><given-names>TK</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name><name><surname>Buchwald</surname><given-names>M</given-names></name><name><surname>Tsui</surname><given-names>LC</given-names></name></person-group><article-title>Identification of the cystic fibrosis gene: genetic analysis</article-title><source>Science</source><year>1989</year><volume>245</volume><fpage>1073</fpage><lpage>1080</lpage><pub-id pub-id-type="pmid">2570460</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>SW</given-names></name><name><surname>Thompson</surname><given-names>EA</given-names></name></person-group><article-title>Performing the exact test of Hardy-Weinberg proportion for multiple alleles</article-title><source>Biometrics</source><year>1992</year><volume>48</volume><fpage>361</fpage><lpage>372</lpage><pub-id pub-id-type="pmid">1637966</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ceppellini</surname><given-names>R</given-names></name><name><surname>Siniscalco</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>CAB</given-names></name></person-group><article-title>The estimation of gene frequencies in a random mating population</article-title><source>Ann Hum Genet</source><year>1955</year><volume>20</volume><fpage>97</fpage><lpage>115</lpage><pub-id pub-id-type="pmid">13268982</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>CAB</given-names></name></person-group><article-title>Counting methods in genetical statistics</article-title><source>Ann Hum Genet</source><year>1957</year><volume>21</volume><fpage>254</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">13411871</pub-id></citation></ref><ref id="B18"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>RJ</given-names></name></person-group><source>An Introduction to the Bootstrap</source><year>1993</year><publisher-name>New York: Chapman and Hall</publisher-name></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Point estimates for seven loci SNP data</bold>. Point estimate haplotype frequencies for seven loci SNP data set for phase-known and phase-unknown data with 0%, 10%, and 30% missing data.</p></caption><graphic xlink:href="1471-2105-5-188-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Seven loci SNP data with 10% missing alleles</bold>. 95% CIs for haplotype frequencies estimated from seven loci SNP phase-unknown data with 0% and 10% missing data. Frequencies derived from phase-known data also shown.</p></caption><graphic xlink:href="1471-2105-5-188-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Seven loci SNP data with 30% missing alleles</bold>. 95% CIs for haplotype frequencies estimated from seven loci SNP phase-unknown data with 0% and 30% missing data. Frequencies derived from phase-known data also shown.</p></caption><graphic xlink:href="1471-2105-5-188-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Point estimates for multiallelic data</bold>. Point estimate haplotype frequencies for multiallelic data set for phase-known and phase-unknown data with 0%, 10%, and 30% missing data.</p></caption><graphic xlink:href="1471-2105-5-188-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Multiallelic data with 10% missing alleles</bold>. 95% CIs for haplotype frequencies estimated from multiallelic phase-unknown data with 0% and 10% missing data. Frequencies derived from phase-known data also shown.</p></caption><graphic xlink:href="1471-2105-5-188-5"/></fig><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Multiallelic data with 30% missing alleles</bold>. 95% CIs for haplotype frequencies estimated from multiallelic phase-unknown data with 0% and 30% missing data. Frequencies derived from phase-known data also shown.</p></caption><graphic xlink:href="1471-2105-5-188-6"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>) for 7 loci SNP data. Measure of discrepancy between phase-known and phase-unknown frequency predictions for seven loci biallelic data, 536 individuals.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">% missing alleles</td><td align="center"><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>)</td><td align="center">% increase from complete data</td></tr></thead><tbody><tr><td align="center">0</td><td align="center">0.043822</td><td align="center">0</td></tr><tr><td align="center">10</td><td align="center">0.059222</td><td align="center">35</td></tr><tr><td align="center">20</td><td align="center">0.069017</td><td align="center">57</td></tr><tr><td align="center">30</td><td align="center">0.075998</td><td align="center">73</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>RCI for 7 loci SNP data. Ratio of extent of 95% CI for missing data sets compared to complete data set for seven loci biallelic case, 536 individuals.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">% missing alleles</td><td align="center">RCI</td></tr></thead><tbody><tr><td align="center">0</td><td align="center">1.0</td></tr><tr><td align="center">10</td><td align="center">1.102024</td></tr><tr><td align="center">20</td><td align="center">1.243451</td></tr><tr><td align="center">30</td><td align="center">1.469974</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>) for multiallelic data. Measure of discrepancy between phase-known and phase-unknown frequency predictions for multiallelic data.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">% missing alleles</td><td align="center"><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>)</td><td align="center">% increase from complete data</td></tr></thead><tbody><tr><td align="center">0</td><td align="center">0.106954</td><td align="center">0</td></tr><tr><td align="center">10</td><td align="center">0.151494</td><td align="center">42</td></tr><tr><td align="center">20</td><td align="center">0.170971</td><td align="center">60</td></tr><tr><td align="center">30</td><td align="center">0.213888</td><td align="center">100</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>RCI for multiallelic data. Ratio of extent of 95% CI for missing data sets compared to complete data set for multiallelic case.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">% missing alleles</td><td align="center">RCI</td></tr></thead><tbody><tr><td align="center">0</td><td align="center">1.0</td></tr><tr><td align="center">10</td><td align="center">1.162630</td></tr><tr><td align="center">20</td><td align="center">1.315285</td></tr><tr><td align="center">30</td><td align="center">1.470215</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T5"><label>Table 5</label><caption><p><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>) for smaller samples. Measure of discrepancy between phase-known and phase-unknown frequency predictions for smaller samples randomly selected from larger data sets.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Data set</td><td align="center"># individuals</td><td align="center">% missing alleles</td><td align="center"><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>)</td><td align="center">% increase from complete data</td></tr></thead><tbody><tr><td align="center">7 loci SNP</td><td align="center">300</td><td align="center">0</td><td align="center">0.049354</td><td align="center">0</td></tr><tr><td align="center">7 loci SNP</td><td align="center">300</td><td align="center">10</td><td align="center">0.067410</td><td align="center">37</td></tr><tr><td align="center">7 loci SNP</td><td align="center">100</td><td align="center">0</td><td align="center">0.104105</td><td align="center">0</td></tr><tr><td align="center">7 loci SNP</td><td align="center">100</td><td align="center">10</td><td align="center">0.147034</td><td align="center">41</td></tr><tr><td align="center">7 loci SNP</td><td align="center">50</td><td align="center">0</td><td align="center">0.155912</td><td align="center">0</td></tr><tr><td align="center">7 loci SNP</td><td align="center">50</td><td align="center">10</td><td align="center">0.229097</td><td align="center">47</td></tr><tr><td align="center">multiallelic</td><td align="center">300</td><td align="center">0</td><td align="center">0.153865</td><td align="center">0</td></tr><tr><td align="center">multiallelic</td><td align="center">300</td><td align="center">10</td><td align="center">0.202678</td><td align="center">32</td></tr><tr><td align="center">multiallelic</td><td align="center">100</td><td align="center">0</td><td align="center">0.227170</td><td align="center">0</td></tr><tr><td align="center">multiallelic</td><td align="center">100</td><td align="center">10</td><td align="center">0.238658</td><td align="center">5</td></tr><tr><td align="center">multiallelic</td><td align="center">50</td><td align="center">0</td><td align="center">0.320917</td><td align="center">0</td></tr><tr><td align="center">multiallelic</td><td align="center">50</td><td align="center">10</td><td align="center">0.372827</td><td align="center">16</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T6"><label>Table 6</label><caption><p><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>) for low LD data. Measure of discrepancy between phase-known and phase-unknown frequency predictions for low LD data.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">% missing alleles</td><td align="center"><italic>D </italic>(<italic>h</italic>, <graphic xlink:href="1471-2105-5-188-i1.gif"/>)</td><td align="center">% increase from complete data</td></tr></thead><tbody><tr><td align="center">0</td><td align="center">0.090178</td><td align="center">0</td></tr><tr><td align="center">10</td><td align="center">0.144290</td><td align="center">60</td></tr></tbody></table></table-wrap></sec></back></article>



