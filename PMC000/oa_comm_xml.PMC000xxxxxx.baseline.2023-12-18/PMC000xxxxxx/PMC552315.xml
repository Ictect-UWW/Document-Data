<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15707486</article-id><article-id pub-id-type="pmc">PMC552315</article-id><article-id pub-id-type="publisher-id">1471-2105-6-28</article-id><article-id pub-id-type="doi">10.1186/1471-2105-6-28</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>An adaptive method for cDNA microarray normalization</article-title></title-group><contrib-group><contrib id="A1" equal-contrib="yes" contrib-type="author"><name><surname>Zhao</surname><given-names>Yingdong</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>zhaoy@helix.nih.gov</email></contrib><contrib id="A2" equal-contrib="yes" contrib-type="author"><name><surname>Li</surname><given-names>Ming-Chung</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>mli@emmes.com</email></contrib><contrib id="A3" corresp="yes" contrib-type="author"><name><surname>Simon</surname><given-names>Richard</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>rsimon@mail.nih.gov</email></contrib></contrib-group><aff id="I1"><label>1</label>Biometric Research Branch, National Cancer Institute, National Institutes of Health, Rockville, Maryland, USA</aff><aff id="I2"><label>2</label>The EMMES Corporation, Rockville, Maryland, USA</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>11</day><month>2</month><year>2005</year></pub-date><volume>6</volume><fpage>28</fpage><lpage>28</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/28"/><history><date date-type="received"><day>21</day><month>10</month><year>2004</year></date><date date-type="accepted"><day>11</day><month>2</month><year>2005</year></date></history><copyright-statement>Copyright &#x000a9; 2005 Zhao et al; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>Normalization is a critical step in analysis of gene expression profiles. For dual-labeled arrays, global normalization assumes that the majority of the genes on the array are non-differentially expressed between the two channels and that the number of over-expressed genes approximately equals the number of under-expressed genes. These assumptions can be inappropriate for custom arrays or arrays in which the reference RNA is very different from the experimental samples.</p></sec><sec><title>Results</title><p>We propose a mixture model based normalization method that adaptively identifies non-differentially expressed genes and thereby substantially improves normalization for dual-labeled arrays in settings where the assumptions of global normalization are problematic. The new method is evaluated using both simulated and real data.</p></sec><sec><title>Conclusions</title><p>The new normalization method is effective for general microarray platforms when samples with very different expression profile are co-hybridized and for custom arrays where the majority of genes are likely to be differentially expressed.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Microarray technology provides simultaneous measurements of expression levels for thousands of genes. Each step from sample preparation to data analysis, however, contains potential sources of bias and variability. Proper normalization adjusts for differences which interfere with the comparison of intensities of different labels at a given probe and with the comparison of intensities of corresponding probes on different arrays. Proper data normalization should allow for the comparison of expression levels across different arrays. Subsequent data analysis results are heavily dependent on effective normalization.</p><p>Normalization issues differ for dual-labeled platforms compared to single labeled platforms such as the Affymetrix GeneChip arrays. In this paper we address normalization for dual-labeled arrays with either cDNA or oligonucleotide probes. The objective of normalization for dual-labeled arrays is to correct for differences in intensities for the two labels on the same array. These differences arise from factors such as differences in sample concentrations, differences in photomultiplier tube setting, and differences in the affinity of the two labels for DNA.</p><p>Median or mean based global normalization methods use a single normalization factor applied to all genes on the array to adjust for labeling bias [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. Such methods are widely used because of their simplicity. Intensity-based and location-based methods take into account intensity and spatial dependence on dye bias normalization factors [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]. Both global and intensity/location based normalization methods assume that most of the genes are not differentially expressed between the two samples hybridized on the array, and that for the differentially expressed genes, the direction of the difference is symmetric between the two samples. In many important cases, however, these assumptions are not appropriate because: 1) more than half of the genes are differentially expressed on the array; 2) the numbers of over- and under-expressed genes on the array are unequal; 3) only genes of specific biological interest are selected to make a customized array, which are highly variable across the samples. In the above cases, the global normalization methods and intensity/location based normalization methods become less accurate and a more sophisticated method is needed [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>].</p><p>There are some methods which attempt to adaptively identify the subset of 'housekeeping' genes [<xref ref-type="bibr" rid="B6">6</xref>-<xref ref-type="bibr" rid="B8">8</xref>]. These methods require multiple arrays in order to identify the 'housekeeping' gene set, which does not always exist.</p><p>Newton <italic>et al. </italic>proposed a Gamma-Gamma-Bernoulli model for identifying differentially expressed genes in dual labeled arrays [<xref ref-type="bibr" rid="B9">9</xref>]. We have generalized Newton's model and here propose an adaptive method based on three-component mixture model for normalization of dual labeled microarray data.</p></sec><sec><title>Results</title><p>As described in the Methods section, we have applied our adaptive method to both the simulated data and real data. We have also compared our method with the global method and the intensity-based lowess method.</p><p>Results of the simulation studies are shown as bar plots in Figure <xref ref-type="fig" rid="F1">1</xref>. Figure <xref ref-type="fig" rid="F1">1A</xref> shows the comparison of our adaptive method, the global method and the lowess method when no noise was added. When the majority of genes in the array were non-differentially expressed (Case 1), or the numbers of over- and under-expressed genes on the array were equal (Case 2), the root mean squared error (RMSE) of the adaptive method was comparable with the other two methods; all were very small. When the array contained unequal numbers of over- and under-expressed genes and when the majority of genes were differentially expressed (Cases 3&#x02013;6), the RMSEs of the global normalization method and the lowess method were much larger than those of the adaptive method. The differences ranged from around a two fold difference (0.895 in log<sub>2 </sub>scale) when the number of under-, null, and over-expressed genes were 200, 100, and 100, to more than a three fold difference (1.617 in log<sub>2 </sub>scale) when the number of under-, null, and over-expressed genes were 200, 50, and 50. The RMSEs for the adaptive method ranged from 0.078 to 0.159 in log<sub>2 </sub>scale.</p><p>We compared the histogram of observed intensities to the fitted marginal density from the adaptive method as a simple check to see whether the proposed model and the estimation procedure are in line with available data. Figure <xref ref-type="fig" rid="F2">2</xref> shows the histograms of log(ratio) and log intensities of red and green channels of the simulated data, and the curve in each plot is the estimated density obtained from the fitted model. It is seen the data fits to the model quite well.</p><p>Gaussian noise with SD of 0.25 and 0.50 were added so that the data was not generated from the same model used for analysis with the adaptive method. The RMSEs of the global normalization method and the lowess method remained large, while the RMSEs of the adaptive method remained small, ranging from 0.083 to 0.569 on the log<sub>2 </sub>scale (Figure <xref ref-type="fig" rid="F1">1B</xref> and <xref ref-type="fig" rid="F1">1C</xref>).</p><p>In the above simulation, no apparent groups could be seen in the histograms of log(ratio) (Figure <xref ref-type="fig" rid="F2">2A</xref>). Better results for the adaptive method were also obtained for a simulation case where the three groups (under-expressed, non-differentially expressed, and over-expressed) are apparent in the histogram of log(ratio). The results can be seen in Figure 4 and Figure 5 [see Additional files <xref ref-type="supplementary-material" rid="S3">3</xref>, <xref ref-type="supplementary-material" rid="S4">4</xref>].</p><p>Results comparing RMSEs for the adaptive method, the global method and the lowess method with real data are shown in Table <xref ref-type="table" rid="T2">2</xref>. The RMSEs of the adaptive method on data generated from ten different arrays ranged from 0.128 to 0.529, in comparison with RMSEs of around 1.0 using the global normalization method. The average RMSE (0.607) of the lowess method is almost two times that of our adaptive method (0.328), although the lowess method performed better than the global method (average RMSE = 1.016). Figure <xref ref-type="fig" rid="F3">3</xref> shows the histograms of log(ratio) and log intensities of red and green channels of the real data, and the curve in each plot is the estimated density from the adaptive method.</p></sec><sec><title>Discussion</title><p>In this paper, we propose a new method for normalization of dual-labeled arrays in cases where the number of differentially expressed genes is substantial and not necessarily symmetric in direction. The method performed effectively with both simulated and real data.</p><p>We started our model building initially by introducing an unknown constant <italic>c </italic>into Newton's Gamma-Gamma-Bernoulli model [<xref ref-type="bibr" rid="B9">9</xref>]. The mixture model consisted of two groups: non-differentially expressed genes (Equation 1A) and differentially expressed genes (Equation 1B).</p><p>log(<italic>cR</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <italic>s</italic><sub><italic>k</italic></sub>)</p><p>log(<italic>G</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <italic>s</italic><sub><italic>k</italic></sub>) &#x000a0;&#x000a0;&#x000a0; (1A)</p><p><italic>s</italic><sub><italic>k </italic></sub>~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic>)</p><p>log(<italic>cR</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <inline-graphic xlink:href="1471-2105-6-28-i1.gif"/>)</p><p>log(<italic>G</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <inline-graphic xlink:href="1471-2105-6-28-i2.gif"/>) &#x000a0;&#x000a0;&#x000a0; (1B)</p><p><inline-graphic xlink:href="1471-2105-6-28-i1.gif"/> ~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic>)</p><p><inline-graphic xlink:href="1471-2105-6-28-i2.gif"/> ~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic>)</p><p>We found that when the differential expression was symmetric between the two samples, the model worked well. However, the error increased significantly when the ratio of the numbers of under- to over-expressed genes shifted from 1.</p><p>In order to make the model more flexible, we modified the model by assigning different scale factors <italic>&#x003b3;</italic><sub><italic>R </italic></sub>and <italic>&#x003b3;</italic><sub><italic>G </italic></sub>for the red channel and green channel intensities. For this modified two-component mixture, the error still remained large. We then extended the model into a three-component mixture model listed as Equations 8A-8C in the additional material [see <xref ref-type="supplementary-material" rid="S2">Additional file 2</xref>]. The model was then quite flexible but there were too many parameters that needed to be optimized. After we tested it with simulation data and real data, we found the estimated model was not stable and difficult to optimize. We finally simplified the model to our final model given by Equations 2A-2C (see Methods section). When applying it to real data or simulated data, the estimates converged well close to globe optima. When different start points were used, the optimizations remained relatively robust.</p><p>Evaluation of normalization methods can be difficult since the true normalization factors are unknown with real data for custom arrays. We avoided this problem by synthesizing customized arrays based on real data for standard arrays containing thousands of genes. In order to make the distribution of each component group look smoother, we allowed certain range of overlap between the adjacent groups. Additional sampling method was tried to divide the whole distribution range into many non-overlapping intervals. In each interval the number of genes sampled increased when the absolute value of log<sub>2</sub>(ratio) became larger (Table 3 [see <xref ref-type="supplementary-material" rid="S6">Additional file 6</xref>]). The model fitting results using data generated by this sampling method are listed in Table 4 [see <xref ref-type="supplementary-material" rid="S7">Additional file 7</xref>] and Figure 6 [see <xref ref-type="supplementary-material" rid="S5">Additional file 5</xref>].</p><p>We compared our adaptive method with the global method and the intensity-based lowess method. The lowess method assumes that in each intensity interval either the majority of genes are non-differentially expressed or the numbers of up- and down-regulated genes are equal. The global median normalization makes these assumptions only over the array as a whole. It is not surprising that our method performed much better that the above two methods, because the global median method only works well when the assumptions are valid while the intensity-based lowess method is only effective when there are intensity-dependent biases.</p><p>Correlation structure is complicated for the thousands of genes on a microarray. In our model, the intensity of each channel is conditionally independent given the scale parameter, but not marginally independent.Therefore, we are not assuming the intensities in two channels are independent. Although we did not generate correlated genes in our simulated data sets, correlations of genes do exist in the real data sets we tested. Spatial correlations are also possible but our method is not designed for that purpose. Yang <italic>et al. </italic>proposed using the lowess normalization separately within each grid on the array [<xref ref-type="bibr" rid="B3">3</xref>]. Our algorithm could be similarly applied within each grid to control for spatial effects.</p><p>Limited simulations were performed in this study. We also tried to use real data to test our method. Since an appropriate data set with known normalization factor was not available, we synthesized such data sets by sub-setting large arrays in which the true normalization factor could be accurately estimated. In the process of synthesizing such small arrays we had to choose an empirical threshold to stratify the differentially expressed genes and non-differentially expressed genes. Although we do not believe that the superiority shown for our algorithm depends critically on the threshold chosen nor on details of the synthesis, it would be preferable to evaluate the algorithm on real data sets with know normalization factors.</p><p>Although our method is designed for dual-labeled cDNA array, it can be extended to single channel Affymetrix chip data. The most popular normalization method for the Affymetrix chip compares each array to a single base line array for probe set summaries. The assumptions behind the normalization method are that the majority of the genes are non-differentially expressed and the numbers of over- and under-expressed genes are roughly equal; the same assumptions as those for dual-labeled cDNA arrays. We could treat the base line array as the 'reference channel' and the other array as the 'test' channel and apply our algorithm to probe set summaries. For Affymetrix chip data, there are multiple base pairs in a probe set and each probe has an intensity measurement. Several alternative normalization methods of Affymetrix arrays utilize the probe level information. For example, method based on an 'invariant set' proposed by Li and Wong assumes that a probe of a non-differentially expressed genes in two arrays to have similar ranks and uses an iterative procedure to identify the invariant set which presumably consists of points from non-differentially expressed genes [<xref ref-type="bibr" rid="B10">10</xref>].</p></sec><sec><title>Conclusions</title><p>Our new normalization method does not require that the majority of genes be non-differentially expressed, and doesn't require multiple array replicates, dye swaps, spiked controls, or housekeeping genes. It appears much more effective than standard methods when the numbers of over- and under-expressed genes are unequal, and the majority of the genes are differentially expressed. It can be very useful for general microarray platforms when samples with very different expression profile are co-hybridized and for custom arrays where the majority of genes are likely to be differentially expressed. In both of these settings, standard normalization methods are problematic.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Model</title><p>We define true intensities for a specific gene <italic>k </italic>in two channels as <italic>R</italic><sub><italic>k </italic></sub>(red) and <italic>G</italic><sub><italic>k </italic></sub>(green). Let <italic>c </italic>be a positive constant which is related to the normalization constant. The observed intensities for gene <italic>k </italic>in two channels are <italic>cR</italic><sub><italic>k </italic></sub>and <italic>G</italic><sub><italic>k</italic></sub>. We assume the logarithm of intensity in each channel has a <italic>Gamma </italic>distribution. The genes on the array belong to three different groups: 1) non-differentially expressed; 2) under-expressed; and 3) over-expressed. The overall data will be fitted into a mixture model listed below.</p><p>For a non-differentially expressed gene <italic>k</italic>,</p><p>log(<italic>cR</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <italic>s</italic><sub><italic>k</italic></sub>)</p><p>log(<italic>G</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <italic>s</italic><sub><italic>k</italic></sub>) &#x000a0;&#x000a0;&#x000a0; (2A)</p><p><italic>s</italic><sub><italic>k </italic></sub>~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic>).</p><p>For an under-expressed gene <italic>k</italic>,</p><p>log(<italic>cR</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <inline-graphic xlink:href="1471-2105-6-28-i1.gif"/>)</p><p>log(<italic>G</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <inline-graphic xlink:href="1471-2105-6-28-i2.gif"/>) &#x000a0;&#x000a0;&#x000a0; (2B)</p><p><inline-graphic xlink:href="1471-2105-6-28-i1.gif"/> ~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic><sub>1</sub>)</p><p><inline-graphic xlink:href="1471-2105-6-28-i2.gif"/> ~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic><sub>2</sub>).</p><p>For an over-expressed gene <italic>k</italic>,</p><p>log(<italic>cR</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <inline-graphic xlink:href="1471-2105-6-28-i1.gif"/>)</p><p>log(<italic>G</italic><sub><italic>k</italic></sub>) ~ <italic>Gamma</italic>(<italic>a</italic>, <inline-graphic xlink:href="1471-2105-6-28-i2.gif"/>) &#x000a0;&#x000a0;&#x000a0; (2C)</p><p><inline-graphic xlink:href="1471-2105-6-28-i1.gif"/> ~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic><sub>2</sub>)</p><p><inline-graphic xlink:href="1471-2105-6-28-i2.gif"/> ~ <italic>Gamma</italic>(<italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic><sub>1</sub>).</p><p>In the above <italic>Gamma </italic>distributions, the parameters <italic>a </italic>and <italic>a</italic><sub>0 </sub>are shape factors, and the parameters <italic>s</italic><sub><italic>k</italic></sub>, <italic>&#x003b3;</italic>, <italic>&#x003b3;</italic><sub>1</sub>,<italic>&#x003b3;</italic><sub>2</sub>, <inline-graphic xlink:href="1471-2105-6-28-i1.gif"/>, <inline-graphic xlink:href="1471-2105-6-28-i2.gif"/> are scale factors. The parameters <italic>a</italic>, <italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic>, <italic>&#x003b3;</italic><sub>1</sub>, <italic>&#x003b3;</italic><sub>2 </sub>will be estimated from the data.</p><p>Let <italic>p</italic><sub><italic>u</italic></sub>(<italic>R</italic><sub><italic>k</italic></sub>, <italic>G</italic><sub><italic>k</italic></sub>), <italic>p</italic><sub><italic>o</italic></sub>(<italic>R</italic><sub><italic>k</italic></sub>, <italic>G</italic><sub><italic>k</italic></sub>) and <italic>p</italic><sub><italic>n</italic></sub>(<italic>R</italic><sub><italic>k</italic></sub>, <italic>G</italic><sub><italic>k</italic></sub>) be the densities of (<italic>R</italic><sub><italic>k</italic></sub>, <italic>G</italic><sub><italic>k</italic></sub>) for under-expressed, over-expressed and non-differentially expressed genes, respectively. The joint distributions of (<italic>R</italic><sub><italic>k</italic></sub>, <italic>G</italic><sub><italic>k</italic></sub>) in three groups can be derived as follows [details see <xref ref-type="supplementary-material" rid="S1">Additional file 1</xref>]:</p><p><inline-graphic xlink:href="1471-2105-6-28-i3.gif"/></p><p><inline-graphic xlink:href="1471-2105-6-28-i4.gif"/></p><p><inline-graphic xlink:href="1471-2105-6-28-i5.gif"/></p><p>Let <italic>&#x003b8; </italic>denote the unknown parameter vector (<italic>a</italic>, <italic>a</italic><sub>0</sub>, <italic>&#x003b3;</italic>, <italic>&#x003b3;</italic><sub>1</sub>, <italic>&#x003b3;</italic><sub>2</sub>, <italic>c</italic>), which can be estimated by maximizing the likelihood function of observed data. We used the EM algorithm [<xref ref-type="bibr" rid="B11">11</xref>] for this maximization. Let <italic>p</italic><sub>1 </sub>be the proportion of under-expressed genes and <italic>p</italic><sub>2 </sub>be the proportion of over-expressed genes. We define indicator binary variable <italic>z</italic><sub><italic>k</italic>1 </sub>to be 1 if the <italic>k</italic>th gene is under expressed, 0 otherwise; and <italic>z</italic><sub><italic>k</italic>2 </sub>to be 1 if the <italic>k</italic>th gene is over expressed, 0 otherwise. The <italic>complete-data loglikelihood </italic>for all spots can be derived as follows,</p><p><inline-graphic xlink:href="1471-2105-6-28-i6.gif"/></p><p>In the M-step, we first take derivative on Equation (4) with respect to <italic>p</italic><sub>1 </sub>and <italic>p</italic><sub>2</sub>. This yields</p><p><inline-graphic xlink:href="1471-2105-6-28-i7.gif"/></p><p><inline-graphic xlink:href="1471-2105-6-28-i8.gif"/></p><p>where <italic>K </italic>is the total number of genes on the array.</p><p>To maximize Equation (4), we only need to maximize Equation (6) because the left out terms do not depend on the parameter <italic>&#x003b8;</italic>.</p><p><inline-graphic xlink:href="1471-2105-6-28-i9.gif"/></p><p>In the E-step, we compute the conditional expectations of <italic>z</italic><sub><italic>k</italic>1 </sub>and <italic>z</italic><sub><italic>k</italic>2 </sub>given the other parameters from the M-step.</p><p><inline-graphic xlink:href="1471-2105-6-28-i10.gif"/></p><p><inline-graphic xlink:href="1471-2105-6-28-i11.gif"/></p><p>Once the constant <italic>c </italic>was obtained, the normalization constant for log intensity ratio data can be calculated as log(1/<italic>c</italic>).</p></sec></sec><sec><title>Model evaluation</title><p>Simulation studies were performed by generating two channel intensities from the mixture model with <italic>c </italic>= 1.5, <italic>a </italic>= 118, <italic>a</italic><sub>0 </sub>= 410, <italic>&#x003b3; </italic>= 31, <italic>&#x003b3;</italic><sub>1 </sub>= 23, and <italic>&#x003b3;</italic><sub>2 </sub>= 29. Six scenarios were included using different proportions of non-differentially expressed genes and different ratios of under- to over- expressed genes, as listed in Table <xref ref-type="table" rid="T1">1</xref>.</p><p>One hundred data sets were generated for each scenario and the RMSE between the estimated log<sub>2</sub>(1/<inline-graphic xlink:href="1471-2105-6-28-i12.gif"/>) and the true log2(1/<italic>c</italic>) was calculated. The global method takes the median log<sub>2</sub>(ratio) of all genes in each data set as the normalization factor. The lowess method performs robust locally linear fits of M-A plot and corrects the biases that are dependent on spot intensity [<xref ref-type="bibr" rid="B3">3</xref>]. The RMSE between the normalized log<sub>2</sub>(ratio) using the lowess method and the normalized log<sub>2</sub>(ratio) using the global method with the true normalization factor (log<sub>2</sub>(1/<italic>c</italic>)) for all genes was also calculated for the same 100 data sets.</p><p>Gaussian white noise was also added when generating the simulated data. We used standard deviation of 0.25 in log<sub>2 </sub>scale to reflect the experimental noise in inbred strains of mice or cell line data and 0.5 in log<sub>2 </sub>scale to reflect a larger experimental noise in human tissue data [<xref ref-type="bibr" rid="B12">12</xref>].</p><p><italic>In-silico </italic>studies were performed on real data. We tested the method on ten arrays from publicly available breast cancer data [<xref ref-type="bibr" rid="B13">13</xref>]. Each array consists of 9216 genes. The common reference sample was a pool of RNA isolated from 11 different cultured cell lines (green channel, labeled with Cy3). RNA from tissues of breast cancer patients were used in the test channel (red channel, labeled with Cy5). The array was first normalized by the global normalization method. The median log<sub>2</sub>(ratio) of all genes was considered as the true normalization factor <italic>c</italic>. The genes were then divided into three groups: over-expressed genes (log<sub>2</sub>(ratio)&#x0003e;1), non-differentially expressed genes(-1.5&#x0003c;log<sub>2</sub>(ratio)&#x0003c;1.5), and under-expressed genes (log<sub>2</sub>(ratio)&#x0003c;-1). We randomly sampled a specified number of genes from each group (100 non-differentially expressed genes, 200 under-expressed and 100 over-expressed genes) and then combined them into an <italic>in-silico </italic>array. We constructed 100 datasets for each of the 10 arrays in this way and the RMSE between the estimated log<sub>2</sub>(1/ <inline-graphic xlink:href="1471-2105-6-28-i12.gif"/>) and the true log<sub>2</sub>(1/<italic>c</italic>) was calculated.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S3"><caption><title>Additional File 3</title><p>Figure 4: Bar plots show comparison of RMSE by using the adaptive method (black bar) and global method (grey bar) with simulated data generated from a mixture model with <italic>c </italic>= 1.5, <italic>a </italic>= 90, <italic>a</italic><sub>0 </sub>= 120, <italic>&#x003b3; </italic>= 8, <italic>&#x003b3;</italic><sub>1 </sub>= 6, and <italic>&#x003b3;</italic><sub>2 </sub>= 10 at three different noise levels (A) SD = 0; (B) SD = 0.25; and (C) SD = 0.50.</p></caption><media xlink:href="1471-2105-6-28-S3.jpeg" mimetype="image" mime-subtype="jpeg"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S4"><caption><title>Additional File 4</title><p>Figure 5: Histograms and the estimated densities of log(ratio) and log(intensity) for a simulated data of a mixture model with <italic>c </italic>= 1.5, <italic>a </italic>= 90, <italic>a</italic><sub>0 </sub>= 120, <italic>&#x003b3; </italic>= 8, <italic>&#x003b3;</italic><sub>1 </sub>= 6, and <italic>&#x003b3;</italic><sub>2 </sub>= 10. The superimposed curve on each plot is generated from the fitted model.</p></caption><media xlink:href="1471-2105-6-28-S4.jpeg" mimetype="image" mime-subtype="jpeg"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional File 2</title><p>Equations 8A-8C: a three-component mixture model.</p></caption><media xlink:href="1471-2105-6-28-S2.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S5"><caption><title>Additional File 5</title><p>Figure 6: Histograms and the estimated densities of log(ratio) and log(intensity) for a set of real data generated from array svcc109. The superimposed curve on each plot is generated from the fitted model. The procedure to generate the data was described in the paper and the sampling rate was shown in Table 3 [see <xref ref-type="supplementary-material" rid="S6">Additional file 6</xref>].</p></caption><media xlink:href="1471-2105-6-28-S5.jpeg" mimetype="image" mime-subtype="jpeg"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S6"><caption><title>Additional File 6</title><p>Table 3: Different number of genes sampled in each interval.</p></caption><media xlink:href="1471-2105-6-28-S6.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S7"><caption><title>Additional File 7</title><p>Table 4: Comparison of RMSE by using the adaptive method and global method with real data by a different sampling method. The procedure to generate the data was described in the paper and the sampling rate was shown in Table 3 [see <xref ref-type="supplementary-material" rid="S6">Additional file 6</xref>].</p></caption><media xlink:href="1471-2105-6-28-S7.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S1"><caption><title>Additional File 1</title><p>Derivation of joint distributions of (R, G) for <italic>p</italic><sub><italic>n</italic></sub>, <italic>p</italic><sub><italic>u</italic></sub>, and <italic>p</italic><sub><italic>o </italic></sub></p></caption><media xlink:href="1471-2105-6-28-S1.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgement</title><p>We thank Dr. George Wright for reading our manuscript and helpful discussions, and the editor and reviewers who provided valuable suggestions.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zien</surname><given-names>A</given-names></name><name><surname>Aigner</surname><given-names>T</given-names></name><name><surname>Zimmer</surname><given-names>R</given-names></name><name><surname>Lengauer</surname><given-names>T</given-names></name></person-group><article-title>Centralization: a new method for the normalization of gene expression data</article-title><source>Bioinformatics</source><year>2001</year><fpage>S323</fpage><lpage>331</lpage><pub-id pub-id-type="pmid">11473024</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Quackenbush</surname><given-names>J</given-names></name></person-group><article-title>Microarray data normalization and transformation</article-title><source>Nature Genetics</source><year>2002</year><fpage>496</fpage><lpage>501</lpage><pub-id pub-id-type="pmid">12454644</pub-id><pub-id pub-id-type="doi">10.1038/ng1032</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>YH</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name><name><surname>Luu</surname><given-names>P</given-names></name><name><surname>Lin</surname><given-names>DM</given-names></name><name><surname>Peng</surname><given-names>V</given-names></name><name><surname>Ngai</surname><given-names>J</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>Normalization for cDNA microarray data: a robust composite method addressing single and multiple slide systematic variation</article-title><source>Nucleic Acids Research</source><year>2002</year><volume>30</volume><fpage>e15</fpage><pub-id pub-id-type="pmid">11842121</pub-id><pub-id pub-id-type="doi">10.1093/nar/30.4.e15</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kepler</surname><given-names>TB</given-names></name><name><surname>Crosby</surname><given-names>L</given-names></name><name><surname>Morgan</surname><given-names>KT</given-names></name></person-group><article-title>Normalization and analysis of DNA microarray data by self-consistency and local regression</article-title><source>Genome Biology</source><year>2002</year><volume>3</volume><fpage>research0037</fpage><pub-id pub-id-type="pmid">12184811</pub-id><pub-id pub-id-type="doi">10.1186/gb-2002-3-7-research0037</pub-id></citation></ref><ref id="B5"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Stivers</surname><given-names>DN</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Rosner</surname><given-names>GL</given-names></name><name><surname>Coombes</surname><given-names>KR</given-names></name></person-group><article-title>Organ-specific differences in gene expression and UniGene annotations describing source material</article-title><source>Methods of Microarray Data Analysis III</source><year>2003</year><publisher-name>Kluwer Academic Publishers</publisher-name><fpage>59</fpage><lpage>72</lpage></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>DL</given-names></name><name><surname>Buckley</surname><given-names>MJ</given-names></name><name><surname>Helliwell</surname><given-names>CA</given-names></name><name><surname>Wilson</surname><given-names>IW</given-names></name></person-group><article-title>New normalization methods for cDNA microarray data</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1325</fpage><lpage>1332</lpage><pub-id pub-id-type="pmid">12874043</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg146</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Lu</surname><given-names>J</given-names></name><name><surname>Lee</surname><given-names>R</given-names></name><name><surname>Gu</surname><given-names>Z</given-names></name><name><surname>Clarke</surname><given-names>R</given-names></name></person-group><article-title>Iterative normalization of cDNA Microarray data</article-title><source>IEEE Trans On Info Tech in Biom</source><year>2002</year><volume>6</volume><fpage>29</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1109/4233.992159</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stoyanova</surname><given-names>R</given-names></name><name><surname>Querec</surname><given-names>TD</given-names></name><name><surname>Brown</surname><given-names>TR</given-names></name><name><surname>Patriotis</surname><given-names>C</given-names></name></person-group><article-title>Normalization of single-channel DNA array data by principal component analysis</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1772</fpage><lpage>1784</lpage><pub-id pub-id-type="pmid">15037508</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth170</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Newton</surname><given-names>MA</given-names></name><name><surname>Kendziorski</surname><given-names>CM</given-names></name><name><surname>Richmond</surname><given-names>CS</given-names></name><name><surname>Blattner</surname><given-names>FR</given-names></name><name><surname>Tsui</surname><given-names>KW</given-names></name></person-group><article-title>On differential variability of expression ratios: Improving statistical inference about gene expression changes from microarray data</article-title><source>J Computat Biol</source><year>2001</year><volume>8</volume><fpage>37</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1089/106652701300099074</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group><article-title>Model-based analysis of oligonucleotide arrays: model validation, design issues and standard error application</article-title><source>Genome Biology</source><year>2001</year><volume>2</volume><fpage>research0032</fpage><pub-id pub-id-type="pmid">11532216</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm (with discussion)</article-title><source>J Royal Statistical Society Series B</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname><given-names>RM</given-names></name><name><surname>Korn</surname><given-names>EL</given-names></name><name><surname>McShane</surname><given-names>LM</given-names></name><name><surname>Radmacher</surname><given-names>MD</given-names></name><name><surname>Wright</surname><given-names>GW</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name></person-group><article-title>Design and analysis of DNA microarray investigations</article-title><source>Springer</source><year>2004</year><fpage>24</fpage><lpage>25</lpage></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Perou</surname><given-names>CM</given-names></name><name><surname>Sorlie</surname><given-names>DT</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Van de Rijin</surname><given-names>M</given-names></name><name><surname>Jeffrey</surname><given-names>SS</given-names></name><name><surname>Rees</surname><given-names>CA</given-names></name><name><surname>Pollack</surname><given-names>JR</given-names></name><name><surname>Ross</surname><given-names>DT</given-names></name><name><surname>Johnson</surname><given-names>H</given-names></name><name><surname>Akslen</surname><given-names>LA</given-names></name><name><surname>Fluge</surname><given-names>&#x000d8;</given-names></name><name><surname>Pergamenschikov</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>C</given-names></name><name><surname>Zhu</surname><given-names>SX</given-names></name><name><surname>L&#x000f8;nning</surname><given-names>PE</given-names></name><name><surname>B&#x000f8;rresen-Dale</surname><given-names>AL</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Molecular portraits of human breast tumors</article-title><source>Nature</source><year>2000</year><volume>406</volume><fpage>747</fpage><lpage>752</lpage><pub-id pub-id-type="pmid">10963602</pub-id><pub-id pub-id-type="doi">10.1038/35021093</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p>Bar plots show comparison of RMSEs by using the global method (black bar), the lowess method (grey bar), and the adaptive method (white bar) for normalization with simulated data generated from a mixture model with <italic>c </italic>= 1.5, <italic>a </italic>= 118, <italic>a</italic><sub>0 </sub>= 410, <italic>&#x003b3; </italic>= 31, <italic>&#x003b3;</italic><sub>1 </sub>= 23, and <italic>&#x003b3;</italic><sub>2 </sub>= 29 at three different noise levels (A) SD = 0; (B) SD = 0.25; and (C) SD = 0.50.</p></caption><graphic xlink:href="1471-2105-6-28-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p>Histograms and the estimated densities of log(ratio) and log(intensity) for a set of simulated data generated from a mixture model with <italic>c </italic>= 1.5, <italic>a </italic>= 118, <italic>a</italic><sub>0 </sub>= 410, <italic>&#x003b3; </italic>= 31, <italic>&#x003b3;</italic><sub>1 </sub>= 23, and <italic>&#x003b3;</italic><sub>2 </sub>= 29. The superimposed curve on each plot is generated from the fitted model.</p></caption><graphic xlink:href="1471-2105-6-28-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p>Histograms and the estimated densities of log(ratio) and log(intensity) for a set of real data generated from array svcc109. The superimposed curve on each plot is generated from the fitted model.</p></caption><graphic xlink:href="1471-2105-6-28-3"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Six scenarios using different proportions of non-differentially expressed genes and different ratios of under- to over-expressed genes with simulated data.</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td align="center" colspan="3">Number of genes</td></tr><tr><td align="center">Case</td><td align="center">Under-expressed</td><td align="center">Non-differentially expressed</td><td align="center">Over-expressed</td></tr></thead><tbody><tr><td align="center">1</td><td align="center">100</td><td align="center">500</td><td align="center">100</td></tr><tr><td align="center">2</td><td align="center">100</td><td align="center">100</td><td align="center">100</td></tr><tr><td align="center">3</td><td align="center">200</td><td align="center">100</td><td align="center">100</td></tr><tr><td align="center">4</td><td align="center">200</td><td align="center">100</td><td align="center">50</td></tr><tr><td align="center">5</td><td align="center">200</td><td align="center">50</td><td align="center">100</td></tr><tr><td align="center">6</td><td align="center">200</td><td align="center">50</td><td align="center">50</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Comparison of RMSEs by using the global method, the lowess method, and the adaptive method for normalization with real data.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Case</td><td align="center">Array ID</td><td align="center">Global</td><td align="center">Lowess</td><td align="center">Adaptive</td></tr></thead><tbody><tr><td align="center">1</td><td align="center">svcc134</td><td align="center">1.082</td><td align="center">0.600</td><td align="center">0.315</td></tr><tr><td align="center">2</td><td align="center">svcc104</td><td align="center">1.023</td><td align="center">0.601</td><td align="center">0.508</td></tr><tr><td align="center">3</td><td align="center">svcc120</td><td align="center">1.005</td><td align="center">0.552</td><td align="center">0.435</td></tr><tr><td align="center">4</td><td align="center">svcc64</td><td align="center">0.999</td><td align="center">0.593</td><td align="center">0.516</td></tr><tr><td align="center">5</td><td align="center">svcc106</td><td align="center">0.967</td><td align="center">0.704</td><td align="center">0.128</td></tr><tr><td align="center">6</td><td align="center">svcc89</td><td align="center">1.018</td><td align="center">0.593</td><td align="center">0.284</td></tr><tr><td align="center">7</td><td align="center">svcc109</td><td align="center">1.014</td><td align="center">0.577</td><td align="center">0.264</td></tr><tr><td align="center">8</td><td align="center">svcc103</td><td align="center">1.011</td><td align="center">0.653</td><td align="center">0.138</td></tr><tr><td align="center">9</td><td align="center">svcc98</td><td align="center">1.022</td><td align="center">0.631</td><td align="center">0.159</td></tr><tr><td align="center">10</td><td align="center">svcc82</td><td align="center">1.017</td><td align="center">0.567</td><td align="center">0.529</td></tr><tr><td align="center">Average RMSE</td><td></td><td align="center">1.016</td><td align="center">0.607</td><td align="center">0.328</td></tr></tbody></table></table-wrap></sec></back></article>



