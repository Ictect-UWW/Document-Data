<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15760465</article-id><article-id pub-id-type="pmc">PMC555743</article-id><article-id pub-id-type="publisher-id">1471-2105-6-50</article-id><article-id pub-id-type="doi">10.1186/1471-2105-6-50</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Unbiased descriptor and parameter selection confirms the potential of proteochemometric modelling</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Freyhult</surname><given-names>Eva</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Eva.Freyhult@lcb.uu.se</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Prusis</surname><given-names>Peteris</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>Peteris.Prusis@farmbio.uu.se</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Lapinsh</surname><given-names>Maris</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>Maris.Lapinsh@farmbio.uu.se</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Wikberg</surname><given-names>Jarl ES</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>Jarl.Wikberg@farmbio.uu.se</email></contrib><contrib id="A5" contrib-type="author"><name><surname>Moulton</surname><given-names>Vincent</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Vincent.Moulton@lcb.uu.se</email></contrib><contrib id="A6" corresp="yes" contrib-type="author"><name><surname>Gustafsson</surname><given-names>Mats G</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>Mats.Gustafsson@signal.uu.se</email></contrib></contrib-group><aff id="I1"><label>1</label>The Linnaeus Centre for Bioinformatics, Uppsala University, Box 598, S-751 24 Uppsala, Sweden</aff><aff id="I2"><label>2</label>Department of Pharmaceutical Biosciences, Uppsala University, Box 591, S-751 24 Uppsala, Sweden</aff><aff id="I3"><label>3</label>Department of Engineering Sciences, Uppsala University, Box 528, S-751 20 Uppsala, Sweden</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>10</day><month>3</month><year>2005</year></pub-date><volume>6</volume><fpage>50</fpage><lpage>50</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/50"/><history><date date-type="received"><day>20</day><month>9</month><year>2004</year></date><date date-type="accepted"><day>10</day><month>3</month><year>2005</year></date></history><copyright-statement>Copyright &#x000a9; 2005 Freyhult et al; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>Proteochemometrics is a new methodology that allows prediction of protein function directly from real interaction measurement data without the need of 3D structure information. Several reported proteochemometric models of ligand-receptor interactions have already yielded significant insights into various forms of bio-molecular interactions. The proteochemometric models are multivariate regression models that predict binding affinity for a particular combination of features of the ligand and protein. Although proteochemometric models have already offered interesting results in various studies, no detailed statistical evaluation of their average predictive power has been performed. In particular, variable subset selection performed to date has always relied on using all available examples, a situation also encountered in microarray gene expression data analysis.</p></sec><sec><title>Results</title><p>A methodology for an unbiased evaluation of the predictive power of proteochemometric models was implemented and results from applying it to two of the largest proteochemometric data sets yet reported are presented. A double cross-validation loop procedure is used to estimate the expected performance of a given design method. The unbiased performance estimates (<italic>P</italic><sup>2</sup>) obtained for the data sets that we consider confirm that properly designed single proteochemometric models have useful predictive power, but that a standard design based on cross validation may yield models with quite limited performance. The results also show that different commercial software packages employed for the design of proteochemometric models may yield very different and therefore misleading performance estimates. In addition, the differences in the models obtained in the double CV loop indicate that detailed chemical interpretation of a single proteochemometric model is uncertain when data sets are small.</p></sec><sec><title>Conclusion</title><p>The double CV loop employed offer unbiased performance estimates about a given proteochemometric modelling procedure, making it possible to identify cases where the proteochemometric design does not result in useful predictive models. Chemical interpretations of single proteochemometric models are uncertain and should instead be based on all the models selected in the double CV loop employed here.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Current computational methods for prediction of protein function rely to a large extent on predictions based on the amino acid sequence similarity with proteins having known functions. The accuracy of such predictions depends on how much information about function is embedded in the sequence similarity and on how well the computational methods are able to extract that information. Other computational methods for prediction of protein function include structural similarity comparisons and molecular dynamics simulations (e.g. molecular docking). Although these latter methods are powerful and may in general offer important 3D mechanistic explanations of interaction and function, they require access to protein 3D structure. Computational determination of a 3D structure is well known to be resource demanding, error prone, and generally requires prior knowledge, such as the 3D structure of a homologous protein. This bottleneck makes it important to develop new methods for prediction of protein function when a 3D model is not available.</p><p>Recently a new bioinformatic approach to prediction of protein function called <italic>proteochemometrics </italic>was introduced that has several useful features [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. In proteochemometrics the physico-chemical properties of the interacting molecules are used to characterize protein interaction and classify the proteins into different categories using multivariate statistical techniques. One major strength of proteochemometrics is that the results are obtained directly from real interaction measurement data and do not require access to any 3D protein structure model to provide quite specific information about interaction.</p><p>Proteochemometrics has its roots in chemometrics, the subfield of chemistry associated with statistical planning, modelling and analysis of chemical experiments [<xref ref-type="bibr" rid="B5">5</xref>]. In particular it is closely related to quantitative-structure activity relationship (QSAR) modelling, a branch of chemometrics used in computer based drug discovery. Modern computer based drug discovery is based on modelling interactions between small drug candidates (ligands) and proteins. The standard approach is to predict the affinity of a ligand by means of numerical calculations from first principles using molecular dynamics or quantum mechanics. QSAR modelling is an alternative approach where experimental observations are used to design a multivariate regression model.</p><p>With <italic>x</italic><sub><italic>i </italic></sub>denoting descriptor <italic>i </italic>among <italic>D </italic>different descriptors and <italic>y </italic>denoting the biological activity, (linear) QSAR modelling aims at a linear multivariate model</p><p><italic>y </italic>= <bold>w</bold><sup><italic>T </italic></sup><bold>x </bold>= <italic>w</italic><sub>0 </sub>+ <italic>w</italic><sub>1</sub><italic>x</italic><sub>1 </sub>+ <italic>w</italic><sub>2</sub><italic>x</italic><sub>2 </sub>+ ... + <italic>w</italic><sub><italic>D</italic></sub><italic>x</italic><sub><italic>D </italic></sub>&#x000a0;&#x000a0;&#x000a0; (1)</p><p>where <bold>w </bold>= [<italic>w</italic><sub>0</sub>, <italic>w</italic><sub>1</sub>, <italic>w</italic><sub>2</sub>,..., <italic>w</italic><sub><italic>D</italic></sub>]<sup><italic>T </italic></sup>are the regression coefficients and <bold>x </bold>= [1, <italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>,..., <italic>x</italic><sub><italic>D</italic></sub>]<sup><italic>T</italic></sup>. The activity <italic>y</italic>, may be the binding affinity to a receptor but may also be any biological activity e.g., the growth inhibition of cancer cells. In comparison with numerical calculations from first principles and similar approaches, the main advantages of QSAR modelling are that it does not require access to the molecular details of the biological subsystem of interest and that information can be obtained directly from relatively cheap measurements.</p><p>The joint perturbation of both the ligand and protein in proteochemometrics yields additional information about the different combinations of ligand and protein properties for an interaction than can be obtained in conventional QSAR modelling where only the ligand is perturbed. In recent years, various other bioinformatic modifications of conventional QSAR modelling have been reported. These include simultaneous modifications of the ligand and the chemical environment (buffer composition and/or temperature) in which the interaction take place [<xref ref-type="bibr" rid="B6">6</xref>-<xref ref-type="bibr" rid="B8">8</xref>], and three-dimensional QSAR modelling of protein-protein interactions that directly yields valuable stereo-chemical information [<xref ref-type="bibr" rid="B9">9</xref>].</p><p>Although proteochemometrics has already proven to be an useful methodology for improved understanding of bio-chemical interactions directly from measurement data, the quantitative proteochemometric models designed so far have not yet been subject to a detailed and unbiased statistical evaluation.</p><p>A key issue in this evaluation is the problem of overfitting. Since the number of ligand and protein properties available is usually very large, to avoid overfitting, one has to constrain the fitting of the regression coefficients. For example, in ridge regression [<xref ref-type="bibr" rid="B10">10</xref>], a penalty parameter is tuned based on data to avoid overfitting, and in partial least squares (PLS) regression [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B13">13</xref>] the overfitting is controlled by tuning the number of latent variables employed. In proteochemometrics as well as in many QSAR studies reported, the performance estimates reported are obtained as follows: 1) Perform a <italic>K</italic>-fold CV for different regression parameters, 2) Select the parameter value that yields the largest estimated performance value, and 3) Report the most promising model found and the associated performance estimate. Although this procedure may seem intuitive and may yield predictive models (as we in fact demonstrate below) the performance estimates obtained in this way may be heavily biased. Interestingly, this problem was recently addressed in the context of conventional QSAR modelling [<xref ref-type="bibr" rid="B14">14</xref>], and has also been discussed in earlier work, see [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>].</p><p>As an alternative or complement to constraining the regression coefficients, one may also reduce the variance by means of variable subset selection (VSS). In QSAR modelling, many algorithms for VSS have been proposed based on various methodologies, for example optimal experimental design [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B18">18</xref>], sequential refinements [<xref ref-type="bibr" rid="B19">19</xref>], and global optimization [<xref ref-type="bibr" rid="B20">20</xref>]. VSS is used to exclude variables that are not important for the response variable, in the process of model building. Variables that are not important receive low weights in both a PLS and a ridge regression model, however if the fraction of unimportant variables is very large [<xref ref-type="bibr" rid="B21">21</xref>] the overall predictive power of the model is reduced. In this case VSS can improve the predictivity. However, if the fraction of unimportant variables is rather small, the quality of the model will not be improved by using VSS, it might on the contrary be slightly reduced. However, the interpretability of the model will in both cases be improved.</p><p>Although many of the advanced algorithms for VSS are powerful, they are all computationally demanding. Therefore, in order to keep the computing time down in our use of the double loop cross validation procedure employed here, conceptually and computationally simple algorithms for VSS were used instead of the more advanced ones presented, e.g. in [<xref ref-type="bibr" rid="B17">17</xref>-<xref ref-type="bibr" rid="B20">20</xref>]. Most likely, the more advanced algorithms would yield more reliable models with even higher predictive power than for the models designed here. However, the main issue of interest in this paper is to confirm the potential of proteochemometrics.</p><p>In previous reported proteochemometrics modelling, all available examples were used in the VSS. These were split into <italic>K </italic>separate parts and a conventional <italic>K</italic>-fold cross validation (CV) was performed. However, since all available examples were used, there were no longer any completely independent test examples available for model evaluation. Interestingly, this problem of introducing an optimistic selection bias via VSS was recently also pointed out in the supervised classification of gene expression microarray data [<xref ref-type="bibr" rid="B22">22</xref>].</p><p>In this paper we employ a procedure that can be used to perform unbiased statistical evaluations of proteochemometric and other QSAR modelling approaches. An overview of this so-called double loop CV procedure is presented in Figure <xref ref-type="fig" rid="F1">1</xref>, and may be regarded as a refinement of the current practice in proteochemometrics in the following respects:</p><p>1. <italic>K</italic><sub>1 </sub>different variable subset selections are performed, one for each step in the outer CV loop. This avoids optimistic selection bias.</p><p>2. The best performance estimates (<italic>Q</italic><sup>2</sup>) found in the inner loop by means of <italic>K</italic><sub>2</sub>-fold CV are computed, but not reported as the model's performance estimate. This avoids the second optimistic selection bias mentioned above.</p><p>3. An unbiased performance estimate, <italic>P</italic><sup>2</sup>, is computed in the outer loop and is reported as the performance estimate of the modelling approach defined by the procedure in the inner loop (the methods of VSS, regression, and model selection employed). <italic>P</italic><sup>2 </sup>is the result of different models that are designed and selected in the inner loop. It reflects the performance that one should expect on average.</p><p>4. Repeated <italic>K</italic><sub>1</sub>-fold CVs which yield information about the robustness in the results obtained (presented as confidence intervals).</p><p>In addition to these refinements, this work also demonstrates the potential of fast and straight forward alternative methods for VSS and regression in the inner loop. Moreover, it indicates that the performance estimates reported by certain software packages for QSAR may be quite misleading.</p><p>We reanalyzed two of the largest proteochemometric data sets yet reported. The first data set is presented in [<xref ref-type="bibr" rid="B2">2</xref>] and contains information about the interactions between 332 combinations of 23 different compounds with 21 different human and rat amine G-protein coupled receptors. In total, there are 23 &#x000d7; 21 = 483 possible interactions and the basic task is to fill in the 483-332 = 151 missing values. The second data is presented in [<xref ref-type="bibr" rid="B23">23</xref>] and contains information about the binding of 12 different compounds (4-piperidyl oxazole antagonists) to 18 human &#x003b1;<sub>1</sub>-adrenoreceptor variants (wild-types, chimeric, and point mutated). As for the first data set, there are not interaction data available for all the 12 &#x000d7; 18 = 216 possible interactions, but for 131, see [<xref ref-type="bibr" rid="B24">24</xref>] for more details about this data set. Below these two data sets are referred to as the <italic>amine data set </italic>and the <italic>alpha data set</italic>, respectively.</p></sec><sec><title>Results</title><sec><title>Software</title><p>Computer programs were written in MATLAB (Mathworks Inc., USA) to integrate the double loop procedure in Figure <xref ref-type="fig" rid="F1">1</xref> with robust multivariate linear regression using partial least squares (PLS) regression and ridge regression. These programs also contained two simple and fast methods for variable ranking called corrfilter and PLSfilter. For details, see the Methods section.</p></sec><sec><title>Parameters</title><p>The joint variable selection and PLS tuning performed in the inner <italic>K</italic><sub>2</sub>-fold CV loop was performed with <italic>K</italic><sub>2 </sub>= 5. The different values of <italic>N</italic><sub><italic>D </italic></sub>(the number of molecular descriptors) evaluated were 10, 20, 50, 100, 200, ..., 1000, 1500, 2000, ..., 6000 for the amine dataset and 10, 20, 50, 100, 200, ..., 1000, 1500, 2000 for the alpha data set. The values of <italic>N</italic><sub><italic>L </italic></sub>considered were either the number of latent variables 1, 2, ..., 8, for both the amine and alpha data set or the degree of RR penalty 0, 0.5, 1.0, ..., 3.0 for the amine data set and 10, 50, 100, 150, 200 for the alpha data set. In the outer <italic>K</italic><sub>1</sub>-fold CV loop, the same number of splits (<italic>K</italic><sub>1 </sub>= 5) was used as in the inner loop. On the global level, the complete experiments were performed 100 times using different random partitions of the complete data sets.</p></sec><sec><title>Unbiased predictive power</title><p>In Table <xref ref-type="table" rid="T1">1</xref> a summary of the results from 100 randomly selected partitions of the complete amine data set are presented in the form of the mean values and standard deviations obtained. The number of molecular descriptors and latent variables selected in the inner loop are summarized in Table <xref ref-type="table" rid="T2">2</xref>. The average values of the biased <italic>Q</italic><sup>2 </sup>obtained in the inner loops look quite promising for the PLSfilter method (<italic>Q</italic><sup>2 </sup>= 0.90 for both PLS and RR) and is even higher than the value reported in earlier studies [<xref ref-type="bibr" rid="B2">2</xref>]. However, the corresponding unbiased performance estimate <italic>P</italic><sup>2 </sup>is much smaller (<italic>P</italic><sup>2 </sup>= 0.52 or 0.51 for PLS and RR, respectively). The <italic>Q</italic><sup>2 </sup>values for the models obtained after variable selection using corrfilter are significantly lower than when using PLSfilter, but the <italic>P</italic><sup>2 </sup>values are almost on the same level for the two variable selection methods when no variable selection at all is used. corrfilter reduces the number of descriptors to about one third of the initial number, but corrfilter still selects more than twice as many descriptors than PLSfilter (see Table <xref ref-type="table" rid="T2">2</xref>). Since the main reason for variable selection is improving the interpretation of the model by reducing the number of descriptors, this indicates that one should select PLSfilter instead of corrfilter. In Figure <xref ref-type="fig" rid="F2">2</xref>, the external (unbiased) predictions used to compute <italic>P</italic><sup>2 </sup>for the PLS model using PLSfilter show that there is useful predictive power, but only for examples with mid-range <italic>pK</italic><sub><italic>i </italic></sub>values. The model has poor predictability for both low and high <italic>pK</italic><sub><italic>i </italic></sub>values, indicating that the standard design procedure used in the inner CV loop does not always yield reliable models. This confirms earlier findings [<xref ref-type="bibr" rid="B14">14</xref>], that maximization of the unbiased performance estimate <italic>Q</italic><sup>2 </sup>is not always reliable, and also indicates that unreliable designs can be detected by means of the outer CV loop employed in this work.</p><p>The estimated performances of the models for the alpha data sets are presented in Table <xref ref-type="table" rid="T3">3</xref>. Here both the <italic>Q</italic><sup>2 </sup>and <italic>P</italic><sup>2 </sup>values are high and the difference between the two measures is smaller than for the amine data set. This indicates a lower level of overfitting. The number of descriptors selected in the variable selection is much lower for the alpha data set (see Table <xref ref-type="table" rid="T4">4</xref>) than for the amine data set. Both the high <italic>P</italic><sup>2 </sup>values and the display of the external prediction in Figure <xref ref-type="fig" rid="F3">3</xref> show that the models have high predictive power. Also, the predictive power is significantly higher after variable selection than without. This is an example when variable selection does not only improve the model interpretability, but also the the model predictivity. The above results indicate, for example, that a combination of PLSfilter, PLS regression and model selection by maximization of <italic>Q</italic><sup>2 </sup>produces individual models with predictive power. The relative standard deviation of the predictive power is less than 5% for the two data sets considered. However, the number of variables selected has a relative standard deviation of 455/1933 = 25% and 69/199 = 35%, respectively. Moreover, the standard deviation in the number of latent variables (an implicit constraint on the regression coefficients) is approximately one (1.4 and 0.8) or 15%. In conclusion, the individual models are quite different but essentially all of them yield useful predictions.</p></sec><sec><title>Comparisons to other programs</title><p>To verify that our computations using MATLAB are comparable to computations by other programs, such as SIMCA, GOLPE and UNSCRAMBLER, models without variable selection were performed with all four approaches. In the comparison we have compared <italic>Q</italic><sup>2 </sup>values for models based on all descriptors built with PLS using between one and ten latent variables for the amine data set. All the <italic>Q</italic><sup>2 </sup>values were computed using the leave out CV method with five random groups and are presented in Figure <xref ref-type="fig" rid="F4">4</xref>.</p><p>Remarkably, the <italic>Q</italic><sup>2 </sup>values obtained with SIMCA 7.0 are much higher than for the other methods. This is due to the fact that SIMCA does not use the standard formula (Eq. 3) to compute <italic>Q</italic><sup>2 </sup>(personal communication with Umetrics), for some general information see [<xref ref-type="bibr" rid="B25">25</xref>].</p></sec><sec><title>Robustness and interpretability</title><p>To study the robustness and interpretability of the set of models obtained using the two data sets considered, two different levels of information were computed and presented. The first level of information consists of two histograms displaying, for each ligand block (L1&#x02013;L6 for the amine data set, and L1&#x02013;L3 for the alpha data set (for the alpha data set the three ligand blocks correspond to the three positions of modification in the ligand)), and for each transmembrane region (TM1&#x02013;TM7), how often different kinds of descriptors are selected. The histograms are based on the 500 observations obtained in the 5-fold cross validation performed 100 times using different, randomly selected, partitions of the data set. The descriptors are divided into receptor descriptors and ligand descriptors that are further subdivided into original descriptors, cross term descriptors, and absolute valued cross terms. In Figure <xref ref-type="fig" rid="F5">5</xref>, hit rates for receptor and ligand blocks in the 100 different 5-fold cross validations performed are presented, both for the original, the cross term, and the absolute valued cross term descriptors. In Figure <xref ref-type="fig" rid="F5">5 A</xref> and <xref ref-type="fig" rid="F5">5B</xref>, the results for the amine data set are presented. Figure <xref ref-type="fig" rid="F5">5 C</xref> and <xref ref-type="fig" rid="F5">5D</xref> displays the corresponding results for the alpha data set.</p><p>The second level of information displays the average and the standard deviation of the contribution of the different TM regions in the receptors for creation of receptor-ligand affinity according to the 500 different models designed. The contributions were calculated exactly as described in [<xref ref-type="bibr" rid="B2">2</xref>] for a single model, and then the average and standard deviation were calculated. Therefore, the results presented in Figure <xref ref-type="fig" rid="F5">5</xref> corresponds to Fig. 3  in [<xref ref-type="bibr" rid="B2">2</xref>] where the results for a single proteochemometric model were presented. As before, for each TM region, the contributions to the affinity by different ligands is displayed, this time the variance (uncertainty) information is added. The top of Figure <xref ref-type="fig" rid="F6">6</xref> shows the detailed contributions of TM regions to affinity, for each possible combination of ligand and receptor, according to the 500 different proteochemometric models designed using the amine data set, PLS regression and the PLSfilter VSS algorithm. The bottom part displays the corresponding results for the alpha data set when employing ridge regression and the PLSfilter VSS algorithm.</p></sec></sec><sec><title>Discussion</title><p>In summary, the results reported here confirm earlier reports on the potential of proteochemometrics modelling for prediction of biological activity. It is interesting to note that the VSS did increase the predictivity of the models for the alpha data set, but not for the amine data set. The VSS for the alpha data set did also reduce the number of variables to approximately 4% of the original variables, while for the amine data set 15&#x02013;38% of the variables remained after VSS. This indicates that for models where many variables receive low weights (as for the alpha data set) the VSS can significantly improve the model, whereas for a data set like the amine data set, with less low weighted variables, the VSS does not improve the model even though it can improve the interpret ability of the model.</p><p>The basic goal of proteochemometric modelling is to obtain a single quantitative model that can predict biological activities accurately and which can be easily interpreted biochemically. In this context, it is important to stress that the only role of the outer loop employed in this work is to obtain unbiased estimates of the average performance of the design procedure considered in the inner loop. The additional random splitting of the data sets is used on top of this to gain information about the stability in the performance estimates. Thus, for procedures in the inner loop that yield small variances around a high average of <italic>P</italic><sup>2</sup>, there is statistical support that a single design will yield useful predictions. In order for a single model to be chemically interpretable as well, all the models selected in the inner loop should yield approximately the same number (same set) of variables and the constraints on the regression coefficients (e.g., the number of latent variable in PLS regression) in all models should be approximately equal. With this in mind, the results presented in this work indicate that it is possible to design single proteochemometric models with predictive power based on the two data sets considered but that there is a relatively large variance (from one design set to another) in the variables selected and the constraints put on the regression coefficients. This indicates that although a single proteochemometric model would be useful for predictions, a detailed chemical analysis of such a model would be uncertain. More reliable information should be gained from a careful joint analysis of all the models (and their variables) selected in the inner loops of the different evaluations performed. For example, as briefly discussed in [<xref ref-type="bibr" rid="B9">9</xref>], the variables selected with the highest frequency should be of great interest. Thus, systematic and simultaneous biochemical analyses of all the models selected in the inner loops of this kind are required. For illustrative purposes of the complexity and potential of such analyses, here we have presented frequency distributions indicating which variable blocks are selected frequently in the two modelling problems considered.</p><p>Moreover, we have also presented estimates of the variability (uncertainty) in estimating the contributions to affinity, between various combinations of ligands and receptors, from different transmembrane regions. In Figure <xref ref-type="fig" rid="F5">5</xref> (top), histograms display how often different kinds of descriptors were selected in the 500 models designed for the amine data set. One conclusions is that for corrfilter, the absolute valued cross terms are selected three times as often as ordinary cross terms. Another conclusion is that for PLSfilter, fewer variables are selected and there is no obvious preference for one of the two types of cross terms. For the alpha data set it is obvious from Figure <xref ref-type="fig" rid="F5">5 C</xref> that only TM2 and TM5 are important to the model. From Figure <xref ref-type="fig" rid="F6">6 C</xref> and <xref ref-type="fig" rid="F6">6D</xref>, it is also obvious that the cross terms (and also the absolute valued cross terms) are selected less often than the ordinary descriptors.</p><p>Figure <xref ref-type="fig" rid="F6">6 A</xref> and <xref ref-type="fig" rid="F6">6B</xref> displays contributions to affinity decomposed separately for each TM region and each drug/receptor combination. One conclusion here is that there is substantial variance in the estimates of the contributions which now is revealed and should dampen the risk of over-interpretations. Another conclusion is that the different regression and variable selection methods employed give similar results. Therefore, only one result each for the amine and the alpha data sets are presented in Figure <xref ref-type="fig" rid="F6">6</xref>. A third conclusion is that a more clear and more reliable pattern of contributions can be identified in the present study than from the estimated contributions in [<xref ref-type="bibr" rid="B2">2</xref>] which were based on a single model only. For example, a pattern of consistently negative average contribution is found from TM3 and the receptors 5HT1B to 5HT1F, but this pattern does not appear in Fig. 3 of [<xref ref-type="bibr" rid="B2">2</xref>]. A fourth conclusion is that for the alpha data set, there seem to be no significant contributions to affinity from TM1, TM3, TM4, TM6 and TM7. This result agree with previous results for this data set [<xref ref-type="bibr" rid="B2">2</xref>].</p><p>Although earlier findings have been confirmed, one should note that there are a number of differences between the present and earlier studies which makes detailed comparisons difficult: 1) In earlier work different variable subset selection methods were employed and in some attempts there were no subset selection at all. 2) The normalization and use of nonlinear cross terms differ between the present and earlier studies of the alpha data set. 3) The limited forms of external predictions attempted earlier e.g., in [<xref ref-type="bibr" rid="B2">2</xref>] are not directly comparable with the present results. 4) Different software packages have been employed for model selection and performance estimation.</p></sec><sec><title>Conclusion</title><p>This work employs a methodology for unbiased statistical evaluation of proteochemometric modelling and confirms that proteochemometric modelling is a new bioinformatic methodology of great potential. The statistical evaluation performed on two of the largest proteochemometric data sets yet reported indicates that detailed chemical analyses of single proteochemometric models may be unreliable and that a systematic analysis of the set of different proteochemometric models produced in the statistical evaluation should yield more reliable information. Finally, although this work has focused on confirming the potential of proteochemometrics, the kind of systematic unbiased performance estimation employed here is of course also relevant for closely related areas of bioinformatics like microarray gene expression analysis and protein classification.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Data sets</title><p>In the amine data set, each of the 23 compounds was described by means of 236 different GRid INdependent Descriptors (GRIND) [<xref ref-type="bibr" rid="B26">26</xref>] computed for the lowest energy conformation found and organized into 6 different blocks associated with different kinds of physical interactions. In addition, each receptor was split into seven separate transmembrane regions by means of an alignment procedure and then each amino acid was described by means of five physico-chemical descriptors (z-scales). In total, 159 trans-membrane amino acids were translated into 795 physico-chemical descriptors organized into 7 different blocks (regions). In the alpha data set each of the 12 different compounds was described by means of 24 binary descriptors indicating the presence of different functional groups at three positions in the compound. Moreover, 52 amino acids in the trans-membrane regions of the receptors were identified to have varying properties between receptors and each of them were also coded into five or two physico-chemical properties each, yielding totally 96 descriptor values.</p><p>Before the proteochemometric modelling step, the amine data set was subjected to preprocessing in order to reduce the dimensionality of the original descriptors. This step should be part of the design procedure, leaving external examples outside. However, this issue is not expected to be critical and was therefore ignored in this study. For the compounds in the amine data set, after mean centering (no normalization), principal component analysis (PCA) was employed separately to each of six different blocks of GRIND descriptors, each block representing a particular kind of physical interaction. Similarly, each of the seven trans-membrane receptor block descriptors was subjected to PCA. This resulted in 6 &#x000d7; 10 = 60 compound descriptors and 7 &#x000d7; 15 = 105 receptor descriptors. Finally, 12,600 additional "cross-term" descriptors were produced by combining the compound and receptor descriptors nonlinearly. The cross-terms were added to account for non-linearities and they are shown to significantly improve the model predictivity. For each pair of compound and receptor descriptor blocks (totally 6 &#x000d7; 7 = 42 pairs), the 150 possible products between a compound and receptor descriptor value were computed. In addition, the absolute value of the deviation of each product from the average of the product over the data set available was computed. This resulted in 300 descriptor values for each of the 42 block pairs i.e., 42 &#x000d7; 300 = 12,600 values. For the alpha data set, the cross terms formed were the 2 &#x000d7; 24 &#x000d7; 96 = 4,608 possible products between the descriptors of ligands and receptors. No block-wise PCA was employed to reduce the dimensionality.</p><p>As a final step before entering the modelling phase, all descriptor values were mean centered and normalized to have unit variance.</p></sec><sec><title>Robust PLS and ridge regression</title><p>In PLS regression, first a latent variable model</p><p><bold>x </bold>= <italic>t</italic><sub>1</sub><bold>b</bold><sub>1 </sub>+ <italic>t</italic><sub>2</sub><bold>b</bold><sub>2 </sub>+ ... + <italic>t</italic><sub><italic>M</italic></sub><bold>b</bold><sub><italic>M </italic></sub>&#x000a0;&#x000a0;&#x000a0; (2)</p><p>of the vector <bold>x </bold>of descriptor values is created where <italic>t</italic><sub><italic>m </italic></sub>is latent variable and <bold>b</bold><sub><italic>m </italic></sub>is the corresponding basis (loading) vector. As few uncorrelated latent variables as possible which have the largest covariances with the response variable <italic>y</italic>, are selected. Then, a linear model <italic>y </italic>= <italic>a</italic><sub>0 </sub>+ <italic>a</italic><sub>1</sub><italic>t</italic><sub>1 </sub>+ ... + <italic>a</italic><sub><italic>M</italic></sub><italic>t</italic><sub><italic>M </italic></sub>is obtained from ordinary least squares fitting. Usually, this predictor is transformed back into the original variables yielding <italic>y </italic>= <bold>w</bold><sup><italic>T </italic></sup><bold>x </bold>as in (1). The robustness of PLS comes from the latent variable modelling which eliminates problems caused by strongly correlated variables and few examples. Ridge regression achieves its robustness by adding a penalty term (or, equivalently, a Bayesian prior) to the ordinary least squares criterion that reduces the variances in the regression coefficients. In the experiments considered below, the degree of penalty used in the RR and the number of latent variables used in the PLS regression were tuned in the inner CV loop to maximize their corresponding inner <italic>K</italic><sub>2</sub>-fold cross validation performance estimates.</p></sec><sec><title>Variable ranking algorithms</title><p>In the PLS modelling, the subsets of molecular descriptors used were selected jointly with the latent variables. Before the joint selection was performed, the molecular descriptors were ranked using two simple and fast methods: A bottom-up algorithm, which we call corrfilter, and a top-down algorithm which we call PLSfilter, corrfilter ranks the molecular descriptors according to the Pearson correlation coefficient between the descriptor and the response variable (the affinity). PLSfilter first builds a PLS model using all available descriptors and between one and <italic>L </italic>latent variables, where <italic>L </italic>is the number of latent variables associated with the model in (2) that explain 99% of the observed variance in <italic>y</italic>. Then each descriptor is ranked according to the corresponding mean of the squared coefficients, <italic>w</italic><sub><italic>i</italic></sub>, in the regression models (1) from the <italic>L </italic>different models. For the alpha data set below only PLSfilter is applicable. This is due to the discrete nature of the ligand descriptors.</p></sec><sec><title>Inner loop: joint VSS and regression parameter selection</title><p>After completing the variable ranking, the most promising combination of the number of top-ranked variables and the number of latent variables in the PLS regression modelling or the degree of penalty in the ridge regression modelling was selected as judged by a <italic>K</italic><sub>2</sub>-fold CV performance estimate. The performance estimates for different combinations of values of <italic>N</italic><sub><italic>D</italic></sub>, the number of top-ranked molecular descriptors, and values of <italic>N</italic><sub><italic>L</italic></sub>, the number of latent variables (PLS) or degree of penalty (RR), were considered. Finally, the pair (<inline-graphic xlink:href="1471-2105-6-50-i1.gif"/>, <inline-graphic xlink:href="1471-2105-6-50-i2.gif"/>) of numbers yielding the highest estimated predictive power was selected.</p><p>The predictive power of the models was measured by the commonly used dimensionless quantity <italic>Q</italic><sup>2 </sup>defined as</p><p><inline-graphic xlink:href="1471-2105-6-50-i3.gif"/></p><p>where <italic>n </italic>is the number of examples, <italic>y</italic><sub><italic>i </italic></sub>is the measured biological activity of example <italic>i</italic>, <inline-graphic xlink:href="1471-2105-6-50-i4.gif"/> is the corresponding prediction, and <inline-graphic xlink:href="1471-2105-6-50-i5.gif"/> is the arithmetic mean value of all the measured activities. Hence, <italic>Q</italic><sup>2 </sup>is a CV estimate of the fraction of the variance of the response variable explained by the model. In the case of ordinary least squares fitting, <italic>Q</italic><sup>2 </sup>is also a CV estimate of the squared Pearson correlation coefficient between the true (<italic>y</italic>) and the predicted (<inline-graphic xlink:href="1471-2105-6-50-i6.gif"/>) response values. Thus, a value of <italic>Q</italic><sup>2 </sup>close to one is traditionally interpreted as a good (valid) model.</p></sec><sec><title>Outer loop: external <italic>K</italic><sub>1</sub>-fold CV</title><p>As already mentioned, selection of a QSAR model that maximizes a <italic>K</italic><sub>2</sub>-fold CV performance estimate is common in conventional chemometrics and is also applied in proteochemometrics. This method of tuning is more complicated and therefore slower than simpler alternatives (such as tuning to maximize a single conventional hold out performance estimate) but is expected to be less sensitive to overfitting. Although parameter tuning based on CV is attractive, overfitting may still occur and the performance estimate obtained may be too optimistic. Some aspects of this danger were recently pointed out [<xref ref-type="bibr" rid="B14">14</xref>] and has also been discussed in much earlier work [<xref ref-type="bibr" rid="B15">15</xref>]. In conclusion, it is important to employ a second external CV as in Figure <xref ref-type="fig" rid="F1">1</xref> to estimate the true performance also of sophisticated design procedures that employ CV for parameter tuning.</p><p>For each step in the external <italic>K</italic><sub>1</sub>-fold CV loop, one of the <italic>K</italic><sub>1 </sub>subsets of the whole data set was kept for validation and the rest were used for design of a regression model. The predictions obtained in this outer CV loop were finally used in the formula for <italic>Q</italic><sup>2 </sup>in (3). However, since the predictions used for calculating <italic>Q</italic><sup>2 </sup>were kept outside the whole design procedure, as in earlier work [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B16">16</xref>], we denote the computed quantity by <italic>P</italic><sup>2 </sup>to indicate that this is an unbiased performance estimate based on external predictions.</p></sec><sec><title>Repeated <italic>K</italic><sub>1</sub>-fold CVs</title><p>The results obtained from a single <italic>K</italic><sub>1</sub>-fold CV are interesting but are sometimes heavily influenced by the particular data partitioning used. In the work reported here, we therefore performed repeated <italic>K</italic><sub>1</sub>-fold CV in the outer loop. For each partitioning selected randomly, the corresponding value of <italic>P</italic><sup>2 </sup>was computed using the procedures described above. Thus, a set of different values of <italic>P</italic><sup>2 </sup>were obtained and used for determination of the variability in the results obtained.</p></sec><sec><title>Computations</title><p>The main body of programming and computations were performed using MATLAB on standard processors (900 MHz). For comparisons, we also employed the program packages SIMCA (Umetrics, Sweden), GOLPE [<xref ref-type="bibr" rid="B17">17</xref>] and UNSCRAMBLER (CAMO, Norway).</p></sec></sec><sec><title>Authors' contributions</title><p>E.F. and M.G. devised and implemented the proposed double CV loop procedure, the feature selection algorithms, and a numerically efficient version of ridge regression required. P.P., M.L., J.E.S.W. provided the data sets studied together with experience and insights gained from their earlier work on proteochemometrics. V.M. and M.G. supervised the project. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>This work was supported by the Swedish Research Council (621-2001-2083, 621-2002-4711), Carl Tryggers stiftelse (Stockholm), the G&#x000f6;ran Gustafsson foundation (Stockholm), and the faculty of science and technology (Uppsala University).</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Prusis</surname><given-names>P</given-names></name><name><surname>Lundstedt</surname><given-names>T</given-names></name><name><surname>Wikberg</surname><given-names>JE</given-names></name></person-group><article-title>Proteo-chemometrics analysis of MSH peptide binding to melanocortin receptors</article-title><source>Protein Eng</source><year>2002</year><volume>15</volume><fpage>305</fpage><lpage>311</lpage><pub-id pub-id-type="pmid">11983931</pub-id><pub-id pub-id-type="doi">10.1093/protein/15.4.305</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lapinsh</surname><given-names>M</given-names></name><name><surname>Prusis</surname><given-names>P</given-names></name><name><surname>Lundstedt</surname><given-names>T</given-names></name><name><surname>Wikberg</surname><given-names>JE</given-names></name></person-group><article-title>Proteochemometrics modeling of the interaction of amine G-protein coupled receptors with a diverse set of ligands</article-title><source>Mol Pharmacol</source><year>2002</year><volume>61</volume><fpage>1465</fpage><lpage>1475</lpage><pub-id pub-id-type="pmid">12021408</pub-id><pub-id pub-id-type="doi">10.1124/mol.61.6.1465</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wikberg</surname><given-names>JE</given-names></name><name><surname>Mutulis</surname><given-names>F</given-names></name><name><surname>Mutule</surname><given-names>I</given-names></name><name><surname>Veiksina</surname><given-names>S</given-names></name><name><surname>Lapinsh</surname><given-names>M</given-names></name><name><surname>Petrovska</surname><given-names>R</given-names></name><name><surname>Prusis</surname><given-names>P</given-names></name></person-group><article-title>Melanocortin receptors: ligands and proteochemometrics modeling</article-title><source>Ann N Y Acad Sci</source><year>2003</year><volume>994</volume><fpage>21</fpage><lpage>26</lpage><pub-id pub-id-type="pmid">12851294</pub-id></citation></ref><ref id="B4"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Wikberg</surname><given-names>J</given-names></name><name><surname>Lapinsh</surname><given-names>M</given-names></name><name><surname>Prusis</surname><given-names>P</given-names></name></person-group><article-title>Proteochemometrics: A tool for modelling the molecular interaction space</article-title><source>Chemogenomics in drug discovery &#x02013; a medicinal chemistry perspective</source><year>2004</year><publisher-name>Weinheim: Wiley-VCH</publisher-name><fpage>289</fpage><lpage>309</lpage><pub-id pub-id-type="pmid">12120409</pub-id></citation></ref><ref id="B5"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Brereton</surname><given-names>RG</given-names></name></person-group><source>Chemometrics: Data Analysis for the Laboratory and Chemical Plan</source><year>2003</year><publisher-name>John Wiley &#x00026; Sons</publisher-name></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Roos</surname><given-names>H</given-names></name><name><surname>Karlsson</surname><given-names>R</given-names></name><name><surname>Nilshans</surname><given-names>H</given-names></name><name><surname>Persson</surname><given-names>A</given-names></name></person-group><article-title>Thermodynamic analysis of protein interactions with biosensor technology</article-title><source>J Mol Recognit</source><year>1998</year><volume>11</volume><fpage>204</fpage><lpage>210</lpage><pub-id pub-id-type="pmid">10076841</pub-id><pub-id pub-id-type="doi">10.1002/(SICI)1099-1352(199812)11:1/6&#x0003c;204::AID-JMR424&#x0003e;3.0.CO;2-T</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname><given-names>K</given-names></name><name><surname>Gulich</surname><given-names>S</given-names></name><name><surname>Hamalainen</surname><given-names>M</given-names></name><name><surname>Nygren</surname><given-names>PA</given-names></name><name><surname>Hober</surname><given-names>S</given-names></name><name><surname>Malmqvist</surname><given-names>M</given-names></name></person-group><article-title>Kinetic characterization of the interaction of the Z-fragment of protein A with mouse-IgG3 in a volume in chemical space</article-title><source>Proteins</source><year>1999</year><volume>37</volume><fpage>494</fpage><lpage>498</lpage><pub-id pub-id-type="pmid">10591108</pub-id><pub-id pub-id-type="doi">10.1002/(SICI)1097-0134(19991115)37:3&#x0003c;494::AID-PROT16&#x0003e;3.0.CO;2-F</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname><given-names>K</given-names></name><name><surname>Choulier</surname><given-names>L</given-names></name><name><surname>H&#x000e4;m&#x000e4;l&#x000e4;inen</surname><given-names>MD</given-names></name><name><surname>Van Regenmortel</surname><given-names>MH</given-names></name><name><surname>Altschuh</surname><given-names>D</given-names></name><name><surname>Malmqvist</surname><given-names>M</given-names></name></person-group><article-title>Predicting the kinetics of peptide-antibody interactions using a multivariate experimental design of sequence and chemical space</article-title><source>J Mol Recognit</source><year>2001</year><volume>14</volume><fpage>62</fpage><lpage>71</lpage><pub-id pub-id-type="pmid">11180562</pub-id><pub-id pub-id-type="doi">10.1002/1099-1352(200101/02)14:1&#x0003c;62::AID-JMR520&#x0003e;3.0.CO;2-T</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Freyhult</surname><given-names>EK</given-names></name><name><surname>Andersson</surname><given-names>K</given-names></name><name><surname>Gustafsson</surname><given-names>MG</given-names></name></person-group><article-title>Structural Modeling Extends QSAR Analysis of Antibody-Lysozyme Interactions to 3D-QSAR</article-title><source>Biophys J</source><year>2003</year><volume>84</volume><fpage>2264</fpage><lpage>2272</lpage><pub-id pub-id-type="pmid">12668435</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hoerl</surname><given-names>A</given-names></name><name><surname>Kennard</surname><given-names>R</given-names></name></person-group><article-title>Ridge Regression: biased estimation for non-orthogonal problems</article-title><source>Technomoetrics</source><year>1970</year><volume>12</volume><fpage>55</fpage><lpage>67</lpage></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Geladi</surname><given-names>P</given-names></name><name><surname>Kowalski</surname><given-names>B</given-names></name></person-group><article-title>Partial least-squares regression: A tutorial</article-title><source>Anal Chim Acta</source><year>1986</year><volume>185</volume><fpage>1</fpage><lpage>17</lpage><pub-id pub-id-type="doi">10.1016/0003-2670(86)80028-9</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>H&#x000f6;skuldsson</surname><given-names>A</given-names></name></person-group><article-title>PLS regression methods</article-title><source>J Chemom</source><year>1988</year><volume>2</volume><fpage>211</fpage><lpage>228</lpage></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Gustafsson</surname><given-names>MG</given-names></name></person-group><article-title>A probabilistic derivation of the partial least-squares algorithm</article-title><source>J Chem Inf Comput Sci</source><year>2001</year><volume>41</volume><fpage>288</fpage><lpage>294</lpage><pub-id pub-id-type="pmid">11277713</pub-id><pub-id pub-id-type="doi">10.1021/ci0003909</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Golbraikh</surname><given-names>A</given-names></name><name><surname>Trophsa</surname><given-names>A</given-names></name></person-group><article-title>Beware of <italic>q</italic><sup>2</sup>!</article-title><source>J Mol Graph Model</source><year>2002</year><volume>20</volume><fpage>269</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">11858635</pub-id><pub-id pub-id-type="doi">10.1016/S1093-3263(01)00123-1</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wold</surname><given-names>S</given-names></name></person-group><article-title>Validation of QSAR's</article-title><source>Quant Struct Act Relat</source><year>1991</year><volume>310</volume><fpage>191</fpage><lpage>193</lpage></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ortiz</surname><given-names>AR</given-names></name><name><surname>Pisabarro</surname><given-names>MT</given-names></name><name><surname>Gago</surname><given-names>F</given-names></name><name><surname>Wade</surname><given-names>RC</given-names></name></person-group><article-title>Prediction of drug binding affinities by comparative binding energy analysis</article-title><source>J Med Chem</source><year>1995</year><volume>38</volume><fpage>2681</fpage><lpage>2691</lpage><pub-id pub-id-type="pmid">7629807</pub-id><pub-id pub-id-type="doi">10.1021/jm00014a020</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baroni</surname><given-names>M</given-names></name><name><surname>Costantino</surname><given-names>G</given-names></name><name><surname>Cruciani</surname><given-names>G</given-names></name><name><surname>Riganelli</surname><given-names>D</given-names></name><name><surname>Valigi</surname><given-names>R</given-names></name><name><surname>Clementi</surname><given-names>S</given-names></name></person-group><article-title>Generating Optimal Linear PLS Estimations (GOLPE): An Advanced Chemometric Tool for Handling 3D-QSAR Problems</article-title><source>Quant Struct &#x02013; Act Relat</source><year>1993</year><volume>12</volume><fpage>9</fpage><lpage>20</lpage></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ortiz</surname><given-names>A</given-names></name><name><surname>Pator</surname><given-names>M</given-names></name><name><surname>Palomer</surname><given-names>A</given-names></name><name><surname>Cruciani</surname><given-names>G</given-names></name><name><surname>Gago</surname><given-names>F</given-names></name><name><surname>Wade</surname><given-names>R</given-names></name></person-group><article-title>Reliability of Comparative Molecular Field Analysis Models: Effects of Data Scaling and Variable Selection Using a Set of Human Synovial Fluid Phospholipase A2 Inhibitors</article-title><source>J Med Chem</source><year>1997</year><volume>40</volume><fpage>1136</fpage><lpage>1148</lpage><pub-id pub-id-type="pmid">9089335</pub-id><pub-id pub-id-type="doi">10.1021/jm9601617</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>S</given-names></name><name><surname>Tropsha</surname><given-names>A</given-names></name></person-group><article-title>Cross-Validated R2-Guided Region Selection for Comparative Molecular Field Analysis: A Simple Method To Achieve Consistent Results</article-title><source>J Med Chem</source><year>1995</year><volume>38</volume><fpage>1060</fpage><lpage>1066</lpage><pub-id pub-id-type="pmid">7707309</pub-id><pub-id pub-id-type="doi">10.1021/jm00007a003</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hoffman</surname><given-names>B</given-names></name><name><surname>Cho</surname><given-names>S</given-names></name><name><surname>Zheng</surname><given-names>W</given-names></name><name><surname>Wyrick</surname><given-names>S</given-names></name><name><surname>Nichols</surname><given-names>D</given-names></name><name><surname>Mailman</surname><given-names>R</given-names></name><name><surname>Tropsha</surname><given-names>A</given-names></name></person-group><article-title>Quantitative structure-activity relationship modeling of dopamine D(1) antagonists using comparative molecular field analysis, genetic algorithms-partial least-squares, and K nearest neighbor methods</article-title><source>J Med Chem</source><year>1999</year><volume>42</volume><fpage>3217</fpage><lpage>26</lpage><pub-id pub-id-type="pmid">10464009</pub-id><pub-id pub-id-type="doi">10.1021/jm980415j</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>H&#x000f6;skuldsson</surname><given-names>A</given-names></name></person-group><article-title>Variable and subset selection in PLS regression</article-title><source>Chemometrics and Intelligent Laboratory Systems</source><year>2001</year><volume>55</volume><fpage>23</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/S0169-7439(00)00113-1</pub-id></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ambroise</surname><given-names>C</given-names></name><name><surname>McLachlan</surname><given-names>GJ</given-names></name></person-group><article-title>Selection bias in gene extraction on the basis of microarray gene-expression data</article-title><source>Proc Natl Acad Sci USA</source><year>2002</year><volume>99</volume><fpage>6562</fpage><lpage>6566</lpage><pub-id pub-id-type="pmid">11983868</pub-id><pub-id pub-id-type="doi">10.1073/pnas.102102699</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lapinsh</surname><given-names>M</given-names></name><name><surname>Prusis</surname><given-names>P</given-names></name><name><surname>Gutcaits</surname><given-names>A</given-names></name><name><surname>Lundstedt</surname><given-names>T</given-names></name><name><surname>Wikberg</surname><given-names>JE</given-names></name></person-group><article-title>Development of proteo-chemometrics: a novel technology for the analysis of drug-receptor interactions</article-title><source>Biochim Biophys Acta</source><year>2001</year><volume>1525</volume><fpage>180</fpage><lpage>190</lpage><pub-id pub-id-type="pmid">11342268</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hamaguchi</surname><given-names>N</given-names></name><name><surname>True</surname><given-names>T</given-names></name><name><surname>Goetz</surname><given-names>A</given-names></name><name><surname>Stouffer</surname><given-names>M</given-names></name><name><surname>Lybrand</surname><given-names>T</given-names></name><name><surname>Jeffs</surname><given-names>P</given-names></name></person-group><article-title>Alpha 1-adreneric receptor subtype determinants for 4-piperidyl oxazole antagonists</article-title><source>Biochemistry</source><year>1998</year><volume>37</volume><fpage>5730</fpage><lpage>5737</lpage><pub-id pub-id-type="pmid">9548959</pub-id><pub-id pub-id-type="doi">10.1021/bi972733a</pub-id></citation></ref><ref id="B25"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Eriksson</surname><given-names>L</given-names></name><name><surname>Johansson</surname><given-names>E</given-names></name><name><surname>Kettaneh-Wold</surname><given-names>N</given-names></name><name><surname>Wold</surname><given-names>S</given-names></name></person-group><source>Introduction to Multi- and Magavariate Data Analysis using Projection Methods (PCA &#x00026; PLS)</source><year>1999</year><publisher-name>Umetrics, Ume&#x000e5;, Sweden</publisher-name></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pastor</surname><given-names>M</given-names></name><name><surname>Cruciani</surname><given-names>G</given-names></name><name><surname>McLay</surname><given-names>I</given-names></name><name><surname>Pickett</surname><given-names>S</given-names></name><name><surname>Clementi</surname><given-names>S</given-names></name></person-group><article-title>GRid-INdependent descriptors (GRIND): a novel class of alignment-independent three-dimensional molecular descriptors</article-title><source>J Med Chem</source><year>2000</year><volume>43</volume><fpage>3233</fpage><lpage>3243</lpage><pub-id pub-id-type="pmid">10966742</pub-id><pub-id pub-id-type="doi">10.1021/jm000941m</pub-id></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Overview of double loop. </bold>An overview of the double loop CV procedure used to obtain the desired unbiased performance estimate <italic>P</italic><sup>2</sup>. In the embedded inner CV loop, the most promising model is selected which yields the largest unbiased performance estimate, <italic>Q</italic><sup>2</sup>. In the outer CV loop, external test examples are kept outside the inner loop and are only used to test the most promising model found in the inner loop. Note that the estimate <italic>P</italic><sup>2 </sup>reflects the average performance of the modelling procedure employed in the inner loop and that the estimate is based on many different models designed in the inner loop.</p></caption><graphic xlink:href="1471-2105-6-50-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>External predictions for amine data set. </bold>External predictions for amine data set sorted according to growing values of <italic>pK</italic><sub><italic>i</italic></sub>. The figure shows the experimental <italic>pK</italic><sub><italic>i </italic></sub>values (dashed line) and the mean value of the predicted <italic>pK</italic><sub><italic>i </italic></sub>values (solid line) with a 95 % confidence interval (dotted lines). The predictions shown in the figure are from the PLS modelling after variable selection using PLSfilter. The results indicate that the high and low <italic>pK</italic><sub><italic>i </italic></sub>values are hard to predict.</p></caption><graphic xlink:href="1471-2105-6-50-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>External prediction for alpha data set. </bold>External predictions for alpha data set sorted according to growing values of <italic>pK</italic><sub><italic>i</italic></sub>. The figure shows the experimental <italic>pK</italic><sub><italic>i </italic></sub>values (dashed line) and the mean value of the predicted <italic>pK</italic><sub><italic>i </italic></sub>values (solid line) with a 95 % confidence interval (dotted lines). The predictions shown in the figure are from the PLS modelling after variable selection using PLSfilter.</p></caption><graphic xlink:href="1471-2105-6-50-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Comparison of software. </bold><italic>Q</italic><sup>2 </sup>values obtained using different software for the prediction of affinities based on PLS models, without variable selection, for the amine data set. Between one and ten latent variables were used and SIMCA (dashed line), UNSCRAMBLER (dash-dotted line), GOLPE (dotted line) and MATLAB (solid line) were used to both build the models and evaluate them by computing <italic>Q</italic><sup>2 </sup>values. The SIMCA <italic>Q</italic><sup>2 </sup>values are much higher than the other <italic>Q</italic><sup>2 </sup>values.</p></caption><graphic xlink:href="1471-2105-6-50-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Hit rates. </bold><bold>A </bold>The hit rates for the receptor blocks in the amine data set. The figure shows for each transmembrane region the hit rates for the original receptor descriptors, the cross term descriptors and the absolute valued cross term descriptors involving that transmembrane region. <bold>B </bold>The hit rates for the ligand blocks in the amine data set. The figure shows for each ligand descriptor block the hit rates for the original receptor descriptors, the cross term descriptors and the absolute valued cross term descriptors involving that ligand descriptor block. <bold>C </bold>and <bold>D </bold>The corresponding hit rates for the alpha data set. The blue bars show the hit rates computed for the PLS models using PLSfilter, the cyan bars show the hit rates computed for the PLS models using corrfilter, the red bars show the hit rates computed for the RR models using PLSfilter, and the yellow bars show the hit rates computed for the RR models using corrfilter</p></caption><graphic xlink:href="1471-2105-6-50-5"/></fig><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Detailed contributions to affinity. </bold><bold>A </bold>Contributions of TM regions in amine GPCRs to the ligand affinity according to the proteochemometrics models created using PLS in combination with the variable selection method PLSfilter. The contributions are shown for all the 21 receptors, for each receptor 23 bars corresponding to the 23 ligands are shown (in alphabetical order i.e., Amperozide, Clozapine, Fluparoxan, Fluspirilene, GGR218231, Haloperidol, L741626, MDL100,907, ORG5222, Ocaperidone, Olanzapine, Pipamperone, Raclopride, Risperidone, S16924, S18327, S33084, Seroquel, Sertindole, Tiospirone, Yohimbine, Ziprasidone, Zotepine). The blue bars show the average contribution and the height of the green bars show one standard deviation. The average value and standard deviation were computed using all the 500 models designed (100 repeats and five blocks for each repeat). <bold>B </bold>Contributions of TM regions in &#x003b1;<sub>1</sub>-adrenoreceptors to the ligand affinity according to the proteochemometrics models created using RR in combination with the variable selection method PLSfilter. The contributions are shown for all the 18 receptors, for each receptor 12 bars corresponding to the 12 ligands are shown (in numerical order 1&#x02013;12). The blue bars show the average contribution and the height of the green bars show one standard deviation. The average value and standard deviation were computed using all the 500 models (100 repeats and five blocks for each repeat).</p></caption><graphic xlink:href="1471-2105-6-50-6"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p><italic>Q</italic><sup>2 </sup>and <italic>P</italic><sup>2 </sup>values for amine data set. The mean and standard deviations for the <italic>P</italic><sup>2 </sup>and <italic>Q</italic><sup>2 </sup>values obtained with the amine data set using two different variable selection methods (corrfilter and PLSfilter) and two different regression methods (PLS and RR). The 5-fold cross validation procedure was repeated 100 times, using 100 different random partitions of the data. <italic>N</italic><sub><italic>D </italic></sub>and <italic>N</italic><sub><italic>L </italic></sub>values were selected in an inner 5-fold cross validation loop by optimizing the <italic>Q</italic><sup>2 </sup>value. For one random partition of the amine data into five cross validation groups, one <italic>P</italic><sup>2 </sup>and five <italic>Q</italic><sup>2 </sup>values were obtained. For every random partition the mean <italic>Q</italic><sup>2 </sup>is computed. The mean and standard deviations were computed based on the 100 <italic>P</italic><sup>2 </sup>values and the 100 mean <italic>Q</italic><sup>2 </sup>values.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Filter</td><td align="left">Regression</td><td align="center"><italic>P</italic><sup>2 </sup>(mean &#x000b1; std)</td><td align="center">mean <italic>Q</italic><sup>2 </sup>(mean &#x000b1; std)</td></tr></thead><tbody><tr><td align="left">no filter</td><td align="left">PLS</td><td align="center">0.52 &#x000b1; 0.021</td><td align="center">0.49 &#x000b1; 0.011</td></tr><tr><td align="left">no filter</td><td align="left">RR</td><td align="center">0.53 &#x000b1; 0.022</td><td align="center">0.49 &#x000b1; 0.012</td></tr><tr><td align="left">corrfilter</td><td align="left">PLS</td><td align="center">0.49 &#x000b1; 0.028</td><td align="center">0.76 &#x000b1; 0.0057</td></tr><tr><td align="left">corrfilter</td><td align="left">RR</td><td align="center">0.44 &#x000b1; 0.038</td><td align="center">0.76 &#x000b1; 0.0085</td></tr><tr><td align="left">PLSfilter</td><td align="left">PLS</td><td align="center">0.52 &#x000b1; 0.025</td><td align="center">0.90 &#x000b1; 0.0026</td></tr><tr><td align="left">PLSfilter</td><td align="left">RR</td><td align="center">0.51 &#x000b1; 0.027</td><td align="center">0.90 &#x000b1; 0.0056</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p><italic>N</italic><sub><italic>L </italic></sub>and <italic>N</italic><sub><italic>D </italic></sub>for amine data set. The mean and standard deviation of the number of latent variables or degree of RR penalty (<italic>N</italic><sub><italic>L</italic></sub>) and the number of molecular descriptors (<italic>N</italic><sub><italic>D</italic></sub>) used to build the models for the the amine data set. The values of <italic>N</italic><sub><italic>L </italic></sub>and <italic>N</italic><sub><italic>D </italic></sub>are tuned by optimizing the <italic>Q</italic><sup>2 </sup>value in an inner cross validation loop.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Filter</td><td align="left">Regression</td><td align="center"><italic>N</italic><sub><italic>L </italic></sub>(mean &#x000b1; std)</td><td align="center"><italic>N</italic><sub><italic>D </italic></sub>(mean &#x000b1; std)</td></tr></thead><tbody><tr><td align="left">no filter</td><td align="left">PLS</td><td align="center">6.49 &#x000b1; 1.48</td><td align="center">12765 &#x000b1; 0</td></tr><tr><td align="left">no filter</td><td align="left">RR</td><td align="center">1.13 &#x000b1; 1.45</td><td align="center">12765 &#x000b1; 0</td></tr><tr><td align="left">corrfilter</td><td align="left">PLS</td><td align="center">7.00 &#x000b1; 0.88</td><td align="center">4748 &#x000b1; 730</td></tr><tr><td align="left">corrfilter</td><td align="left">RR</td><td align="center">1.83 &#x000b1; 1.18</td><td align="center">4871 &#x000b1; 640</td></tr><tr><td align="left">PLSfilter</td><td align="left">PLS</td><td align="center">6.18 &#x000b1; 1.40</td><td align="center">1933 &#x000b1; 455</td></tr><tr><td align="left">PLSfilter</td><td align="left">RR</td><td align="center">2.10 &#x000b1; 1.17</td><td align="center">2136 &#x000b1; 349</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p><italic>Q</italic><sup>2 </sup>and <italic>P</italic><sup>2 </sup>values for alpha data. set The mean and standard deviations for the values of <italic>Q</italic><sup>2 </sup>and <italic>P</italic><sup>2 </sup>obtained for the alpha data set using the variable selection method PLSfilter and the regression methods PLS and RR.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Filter</td><td align="left">Regression</td><td align="center"><italic>P</italic><sup>2 </sup>(mean &#x000b1; std)</td><td align="center">mean <italic>Q</italic><sup>2 </sup>(mean &#x000b1; std)</td></tr></thead><tbody><tr><td align="left">no filter</td><td align="left">PLS</td><td align="center">0.55 &#x000b1; 0.045</td><td align="center">0.50 &#x000b1; 0.066</td></tr><tr><td align="left">no filter</td><td align="left">RR</td><td align="center">0.65 &#x000b1; 0.037</td><td align="center">0.59 &#x000b1; 0.027</td></tr><tr><td align="left">PLSfilter</td><td align="left">PLS</td><td align="center">0.77 &#x000b1; 0.033</td><td align="center">0.83 &#x000b1; 0.0095</td></tr><tr><td align="left">PLSfilter</td><td align="left">RR</td><td align="center">0.76 &#x000b1; 0.043</td><td align="center">0.83 &#x000b1; 0.010</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T4"><label>Table 4</label><caption><p><italic>N</italic><sub><italic>L </italic></sub>and <italic>N</italic><sub><italic>D </italic></sub>for alpha data set. The mean and standard deviation of the number of latent variables or degree of penalty (<italic>N</italic><sub><italic>L</italic></sub>) and the number of molecular descriptors (<italic>N</italic><sub><italic>D</italic></sub>) used to build the models for the the alpha data set.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Filter</td><td align="left">Regression</td><td align="center"><italic>N</italic><sub><italic>L </italic></sub>(mean &#x000b1; std)</td><td align="center"><italic>N</italic><sub><italic>D </italic></sub>(mean &#x000b1; std)</td></tr></thead><tbody><tr><td align="left">no filter</td><td align="left">PLS</td><td align="center">7.01 &#x000b1; 1.15</td><td align="center">4728 &#x000b1; 0</td></tr><tr><td align="left">no filter</td><td align="left">RR</td><td align="center">93.64 &#x000b1; 60.34</td><td align="center">4728 &#x000b1; 0</td></tr><tr><td align="left">PLSfilter</td><td align="left">PLS</td><td align="center">7.39 &#x000b1; 0.80</td><td align="center">199 &#x000b1; 69</td></tr><tr><td align="left">PLSfilter</td><td align="left">RR</td><td align="center">26 &#x000b1; 22</td><td align="center">192 &#x000b1; 85</td></tr></tbody></table></table-wrap></sec></back></article>



