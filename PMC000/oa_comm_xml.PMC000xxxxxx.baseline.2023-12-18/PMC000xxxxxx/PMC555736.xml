<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15757521</article-id><article-id pub-id-type="pmc">PMC555736</article-id><article-id pub-id-type="publisher-id">1471-2105-6-49</article-id><article-id pub-id-type="doi">10.1186/1471-2105-6-49</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>A configuration space of homologous proteins conserving mutual information and allowing a phylogeny inference based on pair-wise Z-score probabilities</article-title></title-group><contrib-group><contrib id="A1" contrib-type="author"><name><surname>Bastien</surname><given-names>Olivier</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>obastien@cea.fr</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Ortet</surname><given-names>Philippe</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>portet@cea.fr</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Roy</surname><given-names>Sylvaine</given-names></name><xref ref-type="aff" rid="I4">4</xref><email>sroy@cea.fr</email></contrib><contrib id="A4" corresp="yes" contrib-type="author"><name><surname>Mar&#x000e9;chal</surname><given-names>Eric</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>emarechal@cea.fr</email></contrib></contrib-group><aff id="I1"><label>1</label>UMR 5019 CNRS-CEA-INRA-Universit&#x000e9; Joseph Fourier, Laboratoire de Physiologie Cellulaire V&#x000e9;g&#x000e9;tale; D&#x000e9;partement R&#x000e9;ponse et Dynamique Cellulaire; CEA Grenoble, 17 rue des Martyrs, F-38054, Grenoble cedex 09, France</aff><aff id="I2"><label>2</label>Gene-IT, 147 avenue Paul Doumer, F-92500 Rueil-Malmaison, France</aff><aff id="I3"><label>3</label>D&#x000e9;partement d'Ecophysiologie V&#x000e9;g&#x000e9;tale et de Microbiologie; CEA Cadarache, F-13108 Saint Paul-lez-Durance, France</aff><aff id="I4"><label>4</label>Laboratoire de Biologie, Informatique et Math&#x000e9;matiques; D&#x000e9;partement R&#x000e9;ponse et Dynamique Cellulaire, CEA Grenoble, 17 rue des Martyrs, F-38054, Grenoble cedex 09, France</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>10</day><month>3</month><year>2005</year></pub-date><volume>6</volume><fpage>49</fpage><lpage>49</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/49"/><history><date date-type="received"><day>25</day><month>11</month><year>2004</year></date><date date-type="accepted"><day>10</day><month>3</month><year>2005</year></date></history><copyright-statement>Copyright &#x000a9; 2005 Bastien et al; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>Popular methods to reconstruct molecular phylogenies are based on multiple sequence alignments, in which addition or removal of data may change the resulting tree topology. We have sought a representation of homologous proteins that would conserve the information of pair-wise sequence alignments, respect probabilistic properties of Z-scores (Monte Carlo methods applied to pair-wise comparisons) and be the basis for a novel method of consistent and stable phylogenetic reconstruction.</p></sec><sec><title>Results</title><p>We have built up a spatial representation of protein sequences using concepts from particle physics (configuration space) and respecting a frame of constraints deduced from pair-wise alignment score properties in information theory. The obtained configuration space of homologous proteins (CSHP) allows the representation of real and shuffled sequences, and thereupon an expression of the TULIP theorem for Z-score probabilities. Based on the CSHP, we propose a phylogeny reconstruction using Z-scores. Deduced trees, called TULIP trees, are consistent with multiple-alignment based trees. Furthermore, the TULIP tree reconstruction method provides a solution for some previously reported incongruent results, such as the apicomplexan enolase phylogeny.</p></sec><sec><title>Conclusion</title><p>The CSHP is a unified model that conserves mutual information between proteins in the way physical models conserve energy. Applications include the reconstruction of evolutionary consistent and robust trees, the topology of which is based on a spatial representation that is not reordered after addition or removal of sequences. The CSHP and its assigned phylogenetic topology, provide a powerful and easily updated representation for massive pair-wise genome comparisons based on Z-score computations.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Past events that gave birth to biological entities can be tentatively reconstructed based on collections of descriptors traced in ancient or present-day creatures. Using genomic sequences, an estimate of the relative time separating branching events, previously supported by geological records, could be formalized using mathematical models. The use of proteins for evolutionary reconstructions was vastly explored as soon as the first amino acid sequences were made available [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B9">9</xref>]. The rich biological information contained in protein sequences stems from their being, on the one hand, translation of genes that reflect the history of genetic events to which the species has been subjected, and on the other hand, effectors of the functions constituting a living creature [<xref ref-type="bibr" rid="B10">10</xref>] Since protein sequences are encoded in a 20-amino acid alphabet, they are also considered to embody more <italic>information-per-site </italic>than DNA or RNA [<xref ref-type="bibr" rid="B11">11</xref>]; they also exhibit smaller compositional trends [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>]. When compared, sequences that share substantial features are considered as possible homologues [<xref ref-type="bibr" rid="B14">14</xref>], based on the fundamental postulate that can be simply stated as "the closer in the evolution, the more alike and conversely, the more alike, <italic>probably </italic>the closer in the evolution".</p><p>As summarized by Otu and Sayood [<xref ref-type="bibr" rid="B15">15</xref>], the techniques of molecular phylogenetic analyses can be divided into two groups. In the first case, a matrix representing the distance between each pair of sequences is calculated and then transformed into a tree. In the second case, a tree is found that can best explain the observed sequences under evolutionary assumptions, after evaluation of the fitness of different topologies. Some of the approaches in the first category utilize distance measures [<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B19">19</xref>] with different models of nucleotide substitution or amino acid replacement. The second category can further be divided into two groups based on the optimality criterion used in tree evaluation: parsimony [<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B21">21</xref>] and maximum likelihood methods [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>]. For a detailed comparison of these methods see [<xref ref-type="bibr" rid="B24">24</xref>].</p><p>In phylogeny inference based on distance methods, features separating related proteins are used to estimate an observed distance, also called the p-distance, the simplest measure of which is just the number of different sites between proteins. Divergence time (<italic>t</italic>), also called genetic distance or evolutionary time, is calculated from the p-distance, depending on assumptions derived from evolutionary models [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B24">24</xref>]. For example, the assumption that mutational events happen with equal probability at each site of any sequence leads to the molecular clock model [<xref ref-type="bibr" rid="B2">2</xref>]. Although widely used, it is well-known to be unrealistic and numerous corrections have been proposed to refine it [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>]. By definition, the distance matrix is given as <italic>T </italic>= (<italic>t</italic><sub><italic>ab</italic></sub>) where <italic>a </italic>and <italic>b </italic>represent the homologous sequences from the analyzed dataset. Tree reconstruction algorithms are then applied to these matrices [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B24">24</xref>]. Eventually, phylogenetic trees corresponding to the classified sequences are statistically evaluated with bootstrap methods and, when available, calibrated using dated fossils [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>].</p><p>Doolittle et al. [<xref ref-type="bibr" rid="B27">27</xref>] have proposed methods for converting amino acid alignment scores into measures of evolutionary time. Similarity between amino acids [<xref ref-type="bibr" rid="B28">28</xref>-<xref ref-type="bibr" rid="B30">30</xref>] provides a way to weight and score alignments [<xref ref-type="bibr" rid="B31">31</xref>]. In practice the optimal alignment of two sequences (<italic>a </italic>and <italic>b</italic>) is determined from the optimal score <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B27">27</xref>], computed with a dynamic programming procedure [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. In aligned sequences, conservation is measured at identical sites, whereas variation is scaled at substituted sites. To estimate the variation/conservation balance, the <italic>p-distance </italic>can be given as a function of <italic>f</italic><sub><italic>id</italic></sub>, the fraction of identical residues: <italic>p-distance </italic>= 1 - <italic>f</italic><sub><italic>id</italic></sub>. To take into account that multiple mutations can happen at the same site, an expression of <italic>f</italic><sub><italic>id </italic></sub>was proposed by Doolittle et al. [<xref ref-type="bibr" rid="B27">27</xref>] using <italic>s</italic>(<italic>a</italic>*,<italic>b</italic>*), the score obtained from randomized <italic>a </italic>and <italic>b </italic>sequences [<xref ref-type="bibr" rid="B34">34</xref>] and <italic>s</italic><sub><italic>id</italic></sub>, the average score of the sequences compared with themselves [<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B27">27</xref>]:</p><p><inline-graphic xlink:href="1471-2105-6-49-i1.gif"/></p><p>To connect pair-wise alignments and phylogeny, divergence time has been approximated:</p><p><italic>t</italic>(<italic>a</italic>,<italic>b</italic>) = -<italic>&#x003bb; </italic>log[<italic>f</italic><sub><italic>id </italic></sub>(<italic>a</italic>,<italic>b</italic>)] &#x000a0;&#x000a0;&#x000a0; (2)</p><p>introducing a Poisson correction [<xref ref-type="bibr" rid="B2">2</xref>] as a reasonable stochastic law relating amino acid changes and elapsed time. As mentioned earlier, adjustments and corrections of equation (2) were proposed to fit more realistically the complexity of evolution [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B35">35</xref>]. This attempt of unification helped reconstructing phylogeny of major lineages [<xref ref-type="bibr" rid="B27">27</xref>]. However, detailed phylogenic trees obtained from evolutionary close sequences are not satisfactory. In practice, phylogenies are reconstructed based on multiple alignments. Multiple alignment based (MAB) trees are re-calculated when incremented with additional sequences; although MAB methods are usually considered accurate, numerous cases of inconsistencies (incongruence) between observed data and deduced MAB trees are recorded (see [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B36">36</xref>]).</p><p>Here, we re-examine the estimate of the <italic>p-distance </italic>between two homologous sequences, based on <italic>f</italic><sub><italic>id</italic></sub>, as a source for geometric positioning, divergence time calculations and evolutionary reconstruction. We based our model on mathematical properties that alignment scores should respect; i) information theory [<xref ref-type="bibr" rid="B37">37</xref>,<xref ref-type="bibr" rid="B38">38</xref>] applied to sequence similarity, ii) algorithmic theory applied to alignment optimization [<xref ref-type="bibr" rid="B28">28</xref>] and iii) alignment probability, particularly in conformity with the TULIP theorem [<xref ref-type="bibr" rid="B39">39</xref>]. We used these properties as a framework of constraints to build a geometric representation of a space of probably homologous proteins and define a theoretically explicit measure of protein proximity. This unified model conserves information in the way physical models conserve matter or energy. The obtained representation of protein sequences is unaltered by adding or removing sequences. Applications include therefore the reconstruction of evolutionary consistent and robust trees, the topology of which is based on a spatial representation that is not reordered after addition or removal of sequences.</p></sec><sec><title>Results and discussion</title><sec><title>Pair-wise sequence alignment scores in information theory</title><p>Criteria to measure the variation/conservation balance between proteins should embody as much as possible the structural and functional potentiality within sequences of amino acids. In the absence of explicit physical criteria, amino acid similarity was solved empirically by measuring amino acid substitution frequencies in alignments of homologous sequences [<xref ref-type="bibr" rid="B30">30</xref>,<xref ref-type="bibr" rid="B40">40</xref>]. Given two amino acids <italic>i </italic>and <italic>j</italic>, the similarity function <italic>s</italic>(<italic>i</italic>,<italic>j</italic>) was set as:</p><p><inline-graphic xlink:href="1471-2105-6-49-i2.gif"/></p><p>where <inline-graphic xlink:href="1471-2105-6-49-i39.gif"/> is the observed frequency of substitution of <italic>i </italic>by <italic>j </italic>or <italic>j </italic>by <italic>i</italic>, and <italic>&#x003c0;</italic><sub><italic>i </italic></sub>and <italic>&#x003c0;</italic><sub><italic>j </italic></sub>are the frequencies of <italic>i </italic>and <italic>j </italic>in the two aligned sequences. The  <inline-graphic xlink:href="1471-2105-6-49-i39.gif"/> frequency is the estimate of the probability of substitution of <italic>i </italic>by <italic>j </italic>in real alignments; whereas <italic>&#x003c0;</italic><sub><italic>i</italic></sub><italic>&#x003c0;</italic><sub><italic>j </italic></sub>is the estimate of the probability of substitution under the independency hypothesis. The similarity function gives a 20 &#x000d7; 20 similarity matrix usable to score protein sequence alignments, that can be interpreted in the information theory [<xref ref-type="bibr" rid="B37">37</xref>,<xref ref-type="bibr" rid="B38">38</xref>] according to the following proposition.</p><sec><title>Proposition 1</title><p>Amino acid substitution matrix values are estimates of the mutual information between amino acids in the sense of Hartley [<xref ref-type="bibr" rid="B37">37</xref>,<xref ref-type="bibr" rid="B38">38</xref>]. Consequently, the optimal alignment score computed between two biological sequences is an estimate of the optimal mutual information between these sequences.</p></sec><sec><title>Proof</title><p>Given a probability law <italic>P </italic>that characterizes a random variable, the Hartley self-information <italic>h </italic>is defined as the amount of information one gains when an event <italic>i </italic>occurred, or equivalently the amount of uncertainty one loses after learning that <italic>i </italic>happened:</p><p><italic>h</italic>(<italic>i</italic>) = -log(<italic>P</italic>(<italic>i</italic>)) &#x000a0;&#x000a0;&#x000a0; (4)</p><p>The less likely an event <italic>i</italic>, the more we learn about the system when <italic>i </italic>happens. The mutual information <italic>I </italic>between two events, is the reduction of the uncertainty of one event <italic>i </italic>due to the knowledge of the other <italic>j</italic>:</p><p><italic>I</italic><sub><italic>j</italic>&#x02192;<italic>i </italic></sub>= <italic>h</italic>(<italic>i</italic>) - <italic>h</italic>(<italic>i</italic>/<italic>j</italic>) &#x000a0;&#x000a0;&#x000a0; (5)</p><p>Mutual information is symmetrical, <italic>i.e. I</italic><sub><italic>j</italic>&#x02192;<italic>i </italic></sub>= <italic>I</italic><sub><italic>i</italic>&#x02192;<italic>j</italic></sub>, and in the following will be expressed by <italic>I</italic>(<italic>i</italic>;<italic>j</italic>). The self and mutual information of two events <italic>i </italic>and <italic>j </italic>are related:</p><p><italic>h</italic>(<italic>i </italic>&#x02229; <italic>j</italic>) = <italic>h</italic>(<italic>i</italic>) + <italic>h</italic>(<italic>j</italic>) - <italic>I</italic>(<italic>i</italic>;<italic>j</italic>) &#x000a0;&#x000a0;&#x000a0; (6)</p><p>If the occurrence of one of the two events makes the second impossible, then the mutual information is equal to - &#x0221e;. If the two events are fully independent, mutual information is null. The empirical measure of the similarity between two amino acids described in equation (3) can therefore be expressed in probabilistic terms:</p><p><inline-graphic xlink:href="1471-2105-6-49-i3.gif"/></p><p>where <italic>P</italic><sub><italic>&#x003d6; </italic></sub>is the joint probability to have <italic>i </italic>and <italic>j </italic>aligned in a given alignment and <italic>P</italic><sub><italic>&#x003c0; </italic></sub>the measure of probability that amino acids occur in a given sequence. From equations (4) and (6), equation (7) becomes:</p><p><italic>s</italic>(<italic>i</italic>, <italic>j</italic>) = <italic>h</italic>(<italic>i</italic>) + <italic>h</italic>(<italic>j</italic>) - <italic>h</italic>(<italic>i </italic>&#x02229; <italic>j</italic>) &#x000a0;&#x000a0;&#x000a0; (8)</p><p>that is</p><p><italic>s</italic>(<italic>i</italic>, <italic>j</italic>) = <italic>I</italic>(<italic>i</italic>; <italic>j</italic>) &#x000a0;&#x000a0;&#x000a0; (9)</p><p>As a consequence, the similarity function (or score) is the mutual information between two amino acids. Additionally, the score between sequences (the sum of elementary scores between amino acids, [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B41">41</xref>,<xref ref-type="bibr" rid="B42">42</xref>]) is, according to the hypothesis of independence of amino acid positions, the estimated mutual information between the two given biological sequences.</p><p>Once two sequences are aligned, we pose the question whether the alignment score is sufficient to assess that the proteins are conceivably alike and thus evolutionarily related? The theorem of the upper limit of a sequence alignment score probability (TULIP theorem, [<xref ref-type="bibr" rid="B39">39</xref>]), sets the upper bound of an alignment score probability, under a hypothesis less restrictive than the Karlin-Altschul model [<xref ref-type="bibr" rid="B43">43</xref>]. Given two real sequences <italic>a </italic>and <italic>b </italic>(<italic>a </italic>= <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub>...<italic>a</italic><sub><italic>m </italic></sub>and <italic>b </italic>= <italic>b</italic><sub>1</sub><italic>b</italic><sub>2</sub>...<italic>b</italic><sub><italic>n</italic></sub>), where <italic>s </italic>= <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) the maximal score of a pair-wise alignment obtained with any alignment method, <italic>b</italic>* the variable corresponding to the shuffled sequences from <italic>b</italic>, and given <italic>P</italic>{<italic>S</italic>(<italic>a</italic>,<italic>b</italic>*)&#x02265;<italic>s</italic>} the probability that an alignment by chance between <italic>a </italic>and <italic>b</italic>* has a higher score than <italic>s</italic>, then whatever the distribution of the random variable <italic>S</italic>(<italic>a</italic>,<italic>b</italic>*) the TULIP theorem states:</p><p><inline-graphic xlink:href="1471-2105-6-49-i4.gif"/></p><p>with <italic>k </italic>&#x0003e; 1, <italic>&#x003bc; </italic>the mean of <inline-graphic xlink:href="1471-2105-6-49-i5.gif"/> and <italic>&#x003c3; </italic>its standard deviation. The unique restriction on <italic>S</italic>(<italic>a</italic>,<italic>b</italic>*) is that it has a finite mean and a finite variance. A first corollary of the TULIP theorem is that the Z-score is a statistical test for the probability of a sequence alignment score. We additionally state the following new corollary.</p></sec><sec><title>TULIP corollary 2</title><p>Given the TULIP theorem conditions, let <inline-graphic xlink:href="1471-2105-6-49-i6.gif"/> be the Z-score [<xref ref-type="bibr" rid="B44">44</xref>]. Then, <italic>z</italic>(<italic>a</italic>,<italic>b</italic>*) is the greatest possible value for <italic>k </italic>(<italic>k</italic>&#x02208;]1,+&#x0221e;[), which holds relation (10) true. In consequence, with <italic>k </italic>= <italic>z</italic>(<italic>a</italic>,<italic>b</italic>*), then</p><p><inline-graphic xlink:href="1471-2105-6-49-i7.gif"/></p><p>The best upper bound value for <italic>P</italic>{<italic>S</italic>(<italic>a</italic>,<italic>b</italic>*)&#x02265;<italic>s</italic>} is termed <inline-graphic xlink:href="1471-2105-6-49-i8.gif"/>. From the TULIP theorem and corollaries, the comparison of a protein to a given reference <italic>a</italic>, weighed by an alignment score, is characterized by a bounded probability that the alignment is fortuitous.</p></sec></sec><sec><title>Question of the proximity between protein sequences in the light of information theory</title><p>Since the optimized alignment score of two protein sequences allows an access to both the mutual information between proteins and an upper bound that the alignment is not fortuitous, one would expect that it is an accurate way to spatially organize proteins sets. A simple relation would be "the higher the mutual information, the nearest". There are three ways to assess the proximity between two objects <italic>a </italic>and <italic>b </italic>in a given space <italic>E </italic>[<xref ref-type="bibr" rid="B41">41</xref>]. The first is dissimilarity, a function <italic>f</italic>(<italic>a</italic>,<italic>b</italic>): <italic>E </italic>&#x000d7; <italic>E </italic>&#x02192; <inline-graphic xlink:href="1471-2105-6-49-i38.gif"/><sup>+ </sup>such that <italic>f</italic>(<italic>a</italic>,<italic>b</italic>) = 0 &#x021d4; <italic>a </italic>= <italic>b </italic>and <italic>f</italic>(<italic>a</italic>,<italic>b</italic>) = <italic>f</italic>(<italic>b</italic>,<italic>a</italic>); the second is the distance <italic>per se</italic>, that is a dissimilarity such that the triangle inequality is respected: &#x02200; <italic>a</italic>,<italic>b</italic>,<italic>c </italic>&#x02208; <italic>E</italic>, <italic>f</italic>(<italic>a</italic>,<italic>c</italic>) &#x02264; <italic>f</italic>(<italic>a</italic>,<italic>b</italic>) + <italic>f</italic>(<italic>b</italic>,<italic>c</italic>); and the third is the similarity defined as a function <italic>f</italic>(<italic>a</italic>,<italic>b</italic>): <italic>E </italic>&#x000d7; <italic>E </italic>&#x02192; <inline-graphic xlink:href="1471-2105-6-49-i38.gif"/> such that <inline-graphic xlink:href="1471-2105-6-49-i9.gif"/> and <italic>f</italic>(<italic>a</italic>,<italic>b</italic>) = <italic>f</italic>(<italic>b</italic>,<italic>a</italic>). Representing objects in a space is convenient using the notion of distance. When the optimal alignment is global, <italic>i.e. </italic>requiring that it extends from the beginning to the end of each sequence [<xref ref-type="bibr" rid="B32">32</xref>], it is theoretically possible to define a distance <italic>per se</italic>, that is to spatially organize the compared sequences [<xref ref-type="bibr" rid="B41">41</xref>]. However, from a biological point of view, global alignment algorithms are not reliable to assess homology of protein domains. Local alignments are better suited, using scoring matrices to find the optimum local alignment and maximizing the sum of the scores of aligned residues [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B31">31</xref>]. In contrast with global alignments, local alignments do not allow any trivial definition of distances [<xref ref-type="bibr" rid="B41">41</xref>].</p><p>Although amino acid similarity is a function <italic>f</italic>(<italic>i</italic>, <italic>j</italic>): <italic>E </italic>&#x000d7; <italic>E </italic>&#x02192; <inline-graphic xlink:href="1471-2105-6-49-i38.gif"/>, owing to the local alignment optimization algorithms, the computed score is a function <italic>f</italic>(<italic>a</italic>,<italic>b</italic>): <italic>E </italic>&#x000d7; <italic>E </italic>&#x02192; <inline-graphic xlink:href="1471-2105-6-49-i38.gif"/><sup>+</sup>, requiring the existence of at least one positive score in the similarity matrices. Thus, when constructing an alignment with the Smith and Waterman [<xref ref-type="bibr" rid="B33">33</xref>] method, the constraint that <italic>s</italic>(<italic>a</italic>,<italic>b</italic>)&#x0003e;0 (<italic>i.e. I(a;b) </italic>&#x0003e; 0) is imposed. This condition is consistent with proposition 1: if two sequences are homologous, knowledge about the first has to bring information about the second, that is to say, the mutual information between the two sequences cannot decrease below zero: <italic>I(a;b) </italic>&#x0003e; 0 (<italic>i.e. s(a,b) </italic>&#x0003e; 0). As a consequence, in the following geometric construction we sought a refined expression for the proximity of proteins.</p></sec><sec><title>Geometric construction of a configuration space of homologous proteins (CSHP) conserving mutual information</title><p>In a set of homologous proteins, any sequence <italic>a </italic>can be selected as a reference, noted <italic>a</italic><sub><italic>ref</italic></sub>, in respect to which the others are compared. A geometric representation of objects relatively to a fixed frame is known as a configuration space (CS). In physics, a CS is a convenient way to represent systems of particles, defined by their positional vectors in some reference frame. Here, given <italic>n </italic>similar sequences, it is therefore possible to consider <italic>n </italic>references of the CSHP. In a given (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>), each amino acid position aligned with a position in the <italic>a</italic><sub><italic>ref </italic></sub>sequence, corresponds to a comparison dimension (CS dimension). Proteins are simply positioned by a vector, the coordinates of which are given by the scores of aligned amino acids. Gaps are additional dimensions of the CS. When considering that local algorithms identify the space of biological interest, <italic>i.e. </italic>a CSHP, the gap penalty is a parameter that maximizes the shared informative dimensions. Thus, given the amino acids mutual information, alignment optimization methods define the relative positions of proteins.</p><p>At this point in our construction, a first important property of the CSHP can be deduced. Since mutual information with <italic>a</italic><sub><italic>ref </italic></sub>is sufficient for the full positioning, then positioning of proteins in a given (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) is unambiguous, unique, and is not altered when proteins are added or removed. In other words, a (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) is a univocal space.</p><p>Given two sequences <italic>a </italic>and <italic>b</italic>, if <italic>b </italic>occurs in (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>), then <italic>a </italic>also occurs in (CSHP, <italic>b</italic><sub><italic>ref</italic></sub>). The pair-wise alignment of <italic>a </italic>and <italic>b </italic>having no order (symmetry of the mutual information), the positions of <italic>b </italic>in (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) is dependent of the position of <italic>a </italic>in (CSHP, <italic>b</italic><sub><italic>ref</italic></sub>). Thus, once a (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) has been built, &#x02200;<italic>b </italic>&#x02208; (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>), part of the geometry of (CSHP, <italic>b</italic><sub><italic>ref</italic></sub>) is learnt. Thus, in a CSHP, information needed for the position of <italic>n </italic>sequences is totally contained in the geometry of the <italic>n </italic>(CSHP, <italic>a</italic><sub><italic>ref</italic></sub>). This geometric stability is not observed with multiple alignments, which can be deeply modified by addition or removal of sequences. In the CSHP, protein position is unaltered by additions or removals of other proteins. In practice, the construction of CSHP is therefore completely deduced from any all-by-all protein sequence comparison [<xref ref-type="bibr" rid="B45">45</xref>,<xref ref-type="bibr" rid="B46">46</xref>] and can be easily updated.</p></sec><sec><title>The q-dissimilarity, a proximity notion for a geometric representation of the CSHP</title><p>In the CSHP, the definition of a distance <italic>per se </italic>based on mutual information is reduced <italic>ad absurdum </italic>(For demonstration, see methods). To define a proximity function i) sharing properties of distance, <italic>i.e. </italic>increasing when objects are further apart, ii) deriving from similarity and iii) relying on mutual information, particularly the property "<italic>f</italic>(<italic>a</italic>,<italic>a</italic>) &#x02260; <italic>f</italic>(<italic>b</italic>,<italic>b</italic>) is possible", we introduce a fourth notion of proximity. Such proximity was called <italic>q-dissimilarity </italic>(for quasi-dissimilarity), a function <italic>f</italic>(<italic>a</italic>,<italic>b</italic>): <italic>E </italic>&#x000d7; <italic>E </italic>&#x02192; <inline-graphic xlink:href="1471-2105-6-49-i38.gif"/><sup>+ </sup>is defined such that</p><p><inline-graphic xlink:href="1471-2105-6-49-i10.gif"/></p><p>&#x02200; <italic>a </italic>&#x02208; <italic>E</italic>, &#x02200; <italic>b </italic>&#x02208; <italic>E</italic>, <italic>f</italic>(<italic>a</italic>,<italic>b</italic>) = <italic>f</italic>(<italic>b</italic>,<italic>a</italic>) &#x000a0;&#x000a0;&#x000a0; (13)</p><p>Let <italic>s </italic>be a similarity, then <italic>q </italic>= <italic>e</italic><sup>-<italic>s </italic></sup>is a q-dissimilarity, named the 'canonical q-dissimilarity' associated to <italic>s</italic>. Accordingly, the TULIP theorem allows a statistical characterization of <italic>q</italic>(<italic>a</italic>,<italic>b</italic>) the canonical q-dissimilarity between two sequences <italic>a </italic>and <italic>b</italic>.</p><sec><title>TULIP corollary 3</title><p>From the TULIP corollary 2, relation (14) is simply deduced:</p><p><inline-graphic xlink:href="1471-2105-6-49-i11.gif"/></p><p>with <italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*) being the random q-dissimilarity variable associated with <italic>S</italic>(<italic>a</italic>,<italic>b</italic>*). Given a (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>), each sequence <italic>b </italic>aligned with <italic>a </italic>is characterized by a q-dissimilarity <italic>q</italic>(<italic>a</italic>,<italic>b</italic>). In geometric terms, <italic>b </italic>can be represented as a point contained in a hyper-sphere <italic>B </italic>of radius <italic>q</italic>(<italic>a</italic>,<italic>b</italic>).</p><p>The representation of a (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) shown in Figure <xref ref-type="fig" rid="F1">1</xref> is therefore in conformity with all constraints listed earlier and can also serve as a Venn diagram for the setting of events realized following a continuous random variable <italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*). When <italic>a </italic>is compared to itself, it is set on a hyper-sphere <italic>A </italic>of radius <italic>q</italic>(<italic>a</italic>,<italic>a</italic>), which is not reduced to one point. In the context of information theory, it is therefore possible to express that the proximity respects the property "<italic>q</italic>(<italic>a</italic>,<italic>a</italic>) &#x02260; <italic>q</italic>(<italic>b</italic>,<italic>b</italic>) is possible". Considering Figure <xref ref-type="fig" rid="F1">1</xref>, <inline-graphic xlink:href="1471-2105-6-49-i12.gif"/> is the probability for a random sequence b* to be in the hyper-sphere <italic>B</italic>. In conclusion, the <italic>q-dissimilarity </italic>is therefore a proximity notion that allows a rigorous geometric description of the configuration space of homologous proteins, real or simulated, (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>, <italic>q</italic>).</p></sec></sec><sec><title>Unification of pair-wise alignments theory, information theory, p-distance and q-dissimilarity in the CSHP model</title><p>A geometric space is a <italic>topological </italic>space when endowed with characterized <italic>paths </italic>that link its elements. Here, paths can be defined as the underlying evolutionary history separating sequences [<xref ref-type="bibr" rid="B11">11</xref>]. Given <italic>u </italic>the common unknown ancestor, then the divergence time <italic>t</italic>(<italic>a</italic>,<italic>b</italic>) is theoretically the summed elapsed times separating <italic>u </italic>to <italic>a </italic>and to <italic>b</italic>. Without any empirical knowledge of <italic>u</italic>, the simplest approximation for <italic>t</italic>(<italic>a</italic>,<italic>b</italic>) was sought as a function of the fraction of identical residues <italic>f</italic><sub><italic>id</italic></sub>, thus of the p-distance. With the hypothesis of the molecular clock, this function can be given as equation (2), where the transmutation of <italic>a </italic>and <italic>b </italic>is a consequence of a Poisson process. By using relation (9) on the equivalence between score similarity and mutual information, then the fundamental postulate "the closer in the evolution, the more alike and conversely, the more alike, <italic>probably </italic>the closer in the evolution" can be reformulated:</p><sec><title>Fundamental postulate</title><p>Given two homologous proteins <italic>a </italic>and <italic>b</italic>, the closer in the evolution, the greater the mutual information between <italic>a </italic>and <italic>b </italic>(<italic>i.e. </italic>the optimal computed score <italic>s</italic>(<italic>a</italic>,<italic>b</italic>)) and conversely, the greater the mutual information between <italic>a </italic>and <italic>b</italic>, <italic>probably </italic>the closer in the evolution.</p><p>Whereas the first part of the postulate is a consequence of the conservational pressure on mutual information, the second assertion founds the historical reconstruction underlying a set of biological sequences on statistical concepts. A corollary is that evolution of two homologous proteins is characterized by a loss of mutual information.</p><p>In the CSHP, this formulation of the fundamental postulate allows a novel mathematical formalization of the p-distance in probabilistic terms. Basically, the p-distance is the divergence observed between two sequences <italic>knowing </italic>that they share some features (the observed sequences <italic>a </italic>and <italic>b</italic>) and that they were identical before the speciation event (sequence <italic>u</italic>).</p><p>Looking back to equation (1), we can re-formulate <italic>f</italic><sub><italic>id </italic></sub>in probabilistic terms, considering the fraction of shared features (identical sites) <italic>knowing </italic>the observed data and the existence of a common ancestor. Given two proteins <italic>a </italic>and <italic>b</italic>, let us consider the random variable <italic>Q</italic>(a,b*), defined in TULIP corollary 3. In (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>), shown in Figure <xref ref-type="fig" rid="F1">1</xref>, one can define the probability law <italic>P</italic>{<italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*)&#x02264;<italic>&#x003c1;</italic>} as the probability that the q-dissimilarity between <italic>b</italic>* and <italic>a</italic><sub><italic>ref </italic></sub>is lower than <italic>&#x003c1;</italic>. The hyper-sphere of radius <italic>&#x003c1; </italic>contains therefore the <italic>b</italic>* random sequences sharing informative features with <italic>a </italic>accordingly. The probability <italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>that <italic>b</italic>* shares identity with <italic>a</italic>, <italic>knowing </italic>that the q-dissimilarity between <italic>b</italic>* and <italic>a </italic>is lower than that between the real sequences <italic>b </italic>and <italic>a</italic>, is:</p><p><italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>(<italic>b</italic>*) = <italic>P</italic>{<italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*) &#x02264; <italic>q</italic>(<italic>a</italic>,<italic>a</italic>) / <italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*) &#x02264; <italic>q</italic>(<italic>a</italic>,<italic>b</italic>)} &#x000a0;&#x000a0;&#x000a0; (15)</p><p>which is a probabilistic expression of <italic>f</italic><sub><italic>id </italic></sub>in respect to the reference <italic>a</italic><sub><italic>ref</italic></sub>. According to the Venn diagram in Figure <xref ref-type="fig" rid="F1">1</xref>: <italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>(<italic>b</italic>*) = <italic>P</italic>(<italic>A</italic>/<italic>B</italic>)</p><p>Using the Bayes theorem, equation (15) can be expressed as:</p><p><inline-graphic xlink:href="1471-2105-6-49-i13.gif"/></p><p>In consequence:</p><p><inline-graphic xlink:href="1471-2105-6-49-i14.gif"/></p><p>which can be expressed as</p><p><inline-graphic xlink:href="1471-2105-6-49-i15.gif"/></p><p>Assuming that substitution rates are independent of lineages [<xref ref-type="bibr" rid="B35">35</xref>], then random sequence models a* and b* are equivalent, that is to say <italic>Q</italic>(<italic>a</italic>,<italic>a</italic>*) &#x02248; <italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*) and</p><p><inline-graphic xlink:href="1471-2105-6-49-i16.gif"/></p><p>Thus <italic>p</italic><sub><italic>id</italic>/<italic>a</italic></sub>, and symmetrically <italic>p</italic><sub><italic>id</italic>/<italic>b</italic></sub>, provide a probabilistic expression of <italic>f</italic><sub><italic>id </italic></sub><italic>knowing </italic>the data, <italic>i.e. </italic>the observed mutual information between <italic>a </italic>and <italic>b </italic>expressed as <italic>Q</italic>(<italic>a</italic>,<italic>b</italic>).</p><p>Given two homologous sequences <italic>a </italic>and <italic>b</italic>, when their optimal score is <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) &#x02265; <italic>&#x003bc; </italic>+ <italic>&#x003c8; </italic>with <italic>&#x003c8; </italic>being a critical threshold value depending on the score distribution law (See Methods for the demonstration for the critical threshold), owing to the TULIP corollary 2, we can state that <italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>is bounded above:</p><p><inline-graphic xlink:href="1471-2105-6-49-i17.gif"/></p><p>This expression can also be developed as:</p><p><inline-graphic xlink:href="1471-2105-6-49-i18.gif"/></p><p>where <italic>&#x003bc;</italic><sub>1</sub>, <italic>&#x003c3;</italic><sub>1</sub>, <italic>&#x003bc;</italic><sub>2 </sub>and <italic>&#x003c3;</italic><sub>2 </sub>are the mean and the standard deviation of <italic>S</italic>(<italic>a</italic>,<italic>b</italic>*) and <italic>S</italic>(<italic>a</italic>,<italic>a</italic>*) respectively. The right term in relation (21) exhibits analogies with <italic>f</italic><sub><italic>id </italic></sub>given by equation (1), showing that the pragmatic approach by Feng and Doolittle [<xref ref-type="bibr" rid="B19">19</xref>] could be supported and generalized in a theoretical elaboration.</p><p>Using the Poisson correction, an expression of <italic>t</italic>(<italic>a</italic>,<italic>b</italic>) is given as the linear combination of the two corrections of the p-distance deduced from <italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>and <italic>p</italic><sub><italic>id</italic>/<italic>b </italic></sub>:</p><p><italic>t</italic>(<italic>a</italic>,<italic>b</italic>) = -[log(<italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>(<italic>b</italic>*)) +log(<italic>p</italic><sub><italic>id</italic>/<italic>b </italic></sub>(<italic>a</italic>*))] &#x000a0;&#x000a0;&#x000a0; (22)</p><p>with <italic>a</italic>* and <italic>b</italic>* the random variables corresponding to the shuffled sequences of <italic>a </italic>and <italic>b </italic>respectively. The sum of the logarithms corresponds to the product of the two probabilities, an expression of the hypothesis of independence of lineage. Interestingly, equation (22) provides an expression of the symmetric effect of time on the variations that independently affected <italic>a </italic>and <italic>b</italic>.</p><p>From relation (20), <italic>t</italic>(<italic>a</italic>,<italic>b</italic>) appears as a function of Z-score ratios. For any set of homologous proteins, it is therefore possible to measure a table of pair-wise divergence times and build phylogenetic trees using distance methods.</p></sec></sec><sec><title>Reconstruction of protein phylogeny: first example, case study of the glucose-6-phosphate isomerase phylogeny</title><p>We compared the trees we obtained, called TULIP trees, to phylogenetic trees built using classical methods, for instance the popular PHYLIP [<xref ref-type="bibr" rid="B47">47</xref>] or PUZZLE-based [<xref ref-type="bibr" rid="B48">48</xref>] methods, termed here MAB trees (for multiple alignment-based trees). Firstly, because MAB trees are constructed from multiple alignments, removals or additions of proteins modify the multiple alignments. Inclusion of sequences is considered as a way to improve the quality of multiple alignments and to increase the sensitivity of the comparison of distant sequences [<xref ref-type="bibr" rid="B49">49</xref>,<xref ref-type="bibr" rid="B50">50</xref>]. By contrast, the protein space used to build TULIP trees is not reordered when data sets are incremented or decremented (drawing of the TULIP tree may apparently change due to the tree graphic representation methods; nevertheless the absolute tree topology is not reordered). This remarkable property is due to both the geometrical construction by pair-wise comparison and the convergence of the distance matrix elements estimated by equation (21). Indeed, the estimate of the right-hand term of equation (21) relies on a Monte Carlo method, after randomization of the biological sequences [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B44">44</xref>,<xref ref-type="bibr" rid="B51">51</xref>] and is therefore dependent on the sequence randomization model [<xref ref-type="bibr" rid="B52">52</xref>] and convergent in respect to the weak law of large numbers [<xref ref-type="bibr" rid="B53">53</xref>]. Convergence is proportional to <inline-graphic xlink:href="1471-2105-6-49-i19.gif"/>, where <italic>numb</italic><sub><italic>rand </italic></sub>is the number of randomizations. In the case studies presented here, we set <italic>num</italic><sub><italic>rand </italic></sub>= 2000 (see Methods). By contrast, stability of MAB trees is sought by bootstrapping approaches and consensus tree reconstruction. MAB trees appear as the result of a complex learning process including possible re-adjustment of the multiple alignments after eye inspection pragmatically applied to assist the reconstruction. Alternatively, Bayesian analyses have been recently proposed for phylogenetic inference [<xref ref-type="bibr" rid="B54">54</xref>], estimating posterior probability of each clades to assess most likely trees. Still, in a recent comparative study, Suzuki et al. [<xref ref-type="bibr" rid="B55">55</xref>] and Simmons et al. [<xref ref-type="bibr" rid="B56">56</xref>] provided evidence supporting the use of relatively conservative bootstrap and jacknife approaches rather than the more extreme overestimates provided by the Markov Chain Monte Carlo-based Bayesian methods. In the absence of any decisive methods to assess the validity of the trees obtained after such different approaches, no absolute comparison with the TULIP classification trees can be rigorously provided.</p><p>Whenever a TULIP classification was achieved on a dataset that led to a consensual MAB tree, both were always consistent. For example, Figure <xref ref-type="fig" rid="F2">2</xref> shows the phylogenetic PHYLIP [<xref ref-type="bibr" rid="B47">47</xref>] and TULIP trees obtained for glucose-6-phosphate isomerases (G6PI). Phylogeny of the G6PI enzyme has been studied by Huang et al. [<xref ref-type="bibr" rid="B57">57</xref>] in order to demonstrate the horizontal transfer of this enzyme in the apicomplexan phylum due to a past endosymbiosis [<xref ref-type="bibr" rid="B57">57</xref>]. Owing to the neighbor-joining analysis used by Huang et al. [<xref ref-type="bibr" rid="B57">57</xref>] (see methods) Figure <xref ref-type="fig" rid="F2">2A</xref> shows that apicomplexan G6PI is "plant-like". The TULIP tree shown in Figure <xref ref-type="fig" rid="F2">2B</xref> is consistent with this conclusion. Interestingly, differences between the two trees are found only when the bootstrap values on the MAB tree are not strong enough to unambiguously assess branching topology.</p></sec><sec><title>Reconstruction of protein phylogeny: second example, case study of the enolase phylogenic incongruence</title><p>TULIP classification tree further helps in solving apparent conflicting results obtained with MAB methods. In a comprehensive study from Keeling and Palmer [<xref ref-type="bibr" rid="B36">36</xref>] the PUZZLE-based reconstruction of the enolase phylogeny led to incongruent conclusions. Enolase proteins from a wide spectrum of organisms were examined to understand the evolutionary scenario that might explain that enolases from land plants and alveolates shared two short insertions. Alveolates comprise apicomplexan parasites, known to contain typical plant features as mentioned above, particularly a plastid relic. In this context, the shared insertion in apicomplexan and plant enolases (Figure <xref ref-type="fig" rid="F3">3</xref>) has been interpreted as a possible signature for some evolutionary relationship between apicomplexans and plants [<xref ref-type="bibr" rid="B58">58</xref>,<xref ref-type="bibr" rid="B59">59</xref>] and a likely sign of a lateral transfer. From the distribution of this insertion in enolases from several key eukaryotic groups, Keeling and Palmer [<xref ref-type="bibr" rid="B36">36</xref>] postulated that lateral transfer had been an important force in the evolution of eukaryotic enolases, being responsible for their origin in cryptomonads, <italic>Chlorarachnion </italic>and <italic>Arabidopsis</italic>. However, they could not conclude about alveolates, finding a conflict between the distribution of the insertion and the MAB phylogenetic position (Figure <xref ref-type="fig" rid="F4">4A</xref>). The authors had to admit that lateral gene transfers failed to explain apicomplexa enolases, and were compelled to suppose that the lack of congruence between insertion and phylogeny could be because of a parallel loss of insertions in lineages, or to more complex transfers of gene portions.</p><p>Based on our theoretical model, we constructed the corresponding TULIP tree. TULIP trees given with BLOSUM 62 or PAM 250 matrices, Fitch-Margoliash or neighbor-joining methods led indistinctly to a unique tree topology (Figure <xref ref-type="fig" rid="F4">4B</xref>). Separation of great phyla (Archaebacteria, Eubacteria, Diplomonads, Trypanasomes, Animals, Fungi and Amoeba) is recovered. A plant-like cluster is additionally reconstructed, in which a distinct separation occurred between {Rhodophytes ; Cryptomonads} and {Land Plants ; Charophytes ; Chlorarachnion ; Alveolates} main clusters. It is remarkable that this latter cluster is that characterized by the enolase insertion.</p><p>This topology corresponds to the observed distribution of the enolase short insertions and provides therefore a solution to the apparent enolase phylogeny incongruence: the phylogenetic position of alveolates is not in conflict with the distribution of enolase insertion and the apicomplexa enolase is possibly a consequence of a lateral transfer, like in cryptomonads.</p></sec><sec><title>Large scale phylogeny based on a CSHP built from massive genomic pair-wise comparisons</title><p>A CSHP containing large sets of protein sequences can be built after any all-by-all massive comparison providing Z-score statistics. Because the space elaboration is explicit, then quality of the mutual information conservation depends on the choice of the scoring matrix, the geometric positioning depends on the local alignment method, the homology assessment depends on the alignment score and probabilistic cutoffs and the phylogenetic topology on the choice of the stochastic law correction. Eventually, genome-scale pair-wise comparisons [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B36">36</xref>] find in the present CSHP a robust, evolutionary consistent and easily updatable representation.</p></sec></sec><sec sec-type="methods"><title>Methods</title><sec><title>Glucose-6-Phosphate Isomerase sequences</title><p>The 41 Glucose-6-phosphate isomerase (EC 5.3.1.9) sequences studied in the paper are taken from several representative groups, as provided from the Swiss-prot database. Group I: Archae ([Swiss-prot:G6PI_HALN1], <italic>Halobacterium </italic>sp.; [Swiss-prot:G6PI_METJA], <italic>Methanococcus jannaschii</italic>). Group II: Bacteria Actinobacteria ([Swiss-prot:G6P1_STRCO], <italic>Streptomyces coelicolor</italic>; [Swiss-prot:G6PI_COREF, <italic>Corynebacterium efficiens</italic>; [Swiss-prot:G6PI_MYCTU], <italic>Mycobacterium tuberculosis</italic>). Group III: Bacteria Cyanobacteria ([Swiss-prot:G6PI_ANASP], <italic>Anabaena sp.</italic>; [Swiss-prot:G6PI_SYNEL], <italic>Synechococcus elongates</italic>). Group III: Bacteria Bacillus ([Swiss-prot:G6PI_LACFE], <italic>Lactobacillus fermentum</italic>; [Swiss-prot:G6PI_BACHD], <italic>Bacillus halodurans</italic>; [Swiss-prot:G6PI_BACSU], <italic>Bacillus subtilis</italic>; [Swiss-prot:G6PI_CLOPE], <italic>Clostridium perfringens</italic>). Group IV: Bacteria Proteobacteria ([Swiss-prot:G6PI_BIFLO], <italic>Bifidobacterium longum</italic>; [Swiss-prot:G6PI_ECOLI], <italic>Escherichia coli</italic>). Group V: Bacteria Chlamydiae ([Swiss-prot:G6PI_CHLTR], <italic>Chlamydia trachomatis</italic>; [Swiss-prot:G6PI_CHLCV], <italic>Chlamydophila caviae</italic>; [Swiss-prot:G6PI_CHLMU], <italic>Chlamydia muridarum</italic>). Group VI: Others Bacteria ([Swiss-prot:G6PI_CHLTE], <italic>Chlorobium tepidum</italic>; [Swiss-prot:G6PI_DEIRA], <italic>Deinococcus radiodurans</italic>; [Swiss-prot:G6PI_BORBU], <italic>Borrelia burgdorferi</italic>; [Swiss-prot:G6PI_THEMA], <italic>Thermotoga maritime</italic>). Group VII: Fungi ([Swiss-prot:G6PI_SCHPO], <italic>Schizosaccharomyces pombe</italic>; [Swiss-prot:G6PI_YEAST], <italic>Saccharomyces cerevisiae</italic>; [Swiss-prot:G6PI_NEUCR], <italic>Neurospora crassa</italic>; [Swiss-prot:G6PI_ASPOR], <italic>Aspergillus oryzae</italic>). Group VII: Eukaryota Viridiplantae ([Swiss-prot:G6PI_ARATH], <italic>Arabidopsis thaliana</italic>; [Swiss-prot:G6PI_MAIZE], <italic>Zea mays</italic>; [Swiss-prot:G6PI_SPIOL, <italic>Spinacia oleracea</italic>; [Swiss-prot:G6PA_ORYSA], <italic>Oryza sativa</italic>). Group VIII: Eukaryota Alveolata Apicomplexa ([Swiss-prot:G6PI_PLAFA], <italic>Plasmodium falciparum</italic>; [Swiss-prot:Q9XY88], <italic>Toxoplasma Gondii</italic>; [Swiss-prot:269_185], <italic>Cryptosporidium parvum</italic>). Group IX: Animals ([Swiss-prot:G6PI_DROME, <italic>Drosophila melanogaster</italic>; [Swiss-prot:G6PI_MOUSE], <italic>Mus musculus</italic>; [Swiss-prot:G6PI_HUMAN], <italic>Homo sapiens</italic>; [Swiss-prot:G6PI_PIG], <italic>Sus scrofa</italic>; [Swiss-prot:G6PI_RABIT], <italic>Oryctolagus cuniculus</italic>; [Swiss-prot:G6PI_TRYBB], <italic>Trypanosoma brucei brucei</italic>). Group X: Other Eukaryota ([Swiss-prot:AY581147], <italic>Entamoeba histolytica</italic>; [Swiss-prot:G6PI_LEIME], <italic>Leishmania mexicana</italic>; [Swiss-prot:AY581146], <italic>Dictyostelium discoideum</italic>; [Swiss-prot:Q968V7], <italic>Giardia intestinalis</italic>).</p></sec><sec><title>Enolase sequences</title><p>Enolase sequences used for the case-study presented in this paper were taken from eight major groups previously studied by [<xref ref-type="bibr" rid="B36">36</xref>]. Group I: Land Plant, Charophytes, Chlorophytes, Rhodophytes and Cryptomonads ([Swiss-prot:CAA39454], <italic>Zea mays</italic>; [Swiss-prot:Q42971], <italic>Oryza sativa</italic>; [Swiss-prot:Q43130], <italic>Mesembryanthemum crystallinum</italic>; [Swiss-prot:P42896], <italic>Ricinus communis</italic>; [Swiss-prot:Q43321], <italic>Alnus glutinosa</italic>; [Swiss-prot:Q9LEJ0], <italic>Hevea brasiliensis </italic>1; [Swiss-prot:P25696], <italic>Arabidopsis thaliana</italic>; [Swiss-prot:P26300], <italic>Lycopersicon esculentum</italic>; [Swiss-prot:AF348914], <italic>Chara corallina</italic>; [Swiss-prot:AF348915], <italic>Nitella opaca</italic>; [Swiss-prot:AF348916], <italic>Nitellopsis obtusa</italic>; [Swiss-prot:AF348918], <italic>Pycnococcus provasolii </italic>2; [Swiss-prot:AF348919], <italic>Bigelowiella natans </italic>&#x02013; Chlorarachnion -; [Swiss-prot:AF348920], <italic>Mastocarpus papillatus </italic>1; [Swiss-prot:AF348923], <italic>Prionitis lanceolata </italic>1; [Swiss-prot:AF348931], <italic>Rhodomonas salina </italic>1; [Swiss-prot:AF348933], <italic>Guillardia theta</italic>; [Swiss-prot:AF348935], <italic>Pedinomonas minor</italic>). Group II : Animals and Fungi ([Swiss-prot:P04764], <italic>Rattus norvegicus</italic>; [Swiss-prot:P51913], <italic>Gallus gallus </italic>A; [Swiss-prot:P07322], <italic>Gallus gallus </italic>B; [Swiss-prot:Q9PVK2], <italic>Alligator mississippiensis</italic>; [Swiss-prot:P06733], <italic>Homo sapiens </italic>A; [Swiss-prot:P13929, <italic>Homo sapiens </italic>B; [Swiss-prot:P15007], <italic>Drosophila melanogaster</italic>; [Swiss-prot:AF025805], <italic>Drosophila pseudoobscura</italic>; [Swiss-prot:O02654], <italic>Loligo pealeii</italic>; [Swiss-prot:AF100985], <italic>Penaeus monodon</italic>; [Swiss-prot:Q27527], <italic>Caenorhabditis elegans</italic>; [Swiss-prot:Q27877], <italic>Schistosoma mansoni</italic>; [Swiss-prot:P33676], <italic>Schistosoma japonicum</italic>; [Swiss-prot:Q27655], <italic>Fasciola hepatica</italic>; [Swiss-prot:P00924], <italic>Saccharomyces cerevisiae </italic>1; [Swiss-prot:Q12560], <italic>Aspergillus oryzae</italic>; [Swiss-prot:P42040], <italic>Cladosporium herbarum</italic>; [Swiss-prot:P40370], <italic>Schizosaccharomyces pombe </italic>1; [Swiss-prot:AF063247], <italic>Pneumocystis carinii </italic>f.). Group III: Amoebae ([Swiss-prot:P51555], <italic>Entamoeba histolytica</italic>; [Swiss-prot:Q9U615], <italic>Mastigamoeba balamuthi</italic>). Group IV: Alveolates ([Swiss-prot:AF348926], <italic>Paramecium multimicronucleatum</italic>; [Swiss-prot:AF348927], <italic>Paramecium tetraurelia</italic>; [Swiss-prot:AF348928], <italic>Colpidium aqueous</italic>; [Swiss-prot:AF348929], <italic>Tetrahymena thermophila </italic>I; [Swiss-prot:AF348930], <italic>Tetrahymena bergeri</italic>; [Swiss-prot:Q27727], <italic>Plasmodium falciparum</italic>; [Swiss-prot:AF051910], <italic>Toxoplasma gondii</italic>). Group V: <italic>Trypanosomatidae </italic>([Swiss-prot:AF159530], <italic>Trypanosoma cruzi </italic>eno1 partial; [Swiss-prot:AF152348], <italic>Trypanosoma brucei </italic>complete). Group VI: Hexamitidae ([Swiss-prot:AF159519], <italic>Hexamita inflata </italic>eno1 partial; [Swiss-prot:AF159517], <italic>Spironucleus vortens </italic>partial). Group VII: Archaebacteria ([Swiss-prot:Q9UXZ0], <italic>Pyrococcus abyssi</italic>; [Swiss-prot:O59605], <italic>Pyrococcus horikoshi</italic>i; [Swiss-prot:Q60173], <italic>Methanococcus jannaschii</italic>; [Swiss-prot:Q9Y927], <italic>Aeropyrum pernix</italic>). Group VII: Eubacteria ([Swiss-prot:O66778], <italic>Aquifex aeolicus</italic>; [Swiss-prot:P37869],<italic>Bacillus subtilis</italic>; [Swiss-prot:Q9K717], <italic>Bacillus halodurans</italic>; [Swiss-prot:P77972], <italic>Synechocystis </italic>sp.; [Swiss-prot:P33675], <italic>Zymomonas mobilis</italic>; [Swiss-prot:P08324], <italic>Escherichia coli</italic>; [Swiss-prot:P47647], <italic>Mycoplasma genitalium</italic>; [Swiss-prot:Q8EW32, <italic>Mycoplasma penetrans</italic>; [Swiss-prot:P74934], Treponema pallidum).</p></sec><sec><title>Demonstration that distance of a protein to itself cannot be defined in the CSHP</title><p>In the simplest case, building a distance between amino acids (that would lead to distance between sequences) on the basis of computed similarity values would have to respect the condition:</p><p>&#x02200;<italic>i </italic>&#x02208; <italic>E</italic>, &#x02200;<italic>j </italic>&#x02208; <italic>E</italic>,<italic>d</italic>(<italic>i</italic>,<italic>j</italic>) = 0 &#x021d2; <italic>i </italic>= <italic>j </italic>&#x000a0;&#x000a0;&#x000a0; (a)</p><p>for <italic>i </italic>and <italic>j</italic>, two given amino acids and <italic>d </italic>the distance function. Using this condition in the proposition, any organization of the CSHP with a geometric distance is reduced <italic>ad absurdum</italic>.</p><sec><title>Proposition</title><p>Building a distance between amino acids derived from the composed function <italic>d</italic>(<italic>i</italic>,<italic>j</italic>) = (<italic>&#x003c6; </italic>&#x025cb; <italic>s</italic>)(<italic>i</italic>,<italic>j</italic>), where <italic>s </italic>is a similarity function and <italic>&#x003c6; </italic>a bijection, is impossible without a loss of mutual information. Moreover, two proteins from distinct organisms can have the same configuration, being like "twins", and <italic>d</italic>(<italic>i</italic>,<italic>j</italic>) = 0 does not imply <italic>i </italic>= <italic>j</italic>.</p></sec><sec><title>Proof</title><p>Condition (a) implies that <italic>&#x003c6; </italic>(<italic>s</italic>(<italic>i</italic>,<italic>i</italic>)) = <italic>&#x003c6; </italic>(<italic>s</italic>(<italic>j</italic>,<italic>j</italic>)) = 0. This equality imposes that <italic>s</italic>(<italic>i</italic>,<italic>i</italic>) = <italic>s </italic>(<italic>j</italic>,<italic>j</italic>) and, following equation (7) of main text, that <italic>I</italic>(<italic>i</italic>;<italic>i</italic>) = <italic>I</italic>(<italic>j</italic>;<italic>j</italic>). Considering for example tryptophan (W) and glutamic acid (E), if W occurs in a sequence, the mutual information gained about the occurrence of W at the aligned position would be the same as that gained in the case of E about the occurrence of E at the aligned position in the homologous protein. This statement is easily rejected on the basis of biochemical concerns. On one hand, aspartic acid (D) shares common biochemical properties with E, particularly a carboxylic acid, and easily substitutes in homologous sequences. By contrast W, exhibiting a unique biochemical feature, is less substitutable without altering the function. Thus the mutual information <italic>I(E;E) </italic>is necessarily lower than <italic>I</italic>(<italic>W</italic>;<italic>W</italic>). This that can be checked in scoring matrices such as BLOSUM 62 [<xref ref-type="bibr" rid="B30">30</xref>] where <italic>I(E;E) </italic>= 5, <italic>I(D;D) </italic>= 6 and <italic>I(W;W) </italic>= 11. Condition <italic>d</italic>(<italic>i</italic>,<italic>i</italic>) = 0 leads to an obvious loss of information. The second assertion of the proposition is obvious.</p></sec></sec><sec><title>Determination of the threshold value <italic>&#x003c8;</italic>, for topological reconstructions in the CHSP based on pair-wise alignment score probabilities</title><p>An important basis of the reconstruction of a probabilistic evolutionary topology in the CSHP is based on the demonstration that, given <italic>S </italic>the random variable corresponding to the alignment scores of pairs of shuffled sequences and <italic>&#x003bc; </italic>the mean of <italic>S</italic>, given two homologous sequences <italic>a </italic>and <italic>b</italic>, when their optimal score is <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) &#x02265; <italic>&#x003bc; </italic>+ <italic>&#x003c8; </italic>(with <italic>&#x003c8; </italic>a critical threshold value depending on the score distribution law), owing to the TULIP corollary 2, we can state that <italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>is bounded above</p><p><inline-graphic xlink:href="1471-2105-6-49-i20.gif"/></p><p>To the purpose of this demonstration, we considered the cumulative distribution function <italic>F</italic>(<italic>s</italic>) = <italic>P</italic>(<italic>S </italic>&#x02264; <italic>s</italic>), its derivative <italic>f</italic>(<italic>s</italic>) known as the probability density function defined as <italic>dF</italic>(<italic>s</italic>) = <italic>f</italic>(<italic>s</italic>)<italic>ds</italic>, and the positive delta function <italic>&#x003b4; </italic>(<italic>s</italic>) = (<italic>s </italic>- <italic>&#x003bc;</italic>)<sup>2</sup>(1 - <italic>F</italic>(<italic>s</italic>)). Since <italic>&#x003b4; </italic>(<italic>s</italic>) = (<italic>s </italic>- <italic>&#x003bc;</italic>)<sup>2</sup>(1 - <italic>F</italic>(<italic>s</italic>)) is null for <italic>s </italic>= <italic>&#x003bc; </italic>and <inline-graphic xlink:href="1471-2105-6-49-i21.gif"/>, the Rolle's theorem implies that &#x02203;<italic>s</italic><sub>0 </sub>&#x02208;]<italic>&#x003bc;</italic>,+&#x0221e;[ such as <inline-graphic xlink:href="1471-2105-6-49-i22.gif"/>[<xref ref-type="bibr" rid="B60">60</xref>]; <italic>s</italic><sub>0 </sub>corresponds to a maximum of <italic>&#x003b4; </italic>(<italic>s</italic>) and is therefore the solution of the equation</p><p>2(1 - <italic>F</italic>(<italic>s</italic>)) - (<italic>s </italic>- <italic>&#x003bc;</italic>) <italic>f</italic>(<italic>s</italic>) = 0 &#x000a0;&#x000a0;&#x000a0; (b)</p><p>one can express as</p><p><inline-graphic xlink:href="1471-2105-6-49-i23.gif"/></p><p>The <inline-graphic xlink:href="1471-2105-6-49-i24.gif"/> term corresponds to a continuous function. Interestingly, <inline-graphic xlink:href="1471-2105-6-49-i25.gif"/> is known as the hazard function [<xref ref-type="bibr" rid="B61">61</xref>], that is the probability of <italic>s</italic>, per score unit (<italic>i.e. </italic>mutual information), conditional to the fact that the pair-wise alignment score is <italic>at least </italic>equal to <italic>s</italic>. The hazard function is also defined by <inline-graphic xlink:href="1471-2105-6-49-i26.gif"/>. A critical hypothesis is that <italic>&#x003c6; </italic>(<italic>x</italic>) function is strictly increasing and conversely that <inline-graphic xlink:href="1471-2105-6-49-i27.gif"/> is strictly decreasing. Considering <inline-graphic xlink:href="1471-2105-6-49-i28.gif"/>, equation 2 has only one solution <italic>s</italic><sub>0 </sub>and this solution is bounded above:</p><p><inline-graphic xlink:href="1471-2105-6-49-i29.gif"/></p><p>In consequence, <italic>&#x003b4; </italic>(<italic>s</italic>) reaches its maximum for a <italic>s</italic><sub>0 </sub>(<italic>s</italic><sub>0 </sub>&#x02264; <italic>&#x003bc; </italic>+ <italic>&#x003c8;</italic>) and it is strictly decreasing on ]<italic>&#x003bc; </italic>+ <italic>&#x003c8; </italic>,+&#x0221e;[.</p><p>The estimation of <italic>s</italic><sub>0 </sub>is not trivial because it depends on the knowledge of the cumulative distribution function. Extensive studies provided experimental and theoretical supports for an extreme value distribution of alignment scores [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B43">43</xref>,<xref ref-type="bibr" rid="B44">44</xref>]. Using the extreme value distribution of type I, <italic>i.e. </italic>the Gumbel distribution [<xref ref-type="bibr" rid="B62">62</xref>], the cumulative distribution is given by</p><p><inline-graphic xlink:href="1471-2105-6-49-i30.gif"/></p><p>with <italic>&#x003b8; </italic>and <italic>&#x003b2; </italic>(<italic>&#x003b2; </italic>&#x0003e; 0) the location and scale parameters. The probability density function <italic>g</italic>(<italic>s</italic>) is defined by <italic>dG</italic>(<italic>s</italic>) = <italic>g</italic>(<italic>s</italic>)<italic>ds</italic>. We observe with <inline-graphic xlink:href="1471-2105-6-49-i31.gif"/> that <inline-graphic xlink:href="1471-2105-6-49-i32.gif"/>. Using the Taylor's polynomial formula, <italic>i.e. </italic><inline-graphic xlink:href="1471-2105-6-49-i33.gif"/>:</p><p><inline-graphic xlink:href="1471-2105-6-49-i34.gif"/></p><p>In consequence, for a Gumbel score probability distribution:</p><p><inline-graphic xlink:href="1471-2105-6-49-i35.gif"/></p><p>A graphical determination of <italic>&#x003c8; </italic>from a Gumbel distribution is illustrated in Figure <xref ref-type="fig" rid="F5">5</xref>.</p><p>If a pair-wise alignment score of two sequences <italic>a </italic>and <italic>b </italic>is relatively high, that is <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) &#x02265; <italic>&#x003bc; </italic>+ <italic>&#x003c8;</italic>, then the trivial inequality <italic>s</italic>(<italic>a</italic>,<italic>a</italic>) &#x02265; <italic>s</italic>(<italic>a</italic>,<italic>b</italic>) implies</p><p>(<italic>s</italic>(<italic>a</italic>,<italic>b</italic>) - <italic>&#x003bc;</italic>)<sup>2</sup>(1 - <italic>F</italic>(<italic>s</italic>(<italic>a</italic>,<italic>b</italic>))) &#x02265; (<italic>s</italic>(<italic>a</italic>,<italic>a</italic>) - <italic>&#x003bc;</italic>)<sup>2</sup>(1 - <italic>F</italic>(<italic>s</italic>(<italic>a</italic>,<italic>a</italic>))) &#x000a0;&#x000a0;&#x000a0; (h)</p><p>that is to say</p><p><inline-graphic xlink:href="1471-2105-6-49-i36.gif"/></p><p>From inequality (i), we deduce that <italic>p</italic><sub><italic>id</italic>/<italic>a </italic></sub>is bounded above.</p></sec><sec><title>Construction of PHYLIP multiple alignment based trees and pair-wise alignment based TULIP trees</title><p>To build PHYLIP trees, multiple sequence alignments were created with ClustalW [<xref ref-type="bibr" rid="B63">63</xref>]. PHYLIP trees where constructed using the protpars and neighbor modules from the PHYLIP package [<xref ref-type="bibr" rid="B47">47</xref>] and the BLOSUM 62 substitution matrix. Bootstrap support was estimated using 1000 replicates. To build TULIP trees, for each couple of sequences <italic>a </italic>and <italic>b</italic>, alignment was achieved with the Smith-Waterman method and the BLOSUM 62 scoring matrices, using the BIOFACET package from Gene-IT, France [<xref ref-type="bibr" rid="B64">64</xref>]. We computed estimated z-scores <italic>z</italic>(<italic>a</italic>,<italic>b</italic>*), <italic>z</italic>(<italic>a</italic>,<italic>a</italic>*), <italic>z</italic>(<italic>a</italic>*,<italic>b</italic>), <italic>z</italic>(<italic>b</italic>*,<italic>b</italic>*), with 2000 sequence shuffling. For all computations, an estimation of the Gumbel parameters <italic>&#x003b8; </italic>and <italic>&#x003b2; </italic>was made using the computed <italic>&#x003bc; </italic>and <italic>&#x003c3; </italic>of any <italic>S</italic>(<italic>a</italic>,<italic>b</italic>*) and the formula <inline-graphic xlink:href="1471-2105-6-49-i37.gif"/> and <italic>&#x003b8; </italic>= <italic>&#x003bc; </italic>- <italic>&#x003b2;</italic>&#x00393;'(1), where &#x00393;'(1) &#x02248; 0.577216 is the Euler constant. In all computations, both Gumbel parameters were very close (in the case of enolases, <italic>mean</italic>(<italic>&#x003b8;</italic>) = 35.04, <italic>SD</italic>(<italic>&#x003b8;</italic>) = 0.12, <italic>mean</italic>(<italic>&#x003b2;</italic>) = 3.92, <italic>SD</italic>(<italic>&#x003b2;</italic>) = 0.08). As a consequence, the assumption <italic>Q</italic>(<italic>a</italic>,<italic>a</italic>*) &#x02248; <italic>Q</italic>(<italic>a</italic>,<italic>b</italic>*) was verified for any pair of sequences. We used the parameters to estimate <italic>&#x003bc; </italic>= <italic>&#x003b8; </italic>+ <italic>&#x003b2;</italic>&#x00393; '(1) (in the case of enolases, <italic>&#x003bc; </italic>= 37.33), and <italic>&#x003bc; </italic>+ <italic>&#x003c8; </italic>&#x02248; <italic>&#x003bc; </italic>+ 10.5178 &#x02248; 47.85. As any pairs of computed scores are higher than this critical threshold, we used relation [<xref ref-type="bibr" rid="B20">20</xref>]. Estimation of evolutionary time was achieved according to equations [<xref ref-type="bibr" rid="B20">20</xref>] and [<xref ref-type="bibr" rid="B22">22</xref>]. Trees were constructed using Fitch-Margoliash and Neighbor-Joining methods [<xref ref-type="bibr" rid="B47">47</xref>].</p></sec></sec><sec><title>List of abbreviations</title><p>CSHP, configuration space of homologous proteins, TULIP, theorem of the upper limit of a score probability</p></sec><sec><title>Authors' contributions</title><p>OB conceived the main theoretical model, designed and developed the method to build phylogenetic trees and drafted the manuscript. SR and PO participated in the theoretical model refinement and in the design and development of computational methods to build TULIP trees. EM contributed to the conception of this study, participated in its design and coordination and helped to draft the manuscript. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>We thank John Dunlop for copy editing and Jo&#x000eb;l Bleuse and Jacques Demongeot for critical reading of this manuscript. We are indebted to Jean-Paul Eynard, Jean-Michel Pabiot and Jean-Jacques Codani for supportive help. Part of this work was financed by Minist&#x000e8;re de la Recherche et de la Technologie and by Agence Nationale de la Valorisation de la Recherche Rh&#x000f4;ne-Alpes.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zuckerkandl</surname><given-names>E</given-names></name><name><surname>Pauling</surname><given-names>L</given-names></name></person-group><article-title>Molecules as documents of evolutionary history</article-title><source>J Theor Biol</source><year>1965</year><volume>8</volume><fpage>357</fpage><lpage>366</lpage><pub-id pub-id-type="pmid">5876245</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zukerkandl</surname><given-names>E</given-names></name></person-group><article-title>The evolution of hemoglobin</article-title><source>Sci Am</source><year>1965</year><volume>212</volume><fpage>110</fpage><lpage>118</lpage></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name><name><surname>Margoliash</surname><given-names>E</given-names></name></person-group><article-title>Construction of phylogenetic trees</article-title><source>Science</source><year>1967</year><volume>155</volume><fpage>279</fpage><lpage>284</lpage><pub-id pub-id-type="pmid">5334057</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Arnheim</surname><given-names>N</given-names></name><name><surname>Taylor</surname><given-names>CE</given-names></name></person-group><article-title>Non-Darwinian evolution: consequences for neutral allelic variation</article-title><source>Nature</source><year>1969</year><volume>223</volume><fpage>900</fpage><lpage>903</lpage><pub-id pub-id-type="pmid">5803391</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dayhoff</surname><given-names>MO</given-names></name></person-group><article-title>Computer analysis of protein evolution</article-title><source>Sci Am</source><year>1969</year><volume>221</volume><fpage>86</fpage><lpage>95</lpage><pub-id pub-id-type="pmid">5789703</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Arnheim</surname><given-names>N</given-names></name><name><surname>Steller</surname><given-names>R</given-names></name></person-group><article-title>Multiple genes for lysozyme in birds</article-title><source>Arch Biochem Biophys</source><year>1970</year><volume>141</volume><fpage>656</fpage><lpage>661</lpage><pub-id pub-id-type="pmid">4993236</pub-id><pub-id pub-id-type="doi">10.1016/0003-9861(70)90185-2</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>DeLange</surname><given-names>RJ</given-names></name><name><surname>Smith</surname><given-names>EL</given-names></name></person-group><article-title>Histones: structure and function</article-title><source>Annu Rev Biochem</source><year>1971</year><volume>40</volume><fpage>279</fpage><lpage>314</lpage><pub-id pub-id-type="pmid">4941236</pub-id><pub-id pub-id-type="doi">10.1146/annurev.bi.40.070171.001431</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zuckerkandl</surname><given-names>E</given-names></name></person-group><article-title>Some aspects of protein evolution</article-title><source>Biochimie</source><year>1972</year><volume>54</volume><fpage>1095</fpage><lpage>102</lpage><pub-id pub-id-type="pmid">4655017</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dayhoff</surname><given-names>MO</given-names></name><name><surname>Barker</surname><given-names>WC</given-names></name><name><surname>McLaughlin</surname><given-names>PJ</given-names></name></person-group><article-title>Inferences from protein and nucleic acid sequences: early molecular evolution, divergence of kingdoms and rates of change</article-title><source>Orig Life</source><year>1974</year><volume>5</volume><fpage>311</fpage><lpage>330</lpage><pub-id pub-id-type="pmid">4370101</pub-id><pub-id pub-id-type="doi">10.1007/BF01207633</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>TT</given-names></name><name><surname>Fitch</surname><given-names>WM</given-names></name><name><surname>Margoliash</surname><given-names>E</given-names></name></person-group><article-title>The information content of protein amino acid sequences</article-title><source>Annu Rev Biochem</source><year>1974</year><volume>43</volume><fpage>539</fpage><lpage>566</lpage><pub-id pub-id-type="pmid">4369316</pub-id><pub-id pub-id-type="doi">10.1146/annurev.bi.43.070174.002543</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brocchieri</surname><given-names>L</given-names></name></person-group><article-title>Phylogenetic inferences from molecular sequences: review and critique</article-title><source>Theor Popul Biol</source><year>2001</year><volume>59</volume><fpage>27</fpage><lpage>40</lpage><pub-id pub-id-type="pmid">11243926</pub-id><pub-id pub-id-type="doi">10.1006/tpbi.2000.1485</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname><given-names>GA</given-names></name><name><surname>Hickey</surname><given-names>DA</given-names></name></person-group><article-title>Nucleotide bias causes a genomewide bias in the amino acid composition of proteins</article-title><source>Mol Biol Evol</source><year>2000</year><volume>17</volume><fpage>1581</fpage><lpage>1588</lpage><pub-id pub-id-type="pmid">11070046</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bastien</surname><given-names>O</given-names></name><name><surname>Lespinats</surname><given-names>S</given-names></name><name><surname>Roy</surname><given-names>S</given-names></name><name><surname>Metayer</surname><given-names>K</given-names></name><name><surname>Fertil</surname><given-names>B</given-names></name><name><surname>Codani</surname><given-names>JJ</given-names></name><name><surname>Mar&#x000e9;chal</surname><given-names>E</given-names></name></person-group><article-title>Analysis of the compositional biases in Plasmodium falciparum genome and proteome using Arabidopsis thaliana as a reference</article-title><source>Gene</source><year>2004</year><volume>336</volume><fpage>163</fpage><lpage>173</lpage><pub-id pub-id-type="pmid">15246528</pub-id><pub-id pub-id-type="doi">10.1016/j.gene.2004.04.029</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Doolittle</surname><given-names>RF</given-names></name></person-group><article-title>Similar amino acid sequences: chance or common ancestry?</article-title><source>Science</source><year>1981</year><volume>214</volume><fpage>149</fpage><lpage>159</lpage><pub-id pub-id-type="pmid">7280687</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Otu</surname><given-names>HH</given-names></name><name><surname>Sayood</surname><given-names>K</given-names></name></person-group><article-title>A new sequence distance measure for phylogenetic tree construction</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>2122</fpage><lpage>2130</lpage><pub-id pub-id-type="pmid">14594718</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg295</pub-id></citation></ref><ref id="B16"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Jukes</surname><given-names>TH</given-names></name><name><surname>Cantor</surname><given-names>CR</given-names></name></person-group><source>Mammalian Protein Metabolism</source><year>1969</year><publisher-name>New York: Academic Press</publisher-name></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><article-title>A simple model for estimating evolutionary rates of base substitiutions through comparative studies of nucleotide sequences</article-title><source>J Mol Evol</source><year>1980</year><volume>16</volume><fpage>111</fpage><lpage>120</lpage><pub-id pub-id-type="pmid">7463489</pub-id></citation></ref><ref id="B18"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lake</surname><given-names>JA</given-names></name></person-group><article-title>Reconstructing evolutionary trees from DNA and protein sequences: paralinear distances</article-title><source>Proc Natl Acad Sci USA</source><year>1994</year><volume>91</volume><fpage>1455</fpage><lpage>1459</lpage><pub-id pub-id-type="pmid">8108430</pub-id></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>DF</given-names></name><name><surname>Doolittle</surname><given-names>RF</given-names></name></person-group><article-title>Converting amino acid alignment scores into measures of evolutionary time: a simulation study of various relationships</article-title><source>J Mol Evol</source><year>1997</year><volume>44</volume><fpage>361</fpage><lpage>370</lpage><pub-id pub-id-type="pmid">9089075</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Camin</surname><given-names>J</given-names></name><name><surname>Sokal</surname><given-names>R</given-names></name></person-group><article-title>A method for deducing branching sequences in phylogeny</article-title><source>Evolution</source><year>1965</year><volume>19</volume><fpage>311</fpage><lpage>326</lpage></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name></person-group><article-title>Toward defining the course of evolution: minimum change for a specific tree topology</article-title><source>Syst Zool</source><year>1971</year><volume>35</volume><fpage>406</fpage><lpage>416</lpage></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title><source>J Mol Evol</source><year>1981</year><volume>17</volume><fpage>368</fpage><lpage>376</lpage><pub-id pub-id-type="pmid">7288891</pub-id></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name><name><surname>Churchill</surname><given-names>GA</given-names></name></person-group><article-title>A hidden Markov model approach to variation among sites in rate of evolution</article-title><source>Mol Biol Evol</source><year>1996</year><volume>13</volume><fpage>93</fpage><lpage>104</lpage><pub-id pub-id-type="pmid">8583911</pub-id></citation></ref><ref id="B24"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Salemi</surname><given-names>M</given-names></name><name><surname>Vandamme</surname><given-names>AM</given-names></name></person-group><source>The Phylogenetic Handbook</source><year>2003</year><publisher-name>Cambridge University Press</publisher-name></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>DF</given-names></name><name><surname>Cho</surname><given-names>G</given-names></name><name><surname>Doolittle</surname><given-names>RF</given-names></name></person-group><article-title>Determining divergence times with a protein clock: update and reevaluation</article-title><source>Proc Natl Acad Sci USA</source><year>1997</year><volume>94</volume><fpage>13028</fpage><lpage>13033</lpage><pub-id pub-id-type="pmid">9371794</pub-id><pub-id pub-id-type="doi">10.1073/pnas.94.24.13028</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nei</surname><given-names>M</given-names></name><name><surname>Xu</surname><given-names>P</given-names></name><name><surname>Glazko</surname><given-names>G</given-names></name></person-group><article-title>Estimation of divergence times from multiprotein sequences for a few mammalian species and several distantly related organisms</article-title><source>Proc Natl Acad Sci USA</source><year>2001</year><volume>98</volume><fpage>2497</fpage><lpage>2502</lpage><pub-id pub-id-type="pmid">11226267</pub-id><pub-id pub-id-type="doi">10.1073/pnas.051611498</pub-id></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Doolittle</surname><given-names>RF</given-names></name><name><surname>Feng</surname><given-names>DF</given-names></name><name><surname>Tsang</surname><given-names>S</given-names></name><name><surname>Cho</surname><given-names>G</given-names></name><name><surname>Little</surname><given-names>E</given-names></name></person-group><article-title>Determining divergence times of the major kingdoms of living organisms with a protein clock</article-title><source>Science</source><year>1996</year><volume>271</volume><fpage>470</fpage><lpage>477</lpage><pub-id pub-id-type="pmid">8560259</pub-id></citation></ref><ref id="B28"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dayhoff</surname><given-names>MO</given-names></name><name><surname>Barker</surname><given-names>WC</given-names></name><name><surname>Hunt</surname><given-names>LT</given-names></name></person-group><article-title>Establishing homologies in protein sequences</article-title><source>Methods Enzymol</source><year>1983</year><volume>91</volume><fpage>524</fpage><lpage>545</lpage><pub-id pub-id-type="pmid">6855599</pub-id></citation></ref><ref id="B29"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Risler</surname><given-names>JL</given-names></name><name><surname>Delorme</surname><given-names>MO</given-names></name><name><surname>Delacroix</surname><given-names>H</given-names></name><name><surname>Henaut</surname><given-names>A</given-names></name></person-group><article-title>Amino acid substitutions in structurally related proteins. A pattern recognition approach. Determination of a new and efficient scoring matrix</article-title><source>J Mol Biol</source><year>1988</year><volume>204</volume><fpage>1019</fpage><lpage>1029</lpage><pub-id pub-id-type="pmid">3221397</pub-id><pub-id pub-id-type="doi">10.1016/0022-2836(88)90058-7</pub-id></citation></ref><ref id="B30"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Henikoff</surname><given-names>S</given-names></name><name><surname>Henikoff</surname><given-names>JG</given-names></name></person-group><article-title>Amino acid substitution matrices from protein blocks</article-title><source>Proc Natl Acad Sci USA</source><year>1992</year><volume>89</volume><fpage>10915</fpage><lpage>10919</lpage><pub-id pub-id-type="pmid">1438297</pub-id></citation></ref><ref id="B31"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Waterman</surname><given-names>MS</given-names></name></person-group><source>Introduction to computational biology</source><year>1995</year><publisher-name>CRC Press</publisher-name></citation></ref><ref id="B32"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Needleman</surname><given-names>SB</given-names></name><name><surname>Wunsch</surname><given-names>CD</given-names></name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title><source>J Mol Biol</source><year>1970</year><volume>48</volume><fpage>443</fpage><lpage>453</lpage><pub-id pub-id-type="pmid">5420325</pub-id><pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id></citation></ref><ref id="B33"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>TF</given-names></name><name><surname>Waterman</surname><given-names>MS</given-names></name></person-group><article-title>Identification of common molecular subsequences</article-title><source>J Mol Biol</source><year>1981</year><volume>147</volume><fpage>195</fpage><lpage>197</lpage><pub-id pub-id-type="pmid">7265238</pub-id><pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id></citation></ref><ref id="B34"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>WM</given-names></name></person-group><article-title>Random sequences</article-title><source>J Mol Biol</source><year>1983</year><volume>163</volume><fpage>171</fpage><lpage>176</lpage><pub-id pub-id-type="pmid">6842586</pub-id><pub-id pub-id-type="doi">10.1016/0022-2836(83)90002-5</pub-id></citation></ref><ref id="B35"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Grishin</surname><given-names>NV</given-names></name></person-group><article-title>Estimation of the number of amino acid substitutions per site when the substitution rate varies among sites</article-title><source>J Mol Evol</source><year>1995</year><volume>41</volume><fpage>675</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1007/BF00175826</pub-id></citation></ref><ref id="B36"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Keeling</surname><given-names>PJ</given-names></name><name><surname>Palmer</surname><given-names>JD</given-names></name></person-group><article-title>Lateral transfer at the gene and subgenic levels in the evolution of eukaryotic enolase</article-title><source>Proc Natl Acad Sci USA</source><year>2001</year><volume>98</volume><fpage>10745</fpage><lpage>10750</lpage><pub-id pub-id-type="pmid">11526220</pub-id><pub-id pub-id-type="doi">10.1073/pnas.191337098</pub-id></citation></ref><ref id="B37"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hartley</surname><given-names>RVL</given-names></name></person-group><article-title>Transmission of Information</article-title><source>The Bell System Technical Journal</source><year>1928</year><volume>3</volume><fpage>535</fpage><lpage>564</lpage></citation></ref><ref id="B38"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Shannon</surname><given-names>CE</given-names></name></person-group><article-title>A Mathematical Theory of Communication</article-title><source>The Bell System Technical Journal</source><year>1948</year><volume>27</volume><fpage>379</fpage><lpage>423</lpage></citation></ref><ref id="B39"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bastien</surname><given-names>O</given-names></name><name><surname>Aude</surname><given-names>JC</given-names></name><name><surname>Roy</surname><given-names>S</given-names></name><name><surname>Mar&#x000e9;chal</surname><given-names>E</given-names></name></person-group><article-title>Fundamentals of massive automatic pairwise alignments of protein sequences: theoretical significance of Z-value statistics</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>534</fpage><lpage>537</lpage><pub-id pub-id-type="pmid">14990449</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg440</pub-id></citation></ref><ref id="B40"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dayhoff</surname><given-names>MO</given-names></name><name><surname>Schwartz</surname><given-names>RM</given-names></name><name><surname>Orcutt</surname><given-names>BC</given-names></name></person-group><article-title>A Model of Evolutionary Change in Proteins</article-title><source>Atlas of Protein Sequence and Structure</source><year>1978</year><volume>5</volume><fpage>345</fpage><lpage>352</lpage></citation></ref><ref id="B41"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Setubal</surname><given-names>J</given-names></name><name><surname>Meidanis</surname><given-names>J</given-names></name></person-group><source>Introduction to Computational Molecular Biology</source><year>1997</year><publisher-name>PWS Publishing Compagny</publisher-name></citation></ref><ref id="B42"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Gish</surname><given-names>W</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Lipman</surname><given-names>DJ</given-names></name></person-group><article-title>Basic local alignment search tool</article-title><source>J Mol Biol</source><year>1990</year><volume>215</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">2231712</pub-id><pub-id pub-id-type="doi">10.1006/jmbi.1990.9999</pub-id></citation></ref><ref id="B43"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Karlin</surname><given-names>S</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name></person-group><article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title><source>Proc Natl Acad Sci USA</source><year>1990</year><volume>87</volume><fpage>2264</fpage><lpage>2268</lpage><pub-id pub-id-type="pmid">2315319</pub-id></citation></ref><ref id="B44"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Comet</surname><given-names>JP</given-names></name><name><surname>Aude</surname><given-names>JC</given-names></name><name><surname>Glemet</surname><given-names>E</given-names></name><name><surname>Risler</surname><given-names>JL</given-names></name><name><surname>Henaut</surname><given-names>A</given-names></name><name><surname>Slonimski</surname><given-names>PP</given-names></name><name><surname>Codani</surname><given-names>JJ</given-names></name></person-group><article-title>Significance of Z-value statistics of Smith-Waterman scores for protein alignments</article-title><source>Comput Chem</source><year>1999</year><volume>23</volume><fpage>317</fpage><lpage>331</lpage><pub-id pub-id-type="pmid">10627144</pub-id><pub-id pub-id-type="doi">10.1016/S0097-8485(99)00008-X</pub-id></citation></ref><ref id="B45"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bacro</surname><given-names>JN</given-names></name><name><surname>Comet</surname><given-names>JP</given-names></name></person-group><article-title>Sequence alignment: an approximation law for the Z-value with applications to databank scanning</article-title><source>Comput Chem</source><year>2001</year><volume>25</volume><fpage>401</fpage><lpage>410</lpage><pub-id pub-id-type="pmid">11459354</pub-id><pub-id pub-id-type="doi">10.1016/S0097-8485(01)00074-2</pub-id></citation></ref><ref id="B46"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Louis</surname><given-names>A</given-names></name><name><surname>Ollivier</surname><given-names>E</given-names></name><name><surname>Aude</surname><given-names>JC</given-names></name><name><surname>Risler</surname><given-names>JL</given-names></name></person-group><article-title>Massive sequence comparisons as a help in annotating genomic sequences</article-title><source>Genome Res</source><year>2001</year><volume>11</volume><fpage>1296</fpage><lpage>1303</lpage><pub-id pub-id-type="pmid">11435413</pub-id><pub-id pub-id-type="doi">10.1101/gr.GR-1776R</pub-id></citation></ref><ref id="B47"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>PHYLIP &#x02013; Phylogeny Inference Package (Version 3.2)</article-title><source>Cladistics</source><year>1989</year><volume>5</volume><fpage>164</fpage><lpage>166</lpage></citation></ref><ref id="B48"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>HA</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name></person-group><article-title>TREE-PUZZLE: maximum likelihood phylogenetic analysis using quartets and parallel computing</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>502</fpage><lpage>504</lpage><pub-id pub-id-type="pmid">11934758</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.502</pub-id></citation></ref><ref id="B49"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>JD</given-names></name><name><surname>Plewniak</surname><given-names>F</given-names></name><name><surname>Poch</surname><given-names>O</given-names></name></person-group><article-title>A comprehensive comparison of multiple sequence alignment programs</article-title><source>Nucleic Acids Res</source><year>1999</year><volume>27</volume><fpage>2682</fpage><lpage>2690</lpage><pub-id pub-id-type="pmid">10373585</pub-id><pub-id pub-id-type="doi">10.1093/nar/27.13.2682</pub-id></citation></ref><ref id="B50"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simmons</surname><given-names>MP</given-names></name><name><surname>Freudenstein</surname><given-names>JV</given-names></name></person-group><article-title>The effects of increasing genetic distance on alignment of, and tree construction from, rDNA internal transcribed spacer sequences</article-title><source>Mol Phylogenet Evol</source><year>2003</year><volume>26</volume><fpage>444</fpage><lpage>451</lpage><pub-id pub-id-type="pmid">12644403</pub-id><pub-id pub-id-type="doi">10.1016/S1055-7903(02)00366-4</pub-id></citation></ref><ref id="B51"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Manly</surname><given-names>BFJ</given-names></name></person-group><source>Randomization, Bootstrap and Monte Carlo Methods in Biology</source><year>1997</year><publisher-name>CRC Press</publisher-name></citation></ref><ref id="B52"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>S</given-names></name></person-group><article-title>Global statistics of protein sequences: implications for the origin, evolution, and prediction of structure</article-title><source>Annu Rev Biophys Biomol Struct</source><year>1994</year><volume>23</volume><fpage>407</fpage><lpage>439</lpage><pub-id pub-id-type="pmid">7919788</pub-id><pub-id pub-id-type="doi">10.1146/annurev.bb.23.060194.002203</pub-id></citation></ref><ref id="B53"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Capinski</surname><given-names>M</given-names></name><name><surname>Kopp</surname><given-names>E</given-names></name></person-group><source>Measure, Integral and Probability</source><year>1999</year><publisher-name>New-York: Springer-Verlag</publisher-name></citation></ref><ref id="B54"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Rannala</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>Z</given-names></name></person-group><article-title>Probability distribution of molecular evolutionary trees: a new method of phylogenetic inference</article-title><source>J Mol Evol</source><year>1996</year><volume>43</volume><fpage>304</fpage><lpage>311</lpage><pub-id pub-id-type="pmid">8703097</pub-id></citation></ref><ref id="B55"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname><given-names>Y</given-names></name><name><surname>Glazko</surname><given-names>GV</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>Overcredibility of molecular phylogenies obtained by Bayesian phylogenetics</article-title><source>Proc Natl Acad Sci U S A</source><year>2002</year><volume>99</volume><fpage>16138</fpage><lpage>16143</lpage><pub-id pub-id-type="pmid">12451182</pub-id><pub-id pub-id-type="doi">10.1073/pnas.212646199</pub-id></citation></ref><ref id="B56"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Simmons</surname><given-names>MP</given-names></name><name><surname>Pickett</surname><given-names>KM</given-names></name><name><surname>Miya</surname><given-names>M</given-names></name></person-group><article-title>How meaningful are Bayesian support values?</article-title><source>Mol Biol Evol</source><year>2004</year><volume>21</volume><fpage>188</fpage><lpage>199</lpage><pub-id pub-id-type="pmid">14595090</pub-id><pub-id pub-id-type="doi">10.1093/molbev/msh014</pub-id></citation></ref><ref id="B57"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Mullapudi</surname><given-names>N</given-names></name><name><surname>Lancto</surname><given-names>CA</given-names></name><name><surname>Scott</surname><given-names>M</given-names></name><name><surname>Abrahamsen</surname><given-names>MS</given-names></name><name><surname>Kissinger</surname><given-names>JC</given-names></name></person-group><article-title>Phylogenomic evidence supports past endosymbiosis, intracellular and horizontal gene transfer in Cryptosporidium parvum</article-title><source>Genome Biol</source><year>2004</year><volume>5</volume><fpage>R88</fpage><pub-id pub-id-type="pmid">15535864</pub-id><pub-id pub-id-type="doi">10.1186/gb-2004-5-11-r88</pub-id></citation></ref><ref id="B58"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Read</surname><given-names>M</given-names></name><name><surname>Hicks</surname><given-names>KE</given-names></name><name><surname>Sims</surname><given-names>PF</given-names></name><name><surname>Hyde</surname><given-names>JE</given-names></name></person-group><article-title>Molecular characterisation of the enolase gene from the human malaria parasite Plasmodium falciparum. Evidence for ancestry within a photosynthetic lineage</article-title><source>Eur J Biochem</source><year>1994</year><volume>220</volume><fpage>513</fpage><lpage>520</lpage><pub-id pub-id-type="pmid">8125109</pub-id><pub-id pub-id-type="doi">10.1111/j.1432-1033.1994.tb18650.x</pub-id></citation></ref><ref id="B59"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Dzierszinski</surname><given-names>F</given-names></name><name><surname>Popescu</surname><given-names>O</given-names></name><name><surname>Toursel</surname><given-names>C</given-names></name><name><surname>Slomianny</surname><given-names>C</given-names></name><name><surname>Yahiaoui</surname><given-names>B</given-names></name><name><surname>Tomavo</surname><given-names>S</given-names></name></person-group><article-title>The protozoan parasite Toxoplasma gondii expresses two functional plant-like glycolytic enzymes. Implications for evolutionary origin of apicomplexans</article-title><source>J Biol Chem</source><year>1999</year><volume>274</volume><fpage>24888</fpage><lpage>24895</lpage><pub-id pub-id-type="pmid">10455162</pub-id><pub-id pub-id-type="doi">10.1074/jbc.274.35.24888</pub-id></citation></ref><ref id="B60"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Lang</surname><given-names>S</given-names></name></person-group><source>Undergraduate analysis</source><year>1997</year><publisher-name>New-York: Springer-Verlag</publisher-name></citation></ref><ref id="B61"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Valleron</surname><given-names>AJ</given-names></name></person-group><source>Introduction &#x000e0; la Biostatistique</source><year>1998</year><publisher-name>Paris: Masson</publisher-name></citation></ref><ref id="B62"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Coles</surname><given-names>S</given-names></name></person-group><source>An introduction to Statistical Modeling of Extreme Values</source><year>2001</year><publisher-name>New-York: Springer-Verlag</publisher-name></citation></ref><ref id="B63"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>JD</given-names></name><name><surname>Higgins</surname><given-names>DG</given-names></name><name><surname>Gibson</surname><given-names>TJ</given-names></name></person-group><article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title><source>Nucleic Acids Res</source><year>1994</year><volume>22</volume><fpage>4673</fpage><lpage>4680</lpage><pub-id pub-id-type="pmid">7984417</pub-id></citation></ref><ref id="B64"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Codani</surname><given-names>JJ</given-names></name><name><surname>Comet</surname><given-names>JP</given-names></name><name><surname>Aude</surname><given-names>JC</given-names></name><name><surname>Gl&#x000e9;met</surname><given-names>E</given-names></name><name><surname>Wozniak</surname><given-names>A</given-names></name><name><surname>Risler</surname><given-names>JL</given-names></name><name><surname>H&#x000e9;naut</surname><given-names>A</given-names></name><name><surname>Slonimski</surname><given-names>PP</given-names></name></person-group><article-title>Automatic analysis of large-scale pairwize alignments of protein sequences</article-title><source>Methods in Microbiology</source><year>1999</year><volume>28</volume><fpage>229</fpage><lpage>244</lpage></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p>Geometric and probabilistic representation of the configuration space of homologous proteins (CSHP). For any sequence <italic>a </italic>taken as a reference (<italic>a</italic><sub><italic>ref</italic></sub>), one can build a configuration space (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) where all sequences that are homologous to <italic>a </italic>can be set. When two sequences <italic>a </italic>and <italic>b </italic>are aligned with a score <italic>s</italic>(<italic>a</italic>,<italic>b</italic>), then <italic>b </italic>is positioned in (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) and <italic>a </italic>in (CSHP, <italic>b</italic><sub><italic>ref</italic></sub>). The sequence alignment length determines the number of configuration dimensions; pair-wise amino acid scores determine the unique solution for its positioning. The q-dissimilarity (<italic>q </italic>= <italic>e</italic><sup>-<italic>s</italic></sup>) defines a proximity between sequences allowing a geometric representation (CSHP, <italic>q</italic>). Remarkable properties are i) the conservation of mutual information, [<italic>I</italic>(<italic>a</italic>;<italic>b</italic>) = <italic>I</italic>(<italic>b</italic>;<italic>a</italic>) &#x021d2; <italic>q</italic>(<italic>a</italic>,<italic>b</italic>) = <italic>q</italic>(<italic>b</italic>,<italic>a</italic>)], between (CSHP, <italic>a</italic><sub><italic>ref</italic></sub>) and (CSHP, <italic>b</italic><sub><italic>ref</italic></sub>), ii) a probabilistic representation of homologies based on q-dissimilarities by Venn diagrams (A and B) and iii) the assignment of a topology relying on protein evolution assumptions. Evolutionary paths for <italic>a </italic>and <italic>b </italic>lineages, sharing an unknown ancestor <italic>u</italic>, have a probabilistic expression, bounded above (see text), supporting a phylogenetic topology (TULIP trees).</p></caption><graphic xlink:href="1471-2105-6-49-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p>Glucose-6-phosphate isomerase phylogeny. <bold>(A) </bold>Multiple alignment based (MAB) tree. <bold>(B) </bold>TULIP tree. Both trees were constructed using the BLOSUM 62 similarity matrix. For MAB tree construction, bootstrap support was estimated using 1000 replicates. To build TULIP trees, Z-scores were estimated with 2000 sequence shuffling. Topology supported by high bootstrap results in the MAB tree (figures in black), are consistently recovered in the corresponding pair-wise alignement based TULIP tree.</p></caption><graphic xlink:href="1471-2105-6-49-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p>Enolase phylogenic incongruence. When aligned, the enolase region corresponding to amino acids 73&#x02013;118 of the <italic>Oryza sativa </italic>gene, exhibit two insertions (red boxes) that are only present in land plants, charophytes and alveolates. In alveolates, these insertions are consistent with a horizontal gene transfer. However, to date, evolutionary reconstructions based on enolase sequences did not allow any phylogenetic branch gathering for these clades [36].</p></caption><graphic xlink:href="1471-2105-6-49-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p>Solution of the enolase phylogenic incongruence. <bold>(A) </bold>Multiple alignment based (MAB) tree. <bold>(B) </bold>TULIP tree. Both trees were constructed using the BLOSUM 62 similarity matrix. For MAB tree construction, bootstrap support was estimated using 1000 replicates. To build TULIP trees, Z-scores were estimated with 2000 sequence shuffling. Clades that contain a unique insertional signature (Land plants, green box; Charophytes and Chlorarachnion, blue box; Alveolates; yellow box) are not gathered in the MAB tree, as previously reported [36]. By contrast, in the TULIP tree, the phylogeny of enolase proteins is reconciled with the insertional signature detection in Land plants, Charophytes, Chlorarachnion and Alveolates.</p></caption><graphic xlink:href="1471-2105-6-49-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>(A) </bold>Gumbel score distribution simulated for enolases used in the present paper <bold>(B) </bold>graphical determination of <italic>&#x003c8;</italic></p></caption><graphic xlink:href="1471-2105-6-49-5"/></fig></sec></back></article>



