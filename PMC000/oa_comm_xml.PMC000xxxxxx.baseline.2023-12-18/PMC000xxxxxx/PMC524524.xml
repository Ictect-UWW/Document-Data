<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15469612</article-id><article-id pub-id-type="pmc">PMC524524</article-id><article-id pub-id-type="publisher-id">1471-2105-5-144</article-id><article-id pub-id-type="doi">10.1186/1471-2105-5-144</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Overdispersed logistic regression for SAGE: Modelling multiple groups and covariates</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Baggerly</surname><given-names>Keith A</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>kabagg@mdanderson.org</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Deng</surname><given-names>Li</given-names></name><xref ref-type="aff" rid="I2">2</xref><email>lideng@stat.rice.edu</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Morris</surname><given-names>Jeffrey S</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>jeffmo@odin.mdacc.tmc.edu</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Aldaz</surname><given-names>C Marcelo</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>maaldaz@mdanderson.org</email></contrib></contrib-group><aff id="I1"><label>1</label>Department of Biostatistics and Applied Mathematics, UT M. D. Anderson Cancer Center, Houston, TX, USA</aff><aff id="I2"><label>2</label>Department of Statistics, Rice University, Houston, TX, USA</aff><aff id="I3"><label>3</label>Department of Carcinogenesis, UT M. D. Anderson Cancer Center, Houston, TX, USA</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>6</day><month>10</month><year>2004</year></pub-date><volume>5</volume><fpage>144</fpage><lpage>144</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/5/144"/><history><date date-type="received"><day>25</day><month>2</month><year>2004</year></date><date date-type="accepted"><day>6</day><month>10</month><year>2004</year></date></history><copyright-statement>Copyright &#x000a9; 2004 Baggerly et al; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>Two major identifiable sources of variation in data derived from the Serial Analysis of Gene Expression (SAGE) are within-library sampling variability and between-library heterogeneity within a group. Most published methods for identifying differential expression focus on just the sampling variability. In recent work, the problem of assessing differential expression between two groups of SAGE libraries has been addressed by introducing a beta-binomial hierarchical model that explicitly deals with both of the above sources of variation. This model leads to a test statistic analogous to a weighted two-sample <italic>t</italic>-test. When the number of groups involved is more than two, however, a more general approach is needed.</p></sec><sec><title>Results</title><p>We describe how logistic regression with overdispersion supplies this generalization, carrying with it the framework for incorporating other covariates into the model as a byproduct. This approach has the advantage that logistic regression routines are available in several common statistical packages.</p></sec><sec><title>Conclusions</title><p>The described method provides an easily implemented tool for analyzing SAGE data that correctly handles multiple types of variation and allows for more flexible modelling.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><sec><title>The nature of SAGE</title><p>The Serial Analysis of Gene Expression (SAGE) methodology introduced by Velculescu et al. [<xref ref-type="bibr" rid="B1">1</xref>] is a sequencing-based approach to the measurement of gene expression.</p><p>Briefly, mRNA transcripts are converted to cDNA and then processed so as to isolate a specific subsequence; starting from the poly-A tail, the subsequence is the 10 (normal SAGE) or 14 (long SAGE) bp immediately preceding the first occurrence of a cleavage site for a common restriction enzyme. Ideally, this subsequence, or "tag" is sufficiently specific to uniquely identify the mRNA from which it was derived. Tags are sampled, concatenated and sequenced, and a table consisting of the tag sequences and their frequency of occurrence is assembled. The complete table derived from a given biological sample is referred to as a SAGE "library". As most tags are sparse within the entire sample, most libraries contain numbers of tags in the tens of thousands to allow the expression levels to be estimated. Due to the current costs of sequencing, however, the total number of libraries assembled for a given experiment is typically small: often in the single digits and occasionally in the tens.</p><p>While the type of information, gene expression, being investigated in a SAGE experiment is the same as that in a cDNA or oligonucleotide microarray experiment, there are some qualitative differences in the approaches. First, SAGE uses sequencing as opposed to competitive hybridization. Second, while the expression value reported for an array experiment is a measure of fluourescence and is loosely continuous, SAGE supplies data on gene expression in the form of counts, potentially allowing for a different type of "quantitative" comparison. Third, SAGE is an "open" technology in that it can provide information about all of the genes in the sample. Microarrays, by contrast, are "closed" in that we will only get information about the genes that have been printed on the array.</p><p>Mathematically, the information pertaining to the abundance of a particular tag in a sample is summarized in two numbers: <italic>Y</italic>, the number of counts of that tag in the library, and <italic>n</italic>, the total number of tags in the library. In analyzing SAGE data across a series of libraries, interest typically centers on assessing how the underlying true level of gene expression is changing as we move from one library to the next.</p></sec><sec><title>Mathematical formulation of the differential expression problem</title><p>When surveyed across a series of libraries, the sufficient statistics containing all of the information about the change in expression for a single tag are the set of counts {<italic>Y</italic><sub><italic>i</italic></sub>} and the set of library sizes {<italic>n</italic><sub><italic>i</italic></sub>}, where the subscript <italic>i </italic>denotes the specific library. Unless otherwise specified, we will restrict our assessment of differential expression to the case of a single tag. This approach is common to all of the procedures described below. In a real analysis the chosen test is applied to all tags individually and a list of those tags showing differential expression is reported. Different tests will provide altered assessments of significance for individual tags, and hence the list provided will depend on the test employed.</p><p>In most problems of interest, there is also covariate information <italic>X</italic><sub><italic>i </italic></sub>describing properties of library <italic>i</italic>. The most common case involves comparing two groups of libraries, such as cancer and control. In this case the information <italic>X</italic><sub><italic>i </italic></sub>simply defines which group library <italic>i </italic>belongs to. If there are more than two groups, <italic>X</italic><sub><italic>i </italic></sub>can have more levels or can even be vector valued, but as before interest centers on assessing how and whether the expected proportion changes with <italic>X</italic>.</p><p>Much work has been done on the problem of comparing expression between two groups. Most of the approaches [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B9">9</xref>] deal with comparing one library with another. Of these, [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>] extend their consideration to the case of two groups of libraries by pooling the libraries within a group, effectively reducing the sufficient statistics to the summed counts</p><p><inline-graphic xlink:href="1471-2105-5-144-i1.gif"/></p><p>This approach, while it captures the count nature of the data, loses information in that variation of the proportions within a group is ignored. As noted by both Man et al. [<xref ref-type="bibr" rid="B9">9</xref>] and Ruijter et al. [<xref ref-type="bibr" rid="B10">10</xref>], most of the above tests give equivalent results in terms of assessing significant differences. By contrast, the two-sample <italic>t</italic>-test used to compare two groups of samples in [<xref ref-type="bibr" rid="B11">11</xref>] reduces the sufficient statistics to the set of proportions {<italic>p</italic><sub><italic>i</italic></sub>} = {<italic>Y</italic><sub><italic>i</italic></sub>/<italic>n</italic><sub><italic>i</italic></sub>}, capturing the variation between members of a group but losing track of the inherent count sampling nature and variability of the data. The two-sample <italic>t</italic>-test results can be dramatically different from the pooled test results, as they focus on two different types of variation. The effects of these two approaches on a single group of four libraries are shown in Table <xref ref-type="table" rid="T1">1</xref>. Pooling reduces the data to the summed counts at the right, and focusing on proportions reduces the data to the proportions on the bottom. In both cases, this reduction results in a loss of information. When pooling is used, we can't tell that one of the group proportions was large and the other small, indicating instability. When proportions are used, we can't tell that one library was much smaller than the other, so that proportion should be "trusted less" than the other.</p><p>Baggerly et al. [<xref ref-type="bibr" rid="B12">12</xref>] proposed a beta-binomial hierarchical model for SAGE data in an attempt to simultaneously model both types of variation. This model leads to a test statistic called a weighted two-sample <italic>t</italic>-test, <italic>t</italic><sub><italic>w</italic></sub>. Computing the value of this test statistic requires all 8 of the numbers in the main body of Table <xref ref-type="table" rid="T1">1</xref>; there is no reduction of the sufficient statistics. This test statistic exhibits different behaviors depending on which type of variation is larger for a given tag. When the within-library sampling variation is much larger than the between-library variation, <italic>t</italic><sub><italic>w </italic></sub>gives results close to those supplied by pooling tests, which focus on within-library variation. Conversely, when the between-library variation is much larger than the within-library variation, <italic>t</italic><sub><italic>w </italic></sub>gives results very similar to those of a two-sample t-test, which focuses on between-library variation. The <italic>t</italic><sub><italic>w </italic></sub>model also allows the relative contributions of the two types of variation to be assessed. Baggerly et al. [<xref ref-type="bibr" rid="B12">12</xref>] found that for high-count tags, between-library heterogeneity is the much larger source of variation and that pooling methods which do not allow for heterogeneity are biased towards finding high count tags to be significantly different. This can potentially lead to large fractions of false positives, as becomes apparent when the results for several different tags are plotted.</p></sec><sec><title>Extensions to multiple groups</title><p>While cases with more than two groups have been described in the literature [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B13">13</xref>-<xref ref-type="bibr" rid="B15">15</xref>], the means of analysis is currently something of a hybrid. Methods explicitly attacking the multi-library problem have been proposed [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>], but the most common approach at present [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B15">15</xref>] seems to involve coupling hierarchical clustering of the data with pairwise tests for differential expression [<xref ref-type="bibr" rid="B2">2</xref>] between one group and another. This hybrid approach can indirectly capture both types of variability, with the hierarchical clustering focused on the variation between proportions within a group, and the pairwise test focusing on sampling variation. Clustering has other benefits for clarifying thought apart from assessing differential expression, and we definitely recommend it for exploring the structure of the data. However, clustering tends not to provide a numerical summary, so combining the clustering results with those of the pairwise comparisons can be something of an art. An additional drawback is that the pairwise comparisons may miss useful information about variability by focusing only on a subset of the libraries available. For the purposes of assessing differential expression we believe more efficient tests are available.</p></sec><sec><title>Our approach: Overdispersed logistic regression</title><p>We seek to construct a method that takes the count nature of the data into account, deals with multiple groups simultaneously, and allows for variability in the proportions beyond that due to sampling alone. Fortunately, this is not the first time such a problem has arisen.</p><p>The problem of assessing differential expression for multiple groups corresponds to the classical statistical problem of the analysis of variance (ANOVA). When the values of interest are continuous (e.g., microarray log ratios), the test statistics become F-tests, higher-dimensional generalizations of the two-sample <italic>t</italic>-test. When the data are counts (SAGE data), and sampling variability needs to be dealt with, the ANOVA test can be adapted to give logistic or Poisson ANOVA. The multi-library test for differential expression proposed by Stekel et al. [<xref ref-type="bibr" rid="B17">17</xref>] corresponds to Poisson ANOVA, but without allowance for overdispersion. ANOVA deals with the extension from two to a larger number of distinct groups, but this can be viewed as a special case of the situation where the covariate information is continuous. One common way of modelling the dependence of proportions upon covariates is through logistic or Poisson regression, both of which are special cases of generalized linear models [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]. Such models incorporate the form of the sampling variability directly. For example, the logistic model for proportions,</p><p><inline-graphic xlink:href="1471-2105-5-144-i4.gif"/></p><p>defines both the function of the data that is to be modeled in terms of the covariates (the logit of the proportions) and the precision of each of the measurements. The maximum likelihood estimates of the parameters of this model can be found through iteratively reweighted least squares (IRLS).</p><p>Excess variation within a level, or overdispersion, can be introduced into a logistic regression framework in a number of ways. The most common and most widely implemented approach is to replace the binomial likelihood function being maximized above with a "quasi-likelihood" which differs from the initial formulation solely through the introduction of a scale term, <inline-graphic xlink:href="1471-2105-5-144-i5.gif"/>, into the variance equation, so that</p><p><italic>V</italic>(<italic>Y</italic><sub><italic>i</italic></sub>) = <italic>n</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub>(1 - <italic>p</italic><sub><italic>i</italic></sub>)<inline-graphic xlink:href="1471-2105-5-144-i5.gif"/>.</p><p>This approach has the advantage that it inflates the variance of each of the observations by a like amount, so that the estimated <inline-graphic xlink:href="1471-2105-5-144-i6.gif"/> values will be the same &#x02013; just the associated standard errors will be inflated. Logistic regression with quasi-likelihood overdispersion is implemented in a wide variety of statistical packages, including S-PLUS, R, GLIM, and SAS. Another method of introducing overdispersion is to assume a hierarchical model in which the proportions at a given level of the covariate are drawn from a nondegenerate distribution, and the distribution of the observed counts is binomial conditional on the value of the drawn proportion. When a beta distribution is assumed for the proportions, the final unconditional distribution of the observed counts is beta-binomial. This is the model suggested by Baggerly et al. [<xref ref-type="bibr" rid="B12">12</xref>] for modelling overdispersion in SAGE data, and is also the model used by Crowder [<xref ref-type="bibr" rid="B20">20</xref>] in generalizing ANOVA to deal with proportions subject to overdispersion. It can be shown (eg, Collett [<xref ref-type="bibr" rid="B18">18</xref>] p.201) that the variance of beta-binomial counts is of the form</p><p><italic>V</italic>(<italic>Y</italic><sub><italic>i</italic></sub>) = <italic>n</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub>(1 - <italic>p</italic><sub><italic>i</italic></sub>)[1 + (<italic>n</italic><sub><italic>i </italic></sub>- 1)<italic>&#x003c6;</italic>],</p><p>which is equivalent to the quasi-likelihood formulation when all of the library sizes <italic>n</italic><sub><italic>i </italic></sub>are the same. While approximate equality may suffice, even this assumption may be questionable for SAGE data, particularly if some of the libraries are drawn from experiments conducted at different times. Williams [<xref ref-type="bibr" rid="B21">21</xref>] shows how IRLS can be adapted to deal with this type of overdispersion, and notes that estimation involves <italic>&#x003c6; </italic>only and need not assume further structure from the beta distribution, making the procedure slightly more general. This form of overdispersion is implemented in R as part of the dispmod package.</p><p>In the logistic regression framework, assessing differential expression reduces to a case of deciding whether a set of regression coefficients is different from zero. This can lead to slightly different inferences than models such as <italic>t</italic>-statistics applied to the proportions, in that approximate normality is assumed to hold for the <italic>&#x003b2; </italic>values rather than the proportions themselves. When we have worked with a beta model for the <italic>p</italic><sub><italic>i</italic></sub>'s, we have been led to choices of parameters which yield quite skewed distributions, suggesting that the logit scale may be more appropriate. Working with the <italic>&#x003b2; </italic>values has the additional advantage that confidence intervals are naturally interpreted in terms of fold changes.</p></sec></sec><sec><title>Results</title><sec><title>Comparing two groups</title><p>We begin by comparing the counts of the tag ATTTGAGAAG in 8 colon libraries initially described in Zhang et al. [<xref ref-type="bibr" rid="B2">2</xref>]. These 8 libraries include two normal colon (NC1 and NC2), two primary tumors (TU98 and TU102) and four cell lines (CACO2, HCT116, RKO, and SW837). For now, we focus on comparing normal colon with all tumors, primary or cell line. Counts of the tag and the corresponding library sizes are given in Table <xref ref-type="table" rid="T2">2</xref>. A &#x003c7;<sup>2 </sup>test applied to the pooled counts from each of the two groups yields a test statistic of 444.27; the 95% cutoff for the null <inline-graphic xlink:href="1471-2105-5-144-i7.gif"/> distribution is 3.84, with values above this being deemed "significant". The two-sample <italic>t</italic>-test applied to the two groups of proportions yields 1.60; the 95% cutoffs for the null <italic>t</italic><sub>6 </sub>distribution are &#x000b1; 2.45, so this test suggests that the difference is not significant, showing the possibility of stark disagreements between tests focusing on different portions of the variability. The <italic>t</italic><sub><italic>w </italic></sub>statistic proposed by Baggerly et al. [<xref ref-type="bibr" rid="B12">12</xref>], which incorporates both types of variance, yields a test statistic of 1.60. The null distribution of this test statistic in this case is approximately a <italic>t</italic><sub>6 </sub>distribution, and the qualitative results are far closer to those of the <italic>t</italic>-test than those of the pooled tests, reflecting the relative dominance of patient heterogeneity in driving the total variation for this tag. We note in passing that this disagreement between the two types of tests is not an isolated incident. When we surveyed all of the tags in this group of libraries we found 10 tags with |<italic>t</italic>| &#x0003c; 2 and &#x003c7;<sup>2 </sup>&#x0003e; 200, and 48 tags with |<italic>t</italic>| &#x0003c; 2 and &#x003c7;<sup>2 </sup>&#x0003e; 50. In Baggerly et al. [<xref ref-type="bibr" rid="B12">12</xref>] it was found that most high-count tags appeared significantly different when a pooled test was used and not significant when a <italic>t</italic>-test was tried, and that in this case the <italic>t</italic>-test was more likely correct.</p><p>The results from three logistic regression model fits to the data are shown in Table <xref ref-type="table" rid="T3">3</xref>. In the first model there is no allowance for overdispersion, in the second the quasi-likelihood approach to overdispersion is employed, and in the third the hierarchical approach to overdispersion is used. Here, the values of the covariate <italic>X </italic>are 0 or 1 as the library is in the first or second group, respectively. In models 1 and 2, the fitted proportions are <inline-graphic xlink:href="1471-2105-5-144-i8.gif"/> = <italic>e</italic><sup>-4.66</sup>/(l + <italic>e</italic><sup>-4.66</sup>) = 0.94% and <inline-graphic xlink:href="1471-2105-5-144-i9.gif"/> = <italic>e</italic><sup>-4.66 - 0.89</sup>/(l + <italic>e</italic><sup>-4.66 - 0.89</sup>) = 0.39% for the first and second groups, respectively, and the proportions are only slightly altered in model 3. We note that the estimated coefficient values are exactly the same for the first two models, and this is true for these two approaches in general. Fitting the model with no allowance for overdispersion gives a <italic>z</italic>-value of <italic>&#x003b2;</italic><sub>1</sub>/<italic>s.e. </italic>(<italic>&#x003b2;</italic><sub>1</sub>) = -20.42, which is definitely significant. Note that the square of this value is of the same order as the value found by the &#x003c7;<sup>2 </sup>test. The Pearson residuals from this model, <inline-graphic xlink:href="1471-2105-5-144-i10.gif"/>, however, show a problem. If the model fits well, these should be approximately distributed as a standard normal, with extreme values from a set of 8 observations around 3 or 4 in magnitude. The actual values, -14.6 and 19.0, are far too extreme. When the model is fit with allowance made for overdispersion, the point estimate of the dispersion parameter is <inline-graphic xlink:href="1471-2105-5-144-i11.gif"/> = 187.57; this value should be close to 1 if there is no overdispersion. With this allowance made the <italic>t</italic>-value of -1.49 is no longer significant. This <italic>t</italic>-value can be found from the first <italic>z</italic>-value (-20.42) by dividing by <inline-graphic xlink:href="1471-2105-5-144-i12.gif"/> = 13.70. Similarly scaling the residuals yields values far more commensurate with a standard normal. We note that due to the differences in the models employed, the presumed distributions of the test statistics have changed. If we assume that the standard logistic model with no overdispersion holds, the test statistic has an approximately normal distribution. This is because the number of total successes is driving the binomial distributions to approximate normality. When we shift to a model where we presume the existence of overdispersion, the test statistic now has a <italic>t </italic>distribution. This is because our estimate of the variance is now strongly dependent on the precision with which we can estimate the overdispersion parameter, and this precision depends on the number of libraries, not the number of successes. Fitting this model with the hierarchical type of overdispersion, model 3 in Table <xref ref-type="table" rid="T3">3</xref>, yields slightly different answers but the size of <inline-graphic xlink:href="1471-2105-5-144-i13.gif"/> is still not significant. The difference in <inline-graphic xlink:href="1471-2105-5-144-i6.gif"/> values from those found before is due to the fact that in this model the amount of overdispersion attributed to each proportion changes slightly with library size, thus altering the weights used in the regression model. The point estimate for the hierarchical dispersion parameter <italic>&#x003c6; </italic>is <inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> = 3.399<italic>e </italic>- 03, so the multipliers for the binomial variances are</p><p>1 + ({<italic>n</italic><sub><italic>i</italic></sub>} - 1)<inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> =</p><p>(169.62, 165.78, 141.62, 190.32,</p><p>207.26, 190.12, 175.35, 208.84).</p><p>averaging these gives 181.11 which is close to the value found for the quasi-likelihood dispersion parameter. We note that the differences in coefficient values for models 2 and 3 are largely cosmetic, but the differences in significance between model 1 and the others are not. Choosing to account for overdispersion is more important than the precise model used to achieve this.</p><p>We note that the overdispersed logistic regression approaches give <italic>t</italic>-values about -1.49, whereas the two-sample <italic>t</italic>-test and the modified version <italic>t</italic><sub><italic>w </italic></sub>suggested by Baggerly et al. [<xref ref-type="bibr" rid="B12">12</xref>] both give <italic>t</italic>-values of about -1.6 (as noted earlier, agreement between <italic>t </italic>and <italic>t</italic><sub><italic>w </italic></sub>suggests that for this tag, the between-library variation is much larger than the within-library variation). There are two reasons for this difference. First, the <italic>t </italic>statistic works on the proportion scale, and logistic regression works on the <italic>&#x003b2; </italic>scale, which is roughly the log proportion scale. Second, the <italic>t</italic><sub><italic>w </italic></sub>statistic used here,</p><p><inline-graphic xlink:href="1471-2105-5-144-i15.gif"/></p><p>does not assume that the overdispersion factor is the same in the two groups being compared; the variance estimate is not pooled. The latter difference is actually the more important for this contrast, particularly as the variance estimate from the first group of size 2 is very unstable. This effect is not always subtle; if we consider instead the tag GCGAAACCCT, with counts given in Table <xref ref-type="table" rid="T2">2</xref>, the two-sample <italic>t </italic>test and the weighted <italic>t</italic><sub><italic>w </italic></sub>test both give -1.57, and the logistic regression <italic>t </italic>value is -4.16.</p><p>Of the two answers, we tend to prefer the one given by the logistic regression fit, for two reasons. First, when we have fit the parameters of the beta distributions for the proportions directly, we have found the distributions to be quite skewed. As such we find it better to assume rough normality on the <italic>&#x003b2; </italic>coefficient scale. Second, when the number of libraries in a group is quite small, which will often be the case with SAGE data, we prefer the pooled estimate of the variance. This preference is due in large part to its greater stability through the use of more degrees of freedom. It is possible to explicitly incorporate levels of overdispersion that change with the covariates in logistic regression, but we have not pursued this here.</p></sec><sec><title>Comparing three or more groups</title><p>Above, we treated the colon libraries as if they came from two groups, but it is more natural to view them as coming from three: normal samples, primary tumors, and cell lines. When we have data from multiple groups, there are two different ways in which this changes the nature of the problem. First, if we are only interested in comparing two of the groups, it is often nonetheless worthwhile to incorporate the data from the other groups into the model. The reason for this is that when overdispersion is driving the variance, the significance of our results depends strongly on the precision with which we can estimate the overdispersion parameter. The libraries in the groups not directly involved in the comparison of interest can still supply information about the overdispersion parameter and increase the degrees of freedom of the associated t-test. Second, by examining the fitted proportions for all groups, the relative sizes of the transitions can be assessed.</p><p>We begin by looking at the results for a single tag flagged as interesting in the paper by Zhang et al. [<xref ref-type="bibr" rid="B2">2</xref>], namely TGCTGCCTGT, where we presume that the contrast of most interest is between normal colon and primary tumors. The counts for this tag and the corresponding library sizes are given in Table <xref ref-type="table" rid="T2">2</xref>.</p><p>We first attempt to compare the levels in normal colon and primary tumor while ignoring the cell lines (ie, using just four libraries), and then using a model incorporating all three groups. The results using logistic regression with hierarchical overdispersion are shown in Table <xref ref-type="table" rid="T4">4</xref>.</p><p>In the model with only two groups, we have a single covariate vector <italic>x</italic><sub>1 </sub>= (0,0,1,1) denoting which of the two groups the library belongs to. This model produces an overdispersion estimate of <inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> = 8.938<italic>e </italic>- 05, for inflation factors of</p><p>1 + ({<italic>n</italic><sub><italic>i</italic></sub>} - 1)<inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> = (5.43, 5.33, 4.70, 5.98).</p><p>The fact that these factors are significantly larger than one suggests that the within-group heterogeneity is the dominant component of the variance not explained by the model. In the model with three groups, we cannot use a single covariate vector <italic>x</italic><sub>1</sub>, as this is not suited to indicating 3 or more groups in an unordered fashion (using 0, 1, and 2 for the three groups respectively would force an ordering by saying that primary tumors are intermediate betwixt normal samples and cell lines). In general, if we have <italic>k </italic>groups, we need to use <italic>k </italic>- 1 covariate vectors. Here, we use <italic>x</italic><sub>1 </sub>= (0, 0, 1, 1, 0, 0, 0, 0) and <italic>x</italic><sub>2 </sub>= (0, 0, 0, 0, 1, 1, 1, 1). The set of all 0s (<italic>x</italic><sub>1 </sub>= 0, <italic>x</italic><sub>2 </sub>= 0) corresponds to the first group, here normal colon, and the other groups are defined by which one of the other covariates is nonzero: Group 2 (primaries), (<italic>x</italic><sub>1 </sub>= 1, <italic>x</italic><sub>2 </sub>= 0), Group 3 (cell lines), (<italic>x</italic><sub>1 </sub>= 0, <italic>x</italic><sub>2 </sub>= 1) As we are still focused on the difference between normal colon and primary tumors, for which the logit values are <italic>&#x003b2;</italic><sub>0 </sub>and <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1 </sub>respectively, the main interest remains on whether <italic>&#x003b2;</italic><sub>1 </sub>is significantly different from zero, and the predicted logit for the cell line group, <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>2</sub>, does not enter the problem directly. Fitting this model produces an overdispersion estimate of <inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> = 1.160<italic>e </italic>- 04, for inflation factors of</p><p>1 + ({<italic>n</italic><sub><italic>i</italic></sub>} - 1)<inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> =</p><p>(6.76, 6.62, 5.80, 7.46,</p><p>8.04, 7.45, 6.95, 8.09).</p><p>In neither case (considering two groups or three) does the contrast between normal colon and primary tumor, represented as the magnitude of <inline-graphic xlink:href="1471-2105-5-144-i13.gif"/>, appear significant once allowance is made for overdispersion, but there is an interesting point to note. Even though the point estimate of overdispersion increases when the cell lines are included, and the value of the <italic>t</italic>-statistic (<inline-graphic xlink:href="1471-2105-5-144-i13.gif"/>/<italic>s.e</italic>(<inline-graphic xlink:href="1471-2105-5-144-i13.gif"/>)) associated with the difference declines, the associated p-value indicates an increase in significance. Without using the cell lines, we have just 4 libraries, and after estimating the mean proportions in each group just 2 degrees of freedom for estimating <italic>&#x003c6;</italic>. When we use the cell lines, we have 8 libraries and 5 degrees of freedom for estimating <italic>&#x003c6;</italic>. Thus, the degrees of freedom in the <italic>t</italic>-tests shift from 2 to 5. The <italic>t</italic><sub>2 </sub>distribution has very wide cutoffs, and the <italic>t</italic><sub>5 </sub>is much closer to normal. In general, the inclusion of related groups can improve estimation by increasing the precision of our estimate of overdispersion.</p><p>In fitting the model with three groups, of course, we have also gained the ability to look at other contrasts. For example, we can look at normal colon versus cell lines, for which the logits are <italic>&#x003b2;</italic><sub>0 </sub>and <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>2 </sub>respectively, by checking the significance of <inline-graphic xlink:href="1471-2105-5-144-i16.gif"/>. Likewise, we can look at the difference between primary tumors and cell lines, for which the logits are <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1 </sub>and <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>2 </sub>,by testing the significance of the difference <inline-graphic xlink:href="1471-2105-5-144-i17.gif"/>. While this significance is not listed in the table directly, we can compute the standard error of this contrast, <italic>s.e. </italic><inline-graphic xlink:href="1471-2105-5-144-i18.gif"/>, divide the estimate by its standard error to get a t-statistic with the degrees of freedom listed (here 5), and compute a p-value accordingly.</p><p>It is also possible to perform an omnibus test of whether there exists any significant difference among the groups, which is logistic ANOVA for proportions. The regular ANOVA test looks at the amount of variance explained by the terms of interest in the model and compares this to the amount of residual variance. Adjusting for the degrees of freedom in each group gives an <italic>F</italic>-test. When dealing with generalized linear models, the quantity -2 * log (likelihood ratio), known as the deviance, plays a role analogous to the variance in ANOVA and thus we can speak of the analysis of deviance. The analysis of deviance is complicated by the inclusion of overdispersion in the model, requiring a multi-step approach in which several different models are fit in succession. These models are listed in Table <xref ref-type="table" rid="T5">5</xref>. First, the model is fit using all available covariates and the overdispersion parameter is estimated. Here, the available covariates are <italic>x</italic><sub>1 </sub>and <italic>x</italic><sub>2</sub>, and fitting the full model with both present, <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1 </sub>+ <italic>&#x003b2;</italic><sub>2</sub>, gives <inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> = 1.160<italic>e </italic>- 04 as noted above. Second, submodels are fit with the value for overdispersion fed in as fixed. In this case, the submodels are <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>2</sub>, using <italic>x</italic><sub>2 </sub>as the only covariate, <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1</sub>, using <italic>x</italic><sub>1 </sub>as the only covariate, and <italic>&#x003b2;</italic><sub>0</sub>, using no covariates and simply fitting a single proportion to all of the data. The results are shown in Table <xref ref-type="table" rid="T5">5</xref>, from which the significance of a given model can be assessed by comparing the scaled reduction in deviance with the scaled residual deviance to the appropriate <italic>F </italic>distribution. Here, for example, testing whether the overall model including <italic>&#x003b2;</italic><sub>1 </sub>and <italic>&#x003b2;</italic><sub>2 </sub>explains things significantly better than just fitting the same proportion throughout (<italic>&#x003b2;</italic><sub>0</sub>) reduces to</p><p><inline-graphic xlink:href="1471-2105-5-144-i19.gif"/></p><p>indicating that the overall difference between groups is not significant at the 5% level. It may be noted that the submodel including just <italic>&#x003b2;</italic><sub>1 </sub>in addition to the constant appears to explain very little; this is due to the way in which we have chosen the entries of <italic>X</italic>, so that including <italic>&#x003b2;</italic><sub>1 </sub>isolates the effect of the primary tumor group, but excluding <italic>&#x003b2;</italic><sub>2 </sub>still combines the normal colon group with the cell line group for the contrast. This latter grouping blurs the normal colon vs primary tumor distinction found to be a bit larger earlier.</p></sec><sec><title>Incorporating other covariates</title><p>It is possible to use the logistic regression approach to partition the variance amongst multiple effects of interest. For example, in the above section we considered a case with colon libraries taken from both primary tumors and cell lines. Such data is also available for other organs, eg pancreas. If we are interested in identifying consistent differences between primary tumors and cell lines, it would be natural to use libraries from both organ types. However, if these were then compared as two groups, primary vs cell lines, the differences would be difficult to isolate due to the large differences between tissue types within both the primary and cell line groups. The solution is to fit a model with two covariates, with <italic>x</italic><sub>1 </sub>being 0 or 1 as the sample is colon or pancreatic, respectively, and <italic>x</italic><sub>2 </sub>being 0 or 1 as the sample is a primary tumor or a cell line, respectively. Inference reduces to testing the significance of <italic>&#x003b2;</italic><sub>2</sub>, with the scale of natural variation being assessed only after the effects of the change in tissue type, <italic>&#x003b2;</italic><sub>1</sub>, have been factored out.</p><p>In the above example, we allowed for the effect of one other effect, tissue type. In principle, multiple factors can be allowed for through the inclusion of other covariates. Likewise, though the two covariates in the above example were both "factors" having a finite number of unordered levels, it is possible to include continuous covariates in the modelling process as well.</p><p>To illustrate this, we give two hypothetical examples using the counts for the GCGAAACCCT tag from Table <xref ref-type="table" rid="T2">2</xref>. In the first example, we posit that we are trying to assess the differences between normal tissue and primary tumors, that the first 4 libraries come from normal colon and primary tumors as indicated, and that the remaining 4 libraries come not from cell lines but rather from normal tissue (libraries 5 and 6) and primary tumor (libraries 7 and 8) from some other organ. As noted above, this leads to a scenario where we want to fit a model with two covariates: <italic>x</italic><sub>1 </sub>= (0, 0, 1, 1, 0, 0, 1, 1), indicating whether the library is normal (0) or primary tumor (1), and <italic>x</italic><sub>2 </sub>= (0, 0, 0, 0, 1, 1, 1, 1), indicating the organ from which the library was derived. In the second example, we posit that in addition to the above information, we have access to the levels of a biomarker potentially predictive of survival. These levels are supplied as the values of a third covariate vector, <italic>x</italic><sub>3 </sub>= (0.89, 0.35, 0.66, 0.23, 0.30, 0.54, 0.90, 0.90). The values for <italic>x</italic><sub>3 </sub>were generated as random draws from a uniform distribution. In terms of fitting the models, the mechanics are similar to those presented earlier. The model fits are presented in Table <xref ref-type="table" rid="T6">6</xref>.</p></sec><sec><title>When logistic regression breaks</title><p>The logistic regression fitting procedure can break down, or exhibit lack of convergence. Typically this means that all of the proportions in one of the groups are zero or one; only the former is realistic in the context of SAGE data. This is natural, in that the maximum likelihood point estimate for the group proportion is 0, and inference for <italic>&#x003b2; </italic>involves the fold change to the proportion in the second group, leading to division by zero. When the proportions are this small, the binomial variability dominates the heterogeneity and the values are completely noninformative with respect to the estimation of overdispersion.</p><p>We propose a fix that is iterative in nature in that it requires the logistic fitting routine to be run three times. To illustrate this procedure, we will use the data from tag ATTTGAGAAG in Table <xref ref-type="table" rid="T2">2</xref>, with the first two tag counts, those from group 1, set to zero.</p><p>The first run of the fitting procedure serves to estimate the overdispersion parameter. This fit uses just the groups that have nonzero counts, omitting the problematic group(s). Here, this involves fitting a single proportion to the six libraries in group 2. The fitted proportion is 0.40%, and the overdispersion estimate is <inline-graphic xlink:href="1471-2105-5-144-i14.gif"/> = 3.71<italic>e </italic>- 03.</p><p>The second run of the fitting procedure takes the overdispersion parameter as given, and fits the data after replacing the zero proportions in a group with the same small nonzero proportion, giving us a hopefully conservative estimate of the fold change. This type of replacement is commonly used, and is most often justified via the assumption of a vague prior distribution for the proportions, with the point estimate being derived as the posterior mean or mode. A common assumption for a prior in dealing with proportions is the uniform distribution. The posterior mean after 0 successes are observed out of <italic>n</italic><sub><italic>i </italic></sub>trials is 1/(<italic>n</italic><sub><italic>i </italic></sub>+ 1); with multiple trials, it is 1/((&#x02211;<italic>n</italic><sub><italic>i</italic></sub>) + 1). This is the value we use. This value is actually quite conservative here, for two reasons. First, the uniform distribution places far too much chance on the possibility of proportions greater than a few percent, which will never be observed with SAGE data. Restricting the distribution to be uniform over the range [0, 0.02] should be more than adequate. Second, the presence of overdispersion means that pooling the samples underemphasizes the evidence of a small proportion being supplied by the zero variance of the observed proportions. While we could pursue a more optimal proportion, we choose in this case to simply use the simplistic bound noted above. Here, as the library sizes in the first group are 49610 and 48479, the proportion is 1/(49610 + 48479) and the faked counts are 0.506 = 49610/(49610 + 48479) and 0.494, respectively. Some reformatted results from this fit are shown in Table <xref ref-type="table" rid="T7">7</xref> (Model 1).</p><p>The results for this fit are ridiculously "insignificant". The problem lies in the fact that the use of a <italic>t</italic>-value (a Wald test) relies on the approximate normality of the likelihood function in the vicinity of the maximum, and this shape assumption breaks down severely if the number of counts in one group is small. Tests based on changes in the scaled deviance, corresponding to likelihood ratio tests, are better.</p><p>The third run of the fitting procedure fits a simpler submodel, in this case a single proportion for all eight libraries, using the same overdispersion estimate so as to measure the change in deviance. The results of this fit are shown in Table <xref ref-type="table" rid="T7">7</xref> (Model 2). The analysis of deviance test for significance gives</p><p><inline-graphic xlink:href="1471-2105-5-144-i20.gif"/></p><p>Here, we cannot conclude (given the level of overdispersion) that the difference is real. Note that the degrees of freedom used in the denominator is 5; this follows from the fact that only 6 libraries were used to estimate the overdispersion parameter, and one of those 6 degrees of freedom was needed to estimate the proportion.</p><p>In general, when any of the groups has very small counts, checking the change in deviance is a good idea.</p></sec></sec><sec><title>Discussion</title><p>Logistic regression with overdispersion addresses three issues with SAGE data: simultaneously modelling multiple types of variance, dealing with multiple groups at once, and allowing for the incorporation of covariates. This procedure is widely implemented in available software. Further, and most importantly, viewing SAGE data in the logistic regression setting supplies the framework for thinking of models that describe such data.</p><p>Dealing with multiple types of variance yields significance estimates we believe to be superior to those derived from pooled counts or from <italic>t</italic>-tests. The regression setting carries with it other benefits, such as a well-developed body of work regarding model checking, residual analysis, and detection of outliers. For example, the influence of any given library tag count on the overall analysis can be assessed, and methods can be made more robust by bounding these functions so that no single library drives the results.</p><p>There are some areas in which we can identify difficulties and see room for improvement.</p><p>First, the model that we are using for the error may be improved. For SAGE data, the proportion associated with a specific tag is rarely on the order of a percent, so</p><p>logit(<italic>p</italic><sub><italic>i</italic></sub>) &#x02248; log(<italic>p</italic><sub><italic>i</italic></sub>)</p><p>and we can speak of working with the log rather than the logit transform if we prefer. Assuming variance stability on the log scale then leads to the lognormal distribution often assumed in dealing with microarray data. Assuming a lognormal distribution is equivalent to introducing overdispersion in yet another way, namely as a random effect acting on the <italic>&#x003b2; </italic>scale. Here, the true proportion for library <italic>i </italic>is of the form</p><p>logit(<italic>p</italic><sub><italic>i</italic></sub>) = <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1</sub><italic>x</italic><sub><italic>i </italic></sub>+ <italic>&#x003b5;</italic><sub><italic>i</italic></sub>,</p><p>where <italic>&#x003b5;</italic><sub><italic>i </italic></sub>is a normal random variable with mean 0 and variance <inline-graphic xlink:href="1471-2105-5-144-i21.gif"/>. The model described here is a special case of a generalized linear mixed model (GLMM), where "mixed" refers to the fact that we have both fixed effects of interest, the changes with the covariates, and random shocks whose variance needs to be estimated and allowed for. Williams [<xref ref-type="bibr" rid="B21">21</xref>] suggests how this model might be fit using a Taylor-series type expansion, again invoking IRLS. However, as noted in Collett [<xref ref-type="bibr" rid="B18">18</xref>], p.272, "This approach is not entirely satisfactory for fitting such models to binary data, since the estimates can be biased in certain circumstances. Moreover, the deviance calculated for such models is often very approximate and cannot be recommended for general use in comparing alternative models." There are maximum-likelihood based approaches for fitting GLMMs available in SAS and S-PLUS, but there are known problems with fitting mixed effects models to binary data with small numbers of clusters or libraries. One way of addressing this issue more precisely is via simulation (for example via BUGS [<xref ref-type="bibr" rid="B22">22</xref>]). We are exploring these different error models now.</p><p>Second, the approach developed above works on one tag at a time. In doing so, it is not exploiting to the fullest the unique features of SAGE data. Examples of such exploitation include correcting for sequencing errors by looking at neighbors where sequence similarity is used to define a neighborhood network, and borrowing strength across genes by using common estimation of parameters such as <italic>&#x003c6; </italic>over like groups. Work on these issues is ongoing (eg, Colinge and Feger [<xref ref-type="bibr" rid="B23">23</xref>], N. Blades (2002), unpublished dissertation, Johns Hopkins) and we think these features could be usefully combined with the approach presented here.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Data</title><p>The data used here were initially described in Zhang et al. [<xref ref-type="bibr" rid="B2">2</xref>]. The actual numerical libraries used were downloaded from the <bold>SAGE Genie </bold>web resource introduced by Boon et al. [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. These libraries have had the linker tags removed.</p></sec><sec><title>Overdispersed logistic regression</title><p>Only a cursory description of the approach is given here; more detailed treatments are given in Collett [<xref ref-type="bibr" rid="B18">18</xref>] and McCullagh and Nelder [<xref ref-type="bibr" rid="B19">19</xref>], among others.</p><p>We want to fit the observed proportions, <italic>p</italic><sub><italic>i </italic></sub>= <italic>Y</italic><sub><italic>i</italic></sub>/<italic>n</italic><sub><italic>i</italic></sub>, as a function of the covariates <italic>X</italic><sub><italic>i</italic></sub>. The first step in this process is to specify what form the relationship will take. If the relationship is linear, so that <italic>p</italic><sub><italic>i </italic></sub>= <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1</sub><italic>X</italic><sub><italic>i </italic></sub>+ <italic>&#x003b5;</italic>, then we can potentially get fitted proportions outside of the interval [0,1], so we typically choose to fit a transformed version of the <italic>p</italic><sub><italic>i</italic></sub>s as being linear in the covariates. A common choice for proportions is the logistic transformation, <italic>logit</italic>(<italic>p</italic><sub><italic>i</italic></sub>) = <italic>log</italic>(<italic>p</italic><sub><italic>i</italic></sub>/1 - <italic>p</italic><sub><italic>i</italic></sub>) = <italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1</sub><italic>X</italic><sub><italic>i </italic></sub>+ <italic>&#x003b5;</italic>. This particular choice is suggested by the form of the likelihood function for binomial data (see McCullagh and Nelder [<xref ref-type="bibr" rid="B19">19</xref>], p.28&#x02013;32), and we shall take it as assumed here, save to note that while the logit can range over all real values, the corresponding proportions are all between 0 and 1. At this point we are fitting a straight line to a transformed version of the data; this is akin to standard linear regression which is fit by minimizing the sum of squared deviations between the observations and their fitted values: the method of least squares. Now, the default assumption in least squares is that all of the observations are known with equal precision, and hence receive equal weight. This is not the case here, as the variance of a proportion is <italic>V</italic>(<italic>p</italic><sub><italic>i</italic></sub>) = <italic>p</italic><sub><italic>i</italic></sub>(1 - <italic>p</italic><sub><italic>i</italic></sub>)/<italic>n</italic><sub><italic>i</italic></sub>, so that the precision with which an observation is known depends on both the value of that observation and on the size of the total <italic>n</italic><sub><italic>i </italic></sub>from which the proportion was derived. In the case where the observations are known with differing precisions, then the standard adjustment is to fit a weighted version of least squares, minimizing a weighted sum of the squared differences between the observations and their fitted values, where the weights are inversely proportional to the variances of the observations. Thus, at the first step we fit a logistic curve using weighted least squares where the weights are inversely proportional to the variances associated with our initial estimates of the proportions, (<italic>Y</italic><sub><italic>i </italic></sub>+ 0.5)/(<italic>n</italic><sub><italic>i </italic></sub>+ 1). After this first fit, we now have predicted values for each of the observations, and these predicted values in turn suggest new values for the variances and hence the weights. Thus, the second step is to refit the data using the new weights. This process is iterated (iteratively reweighted least squares, IRLS) until the changes in the predicted values from one fit to the next are small enough that the procedure is said to have converged.</p><p>Even after the process has converged, it is often the case that the sizes of the squared deviations will be substantially larger than might be expected if the variances were of exactly the form given above. In this case, the data are said to exhibit overdispersion relative to the postulated model, and we seek to estimate the scale of the overdispersion. We deal with the quasi-likelihood case of overdispersion here, where the variance is really of the form <italic>V</italic>(<italic>p</italic><sub><italic>i</italic></sub>) = <italic>n</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub>(l - <italic>p</italic><sub><italic>i</italic></sub>)<inline-graphic xlink:href="1471-2105-5-144-i5.gif"/>, for <inline-graphic xlink:href="1471-2105-5-144-i5.gif"/> &#x0003e; 1. The added mechanics for computing the hierarchical form are somewhat involved and we refer the reader to Williams [<xref ref-type="bibr" rid="B21">21</xref>] for details. Using the quasi-likelihood model for overdispersion, the actual parameters of the best fitting model will not change, as the weights used in the weighted least squares routine are all proportional to the inverses of the variances, and scaling all of the variances by the same factor leaves the relative sizes of the weights unchanged. What does change is the presumed precision associated with these parameters; the variances of the parameters will likewise be multiplied by <inline-graphic xlink:href="1471-2105-5-144-i5.gif"/>, and significance tests need to be adjusted accordingly. In order to estimate <inline-graphic xlink:href="1471-2105-5-144-i5.gif"/>, we return to the weighted squared deviations between observations and predictions noted above. Ideally, the sum of the squared weighted residuals will have a chi-squared distribution with <italic>k </italic>- <italic>p </italic>degrees of freedom, where <italic>k </italic>is the total number of libraries and <italic>p </italic>is the number of <italic>&#x003b2; </italic>terms being estimated. As the mean of a chi-squared distribution is equal to its degrees of freedom, we get our initial estimate of <inline-graphic xlink:href="1471-2105-5-144-i5.gif"/> by dividing the sum of squared weighted residuals by the posited degrees of freedom:</p><p><inline-graphic xlink:href="1471-2105-5-144-i22.gif"/></p><p>Given the estimated value of <inline-graphic xlink:href="1471-2105-5-144-i5.gif"/>, the test statistics are scaled by <inline-graphic xlink:href="1471-2105-5-144-i12.gif"/> and the significances recomputed. In the cases below, we outline the procedure and couple the descriptions with scripts for the freeware package <italic>R</italic>. In each case, the approach begins by loading the data corresponding to the tag counts <italic>Y</italic><sub><italic>i </italic></sub>and the library sizes <italic>n</italic><sub><italic>i</italic></sub>, which are used to supply the observed proportions. The main distinction between the cases resides in how the covariate <italic>X </italic>values are defined. All of the models assume the presence of a constant vector <italic>X</italic><sub>0 </sub>of all ones; this produces the corresponding estimate for <italic>&#x003b2;</italic><sub>0</sub>. Our discussion will likewise treat this covariate as present in all modelling steps.</p></sec><sec><title>Annotated R code</title><p># Source code for models used in the paper</p><p># "Overdispersed Logistic Regression for</p><p># SAGE: Modelling Multiple Groups and</p><p># Covariates", by Baggerly et al.</p><p>##########################################</p><p># First, we deal with the case of two</p><p># groups, and introduce the methods for</p><p># fitting the logistic regression models.</p><p>##########################################</p><p>if(0){</p><p># Load the tag counts for ATTTGAGAAG (y)</p><p># from the 8 libraries in Zhang et al.</p><p># [<xref ref-type="bibr" rid="B2">2</xref>], the associated library sizes (n)</p><p># and the covariate vector indicating</p><p># which of two groups the librares</p><p># belong to, normal or cancer (x).</p><p>y &#x0003c;- c(320, 600, 312, 549,</p><p>246, 65, 41, 52);</p><p>n &#x0003c;- c(49610, 48479, 41371, 55700,</p><p>60682, 55641, 51294, 61148);</p><p>x &#x0003c;- c(0, 0, 1, 1, 1, 1, 1, 1);</p><p># Now fit a standard logistic regression</p><p># model to the data, with no allowance</p><p># for overdispersion. This is done</p><p># through a call to the generalized</p><p># linear model (glm) routine. help(glm)</p><p># provides more information about the</p><p># nature of the arguments here.</p><p>fit1 &#x0003c;- glm(cbind(y, n-y) ~x,</p><p>family=binomial);</p><p># check the results</p><p>summary(fit1);</p><p># Next, we refit the model while</p><p># allowing for overdispersion of the</p><p># quasilikelihood type; all variances</p><p># are inflated by a common factor. This</p><p># call differs from the first only in</p><p># the definition of the glm "family" to</p><p># be used.</p><p>fit2 &#x0003c;- glm(cbind(y, n-y) ~x,</p><p>family=quasibinomial);</p><p># check the results</p><p>summary(fit2);</p><p># Ideally, the sum of the squared</p><p># Pearson residuals should have a chi-</p><p># squared distribution, with mean equal</p><p># to its degrees of freedom. Dividing</p><p># the sum by the degrees of freedom</p><p># gives our initial estimate of the</p><p># overdispersion parameter.</p><p>varQL &#x0003c;- sum(residuals(fit2,</p><p>"pearson")^2)/fit2$df.residual;</p><p># Finally, we refit the model using the</p><p># overdispersion method suggested by</p><p># Williams [<xref ref-type="bibr" rid="B21">21</xref>], where the variances are</p><p># inflated by factors that are slightly</p><p># different depending on the underlying</p><p># library sizes. This routine is</p><p># implemented in the R package "dispmod"</p><p># which is available at</p><p># <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org"/></p><p>library("dispmod");</p><p>fit3 &#x0003c;- glm.binomial.disp(fit1);</p><p># check the results</p><p>summary(fit3);</p><p>phi &#x0003c;- fit3$dispersion;</p><p># Note that the reported p-values from</p><p># this fit are incorrect. This is due to</p><p># the assumption that the test-stats</p><p># have normal distributions, even though</p><p># we have had to estimate the</p><p># overdispersion parameter. When we have</p><p># to perform this estimation, the</p><p># correct test is a t-test, with a</p><p># number of degrees of freedom</p><p># corresponding to the number of</p><p># libraries less the number of estimated</p><p># parameters. As the number of libraries</p><p># is typically not large, this can</p><p># create a large difference.</p><p>sumfit3 &#x0003c;- summary(fit3);</p><p>t.values &#x0003c;- summary(</p><p>fit3)$coefficients [,"z value"];</p><p>p.values &#x0003c;- 2 * pt(-abs(t.values),</p><p>fit3$df.residual);</p><p>}</p><p>##########################################</p><p># Next, we deal with three groups</p><p>##########################################</p><p>if(0){</p><p># We begin by focusing on gains</p><p># available when multiple groups are</p><p># present, even if the other groups are</p><p># not directly part of the contrast of</p><p># interest, due to the additional</p><p># information that the added groups can</p><p># provide about the scale of the</p><p># overdispersion.</p><p># Here, we use the data from the tag</p><p># TGCTGCCTGT, and this time we note that</p><p># there are 3 groups of libraries:</p><p># normals (libraries 1&#x02013;2), primary</p><p># tumors (libraries 3&#x02013;4), and cell lines</p><p># (libraries 5&#x02013;8). If we are interested</p><p># in the contrast between normals and</p><p># primary tumors, we can fit this using</p><p># only the data from those two groups,</p><p># or using the data from all three.</p><p># First, fit the model as if there were</p><p># just two groups present.</p><p>y &#x0003c;- c(0, 1, 1, 15);</p><p>n &#x0003c;- c(49610, 48479, 41371, 55700);</p><p>x &#x0003c;- c(0, 0, 1, 1);</p><p>fit1 &#x0003c;- glm(cbind(y, n-y) ~x,</p><p>family=binomial);</p><p>fit2 &#x0003c;- glm.binomial.disp(fit1);</p><p># get the correct p-values</p><p>fit2.t.values &#x0003c;- summary(</p><p>fit2)$coefficients [,"z value"];</p><p>fit2.p.values &#x0003c;- 2 * pt(-abs(</p><p>fit2.t.values), fit2$df.residual);</p><p># Next, fit the model assuming that</p><p># there are three groups. In this case,</p><p># we cannot use a single covariate</p><p># vector x, as this is not suited to</p><p># indicating 3 or more groups in an</p><p># unordered fashion (using 0, 1, and 2</p><p># for the three groups respectively</p><p># would force an ordering by saying that</p><p># primary tumors are intermediate</p><p># betwixt normal samples and cell lines)</p><p># In general, if we have k groups, we</p><p># need to use k-1 covariate vectors.</p><p># Here, we use</p><p># x1 &#x0003c;- c(0, 0, 1, 1, 0, 0, 0, 0);</p><p># x2 &#x0003c;- c(0, 0, 0, 0, 1, 1, 1, 1);</p><p># The set of all 0s (x1 = 0, x2 = 0)</p><p># corresponds to the first group, here</p><p># the normals, and the other groups are</p><p># defined by which one of the other</p><p># covariates is nonzero:</p><p># Group 2 (primaries), (x1 = 1, x2 = 0),</p><p># Group 3 (cell lines), (x1 = 0, x2 = 1)</p><p>y &#x0003c;- c(0, 1, 1, 15, 9, 1, 12, 27);</p><p>n &#x0003c;- c(49610, 48479, 41371, 55700,</p><p>60682, 55641, 51294, 61148);</p><p>x1 &#x0003c;- c(0, 0, 1, 1, 0, 0, 0, 0);</p><p>x2 &#x0003c;- c(0, 0, 0, 0, 1, 1, 1, 1);</p><p>fit3 &#x0003c;- glm(cbind(y, n-y) ~x1 + x2,</p><p>family=binomial);</p><p>fit4 &#x0003c;- glm.binomial.disp(fit3);</p><p># get the correct p-values</p><p>fit4.t.values &#x0003c;- summary(</p><p>fit4)$coefficients [,"z value"];</p><p>fit4.p.values &#x0003c;- 2*pt(-abs(</p><p>fit4.t.values), fit4$df.residual);</p><p># The above approach has fit the model</p><p># with all of the covariates available,</p><p># but in order to perform an analysis of</p><p># deviance we want to fit various</p><p># submodels using the same estimate of</p><p># overdispersion as found here. In this</p><p># case, there are 3 submodels:</p><p>fit5 &#x0003c;- glm(cbind(y, n-y) ~x1,</p><p>family=binomial,</p><p>weights = fit4$disp.weights);</p><p>fit6 &#x0003c;- glm(cbind(y, n-y) ~x2,</p><p>family=binomial,</p><p>weights = fit4$disp.weights);</p><p>fit7 &#x0003c;- glm(cbind(y, n-y) ~1,</p><p>family=binomial,</p><p>weights = fit4$disp.weights);</p><p># alternatively, the anova function can</p><p># be used, but this only considers the</p><p># submodels obtained by adding terms</p><p># sequentially. Thus, we get the</p><p># deviances for beta_0 (the null model),</p><p># beta_0 + beta_1 (adding the x1</p><p># covariate only), and beta_0 + beta_1 +</p><p># beta_2 (adding the x2 covariate to</p><p># what we already have.</p><p>fit4.anodev &#x0003c;- anova(fit4);</p><p>}</p><p>##########################################</p><p># Next, we deal with the case of other</p><p># covariates, possibly continuous.</p><p>##########################################</p><p>if(0){</p><p># Here, we are using the counts from the</p><p># GCGAAACCCT tag, but we are treating</p><p># the 8 libraries as coming from tissue</p><p># type 1 (libraries 1&#x02013;4) and tissue type</p><p># 2 (libraries 5&#x02013;8), with normal tissue</p><p># of both types (libraries 1&#x02013;2, 5&#x02013;6) and</p><p># primary tumor of both types (libraries</p><p># 3&#x02013;4, 7&#x02013;8). In this hypothetical</p><p># example, we are able to partition the</p><p># changes into effects associated with</p><p># normal/primary differences (x1) or</p><p># tissue 1/tissue 2 differences (x2).</p><p>y &#x0003c;- c(167, 566, 64, 98, 33, 47, 40, 27);</p><p>n &#x0003c;- c(49610, 48479, 41371, 55700,</p><p>60682, 55641, 51294, 61148);</p><p>x1 &#x0003c;- c(0, 0, 1, 1, 0, 0, 1, 1);</p><p>x2 &#x0003c;- c(0, 0, 0, 0, 1, 1, 1, 1);</p><p>fit1 &#x0003c;- glm(cbind(y, n-y) ~x1 + x2,</p><p>family=binomial);</p><p>fit2 &#x0003c;- glm.binomial.disp(fit1);</p><p># get the correct p-values</p><p>fit2.t.values &#x0003c;- summary(</p><p>fit2)$coefficients [,"z value"];</p><p>fit2.p.values &#x0003c;- 2*pt(-abs(</p><p>fit2.t.values), fit2$df.residual);</p><p># Next, again using the tag as above, we</p><p># posit that we also have access to the</p><p># levels of a biomarker potentially</p><p># predictive of survival, supplied as</p><p># the levels of another covariate x3.</p><p># The values supplied here were</p><p># generated as random draws from a</p><p># uniform (0,1) distribution</p><p>x3 &#x0003c;- c(0.89, 0.35, 0.66, 0.23,</p><p>0.30, 0.54, 0.90, 0.90);</p><p>fit3 &#x0003c;- glm(cbind(y, n-y) ~x1 + x2 + x3,</p><p>family=binomial);</p><p>fit4 &#x0003c;- glm.binomial.disp(fit3);</p><p># get the correct p-values</p><p>fit4.t.values &#x0003c;- summary(</p><p>fit4)$coefficients [,"z value"];</p><p>fit4.p.values &#x0003c;- 2*pt(-abs(</p><p>fit4.t.values), fit2$df.residual);</p><p>}</p></sec></sec><sec><title>Authors' contributions</title><p>KAB, LD and JSM developed the main ideas and the methodology; LD did most of the coding. CMA supplied SAGE data and provided practical feedback on aspects of earlier approaches found to be wanting, thus guiding further development.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>The authors gratefully acknowledge support from NIH-NCI Grant 1U19 CA84978-1A1. Li Deng is also supported by a training fellowship from the W.M. Keck Foundation to the Gulf Coast Consortia through the Keck Center for Computational Biology.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Velculescu</surname><given-names>VE</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name></person-group><article-title>Serial analysis of gene expression</article-title><source>Science</source><year>1995</year><volume>270</volume><fpage>484</fpage><lpage>487</lpage><pub-id pub-id-type="pmid">7570003</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Zhou</surname><given-names>W</given-names></name><name><surname>Velculescu</surname><given-names>VE</given-names></name><name><surname>Kern</surname><given-names>SE</given-names></name><name><surname>Hruban</surname><given-names>RH</given-names></name><name><surname>Hamilton</surname><given-names>SR</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name></person-group><article-title>Gene expression profiles in normal and cancer cells</article-title><source>Science</source><year>1997</year><volume>276</volume><fpage>1268</fpage><lpage>1272</lpage><pub-id pub-id-type="pmid">9157888</pub-id><pub-id pub-id-type="doi">10.1126/science.276.5316.1268</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Madden</surname><given-names>SL</given-names></name><name><surname>Galella</surname><given-names>EA</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Bertelsen</surname><given-names>AH</given-names></name><name><surname>Beaudry</surname><given-names>GA</given-names></name></person-group><article-title>SAGE transcript profiles for p53-dependent growth regulation</article-title><source>Oncogene</source><year>1997</year><volume>15</volume><fpage>1079</fpage><lpage>1085</lpage><pub-id pub-id-type="pmid">9285562</pub-id><pub-id pub-id-type="doi">10.1038/sj.onc.1201091</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Audic</surname><given-names>S</given-names></name><name><surname>Claverie</surname><given-names>JM</given-names></name></person-group><article-title>The significance of digital gene expression profiles</article-title><source>Genome Res</source><year>1997</year><volume>7</volume><fpage>986</fpage><lpage>995</lpage><pub-id pub-id-type="pmid">9331369</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Kal</surname><given-names>AJ</given-names></name><name><surname>van Zonneveld</surname><given-names>AJ</given-names></name><name><surname>Benes</surname><given-names>V</given-names></name><name><surname>van den Berg</surname><given-names>M</given-names></name><name><surname>Koerkamp</surname><given-names>MG</given-names></name><name><surname>Albermann</surname><given-names>K</given-names></name><name><surname>Strack</surname><given-names>N</given-names></name><name><surname>Ruijter</surname><given-names>JM</given-names></name><name><surname>Richter</surname><given-names>A</given-names></name><name><surname>Dujon</surname><given-names>B</given-names></name><name><surname>Ansorge</surname><given-names>W</given-names></name><name><surname>Tabak</surname><given-names>HF</given-names></name></person-group><article-title>Dynamics of gene expression revealed by comparison of serial analysis of gene expression transcript profiles from yeast grown on two different carbon sources</article-title><source>Mol Biol Cell</source><year>1999</year><volume>10</volume><fpage>1859</fpage><lpage>1872</lpage><pub-id pub-id-type="pmid">10359602</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Centola</surname><given-names>M</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Metzger</surname><given-names>H</given-names></name></person-group><article-title>Characterization of gene expression in resting and activated mast cells</article-title><source>J Exp Med</source><year>1998</year><volume>188</volume><fpage>1657</fpage><lpage>1668</lpage><pub-id pub-id-type="pmid">9802978</pub-id><pub-id pub-id-type="doi">10.1084/jem.188.9.1657</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lai</surname><given-names>A</given-names></name><name><surname>Lash</surname><given-names>AE</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Velculescu</surname><given-names>V</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>McLendon</surname><given-names>RE</given-names></name><name><surname>Marra</surname><given-names>MA</given-names></name><name><surname>Prange</surname><given-names>C</given-names></name><name><surname>Morin</surname><given-names>PJ</given-names></name><name><surname>Polyak</surname><given-names>K</given-names></name><name><surname>Papadopoulos</surname><given-names>N</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name><name><surname>Strausberg</surname><given-names>RL</given-names></name><name><surname>Riggins</surname><given-names>GJ</given-names></name></person-group><article-title>A public database for gene expression in human cancers</article-title><source>Cancer Res</source><year>1999</year><volume>59</volume><fpage>5403</fpage><lpage>5407</lpage><pub-id pub-id-type="pmid">10554005</pub-id></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Michiels</surname><given-names>EMC</given-names></name><name><surname>Oussoren</surname><given-names>E</given-names></name><name><surname>van Groenigen</surname><given-names>M</given-names></name><name><surname>Pauws</surname><given-names>E</given-names></name><name><surname>Bossuyt</surname><given-names>PMM</given-names></name><name><surname>Voute</surname><given-names>PA</given-names></name><name><surname>Baas</surname><given-names>F</given-names></name></person-group><article-title>Genes differentially expressed in medulloblastoma and fetal brain</article-title><source>Physiol Genomics</source><year>1999</year><volume>1</volume><fpage>83</fpage><lpage>91</lpage><pub-id pub-id-type="pmid">11015565</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Man</surname><given-names>MZ</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><article-title>POWER_SAGE: comparing statistical tests for SAGE experiments</article-title><source>Bioinformatics</source><year>2000</year><volume>16</volume><fpage>953</fpage><lpage>959</lpage><pub-id pub-id-type="pmid">11159306</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/16.11.953</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ruijter</surname><given-names>JM</given-names></name><name><surname>van Kampen</surname><given-names>AHC</given-names></name><name><surname>Baas</surname><given-names>F</given-names></name></person-group><article-title>Statistical evaluation of SAGE libraries: Consequences for experimental design</article-title><source>Physiol Genomics</source><year>2002</year><volume>11</volume><fpage>37</fpage><lpage>44</lpage><pub-id pub-id-type="pmid">12407185</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>B</given-names></name><name><surname>Jones</surname><given-names>J</given-names></name><name><surname>Blades</surname><given-names>NJ</given-names></name><name><surname>Parmigiani</surname><given-names>G</given-names></name><name><surname>Hollingsworth</surname><given-names>MA</given-names></name><name><surname>Hruban</surname><given-names>RH</given-names></name><name><surname>Kern</surname><given-names>SE</given-names></name></person-group><article-title>Relationships and differentially expressed genes among pancreatic cancers examined by large-scale serial analysis of gene expression</article-title><source>Cancer Res</source><year>2002</year><volume>62</volume><fpage>819</fpage><lpage>826</lpage><pub-id pub-id-type="pmid">11830538</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baggerly</surname><given-names>KA</given-names></name><name><surname>Deng</surname><given-names>L</given-names></name><name><surname>Morris</surname><given-names>JS</given-names></name><name><surname>Aldaz</surname><given-names>CM</given-names></name></person-group><article-title>Differential expression in SAGE: Accounting for normal between-library variation</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1477</fpage><lpage>1483</lpage><pub-id pub-id-type="pmid">12912827</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg173</pub-id></citation></ref><ref id="B13"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Porter</surname><given-names>DA</given-names></name><name><surname>Krop</surname><given-names>IE</given-names></name><name><surname>Nasser</surname><given-names>S</given-names></name><name><surname>Sgroi</surname><given-names>D</given-names></name><name><surname>Kaelin</surname><given-names>CM</given-names></name><name><surname>Marks</surname><given-names>JR</given-names></name><name><surname>Riggins</surname><given-names>G</given-names></name><name><surname>Polyak</surname><given-names>K</given-names></name></person-group><article-title>A SAGE (serial analysis of gene expression) view of breast tumor progression</article-title><source>Cancer Res</source><year>2001</year><volume>61</volume><fpage>5697</fpage><lpage>5702</lpage><pub-id pub-id-type="pmid">11479200</pub-id></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ryu</surname><given-names>B</given-names></name><name><surname>Jones</surname><given-names>J</given-names></name><name><surname>Hollingsworth</surname><given-names>MA</given-names></name><name><surname>Hruban</surname><given-names>RH</given-names></name><name><surname>Kern</surname><given-names>SE</given-names></name></person-group><article-title>Invasion-specific genes in malignancy: Serial analysis of gene expression comparisons of primary and passaged cancers</article-title><source>Cancer Res</source><year>2001</year><volume>61</volume><fpage>1833</fpage><lpage>1838</lpage><pub-id pub-id-type="pmid">11280733</pub-id></citation></ref><ref id="B15"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Nacht</surname><given-names>M</given-names></name><name><surname>Dracheva</surname><given-names>T</given-names></name><name><surname>Gao</surname><given-names>Y</given-names></name><name><surname>Fujii</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Player</surname><given-names>A</given-names></name><name><surname>Akmaev</surname><given-names>V</given-names></name><name><surname>Cook</surname><given-names>B</given-names></name><name><surname>Dufault</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Guo</surname><given-names>M</given-names></name><name><surname>Curran</surname><given-names>J</given-names></name><name><surname>Han</surname><given-names>S</given-names></name><name><surname>Sidransky</surname><given-names>D</given-names></name><name><surname>Buetow</surname><given-names>K</given-names></name><name><surname>Madden</surname><given-names>SL</given-names></name><name><surname>Jen</surname><given-names>J</given-names></name></person-group><article-title>Molecular characteristics of non-small cell lung cancer</article-title><source>Proc Nat Acad Sci USA</source><year>2001</year><volume>98</volume><fpage>15203</fpage><lpage>15208</lpage><pub-id pub-id-type="pmid">11752463</pub-id><pub-id pub-id-type="doi">10.1073/pnas.261414598</pub-id></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Greller</surname><given-names>LD</given-names></name><name><surname>Tobin</surname><given-names>FL</given-names></name></person-group><article-title>Detecting selective expression of genes and proteins</article-title><source>Genome Res</source><year>1999</year><volume>9</volume><fpage>282</fpage><lpage>296</lpage><pub-id pub-id-type="pmid">10077535</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stekel</surname><given-names>DJ</given-names></name><name><surname>Git</surname><given-names>Y</given-names></name><name><surname>Falciani</surname><given-names>F</given-names></name></person-group><article-title>The comparison of gene expression from multiple cDNA libraries</article-title><source>Genome Res</source><year>2000</year><volume>10</volume><fpage>2055</fpage><lpage>2061</lpage><pub-id pub-id-type="pmid">11116099</pub-id><pub-id pub-id-type="doi">10.1101/gr.GR-1325RR</pub-id></citation></ref><ref id="B18"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Collett</surname><given-names>D</given-names></name></person-group><source>Modelling Binary Data, 2e</source><year>2002</year><publisher-name>New York, NY: CRC Press</publisher-name></citation></ref><ref id="B19"><citation citation-type="book"><person-group person-group-type="author"><name><surname>McCullagh</surname><given-names>P</given-names></name><name><surname>Nelder</surname><given-names>JA</given-names></name></person-group><source>Generalized Linear Models, 2e</source><year>1989</year><publisher-name>New York, NY: CRC Press</publisher-name></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Crowder</surname><given-names>MJ</given-names></name></person-group><article-title>Beta-binomial ANOVA for proportions</article-title><source>Appl Stat</source><year>1978</year><volume>27</volume><fpage>34</fpage><lpage>37</lpage></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>DA</given-names></name></person-group><article-title>Extra-binomial variation in logistic linear models</article-title><source>Appl Stat</source><year>1982</year><volume>31</volume><fpage>144</fpage><lpage>148</lpage></citation></ref><ref id="B22"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Best</surname><given-names>NG</given-names></name><name><surname>Spiegelhalter</surname><given-names>DJ</given-names></name><name><surname>Thomas</surname><given-names>A</given-names></name><name><surname>Brayne</surname><given-names>CEG</given-names></name></person-group><article-title>Bayesian analysis of realistically complex models</article-title><source>J Royal Stat Soc A</source><year>1996</year><volume>159</volume><fpage>323</fpage><lpage>342</lpage></citation></ref><ref id="B23"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Colinge</surname><given-names>J</given-names></name><name><surname>Feger</surname><given-names>G</given-names></name></person-group><article-title>Detecting the impact of sequencing errors on SAGE Data</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><fpage>840</fpage><lpage>842</lpage><pub-id pub-id-type="pmid">11590101</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/17.9.840</pub-id></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boon</surname><given-names>K</given-names></name><name><surname>Osorio</surname><given-names>EC</given-names></name><name><surname>Greenhut</surname><given-names>SF</given-names></name><name><surname>Schaefer</surname><given-names>CF</given-names></name><name><surname>Shoe maker</surname><given-names>J</given-names></name><name><surname>Polyak</surname><given-names>K</given-names></name><name><surname>Morin</surname><given-names>PJ</given-names></name><name><surname>Buetow</surname><given-names>KH</given-names></name><name><surname>Strausberg</surname><given-names>RL</given-names></name><name><surname>de Souza</surname><given-names>SJ</given-names></name><name><surname>Riggins</surname><given-names>GJ</given-names></name></person-group><article-title>An anatomy of normal and malignant gene expression</article-title><source>Proc Nat Acad Sci USA</source><year>2002</year><volume>99</volume><fpage>11287</fpage><lpage>11292</lpage><pub-id pub-id-type="pmid">12119410</pub-id><pub-id pub-id-type="doi">10.1073/pnas.152324199</pub-id></citation></ref><ref id="B25"><citation citation-type="other"><article-title>SAGE Genie</article-title><ext-link ext-link-type="uri" xlink:href="http://cgap.nci.nih.gov/SAGE"/></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Methods of summarizing data. The effects of pooling and reduction to proportions on a single tag measured across four libraries. Pooling reduces the data to the summed counts at the right, and focusing on proportions reduces the data to the proportions on the bottom. In both cases, information is lost.</p></caption><table frame="hsides" rules="groups"><thead><tr><td></td><td></td><td></td><td></td><td></td><td align="center">Summed Counts</td></tr></thead><tbody><tr><td align="left">Tag Count</td><td align="center"><italic>Y</italic><sub>1</sub></td><td align="center"><italic>Y</italic><sub>2</sub></td><td align="center"><italic>Y</italic><sub>3</sub></td><td align="center"><italic>Y</italic><sub>4</sub></td><td align="center"><graphic xlink:href="1471-2105-5-144-i2.gif"/></td></tr><tr><td align="left">Library Size</td><td align="center"><italic>n</italic><sub>1</sub></td><td align="center"><italic>n</italic><sub>2</sub></td><td align="center"><italic>n</italic><sub>3</sub></td><td align="center"><italic>n</italic><sub>4</sub></td><td align="center"><graphic xlink:href="1471-2105-5-144-i3.gif"/></td></tr><tr><td align="left">Proportions</td><td align="center"><italic>Y</italic><sub>1</sub>/<italic>n</italic><sub>1</sub></td><td align="center"><italic>Y</italic><sub>2</sub>/<italic>n</italic><sub>2</sub></td><td align="center"><italic>Y</italic><sub>3</sub>/<italic>n</italic><sub>3</sub></td><td align="center"><italic>Y</italic><sub>4</sub>/<italic>n</italic><sub>4</sub></td><td></td></tr></tbody></table></table-wrap><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Tag counts from sample SAGE libraries. Counts and proportions of tags ATTTGAGAAG, TGCTGCCTGT and GCGAAACCCT in 8 colon libraries from Zhang et al. [2]; two normal colon (NC), two primary tumors (TU) and four cell lines.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Group</td><td align="center" colspan="2">Normal Colon</td><td align="center" colspan="2">Primary Tumor</td><td align="center" colspan="4">Cell Lines</td></tr></thead><tbody><tr><td align="right">Library</td><td align="right">NC1</td><td align="right">NC2</td><td align="right">TU98</td><td align="right">TU102</td><td align="right">CACO2</td><td align="right">HCT116</td><td align="right">RKO</td><td align="right">SW837</td></tr><tr><td colspan="9"><hr></hr></td></tr><tr><td align="center">ATTTGAGAAG</td><td align="right">320</td><td align="right">600</td><td align="right">312</td><td align="right">549</td><td align="right">246</td><td align="right">65</td><td align="right">41</td><td align="right">52</td></tr><tr><td align="center">TGCTGCCTGT</td><td align="right">0</td><td align="right">1</td><td align="right">1</td><td align="right">15</td><td align="right">9</td><td align="right">1</td><td align="right">12</td><td align="right">27</td></tr><tr><td align="center">GCGAAACCCT</td><td align="right">167</td><td align="right">566</td><td align="right">64</td><td align="right">98</td><td align="right">33</td><td align="right">47</td><td align="right">40</td><td align="right">27</td></tr><tr><td align="center">Library Size</td><td align="right">49610</td><td align="right">48479</td><td align="right">41371</td><td align="right">55700</td><td align="right">60682</td><td align="right">55641</td><td align="right">51294</td><td align="right">61148</td></tr><tr><td align="center">Propn ATT..(%)</td><td align="right">0.65</td><td align="right">1.24</td><td align="right">0.75</td><td align="right">0.99</td><td align="right">0.41</td><td align="right">0.12</td><td align="right">0.08</td><td align="right">0.09</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>Logistic regression models for two groups. Logistic regression fits contrasting normal colon with cancer samples for tag ATTTGAGAAG from Table 2. The first model makes no allowance for overdispersion, and the latter two introduce it in different ways. The introduction of overdispersion is important as it dramatically affects the results, but the choice of overdispersion method is less crucial.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Model 1:</td><td align="right">No overdispersion</td><td align="center" colspan="2"><italic>V</italic>(<italic>Y</italic><sub><italic>i</italic></sub>) = <italic>n</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub>(1 - <italic>p</italic><sub><italic>i</italic></sub>)</td><td></td></tr></thead><tbody><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="center">(s.e)</td><td align="right">z-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-4.660</td><td align="center">0.033</td><td align="right">-140.68</td><td align="right">&#x0003c; 2<italic>e</italic>-16</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">-0.888</td><td align="center">0.043</td><td align="right">-20.41</td><td align="right">&#x0003c; 2<italic>e</italic>-16</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Model 2:</td><td align="right">Quasilikelihood</td><td align="center" colspan="2"><italic>V</italic>(<italic>Y</italic><sub><italic>i</italic></sub>) = <italic>n</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub>(1 - <italic>p</italic><sub><italic>i</italic></sub>)<graphic xlink:href="1471-2105-5-144-i5.gif"/></td><td align="right"><graphic xlink:href="1471-2105-5-144-i11.gif"/> = 187.6</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="center">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-4.660</td><td align="center">0.454</td><td align="right">-10.261</td><td align="right">5<italic>e </italic>- 05</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">-0.888</td><td align="center">0.595</td><td align="right">-1.489</td><td align="right">0.187</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Model 3:</td><td align="right">Hierarchical</td><td align="center" colspan="2"><italic>V</italic>(<italic>Y</italic><sub><italic>i</italic></sub>) = <italic>n</italic><sub><italic>i</italic></sub><italic>p</italic><sub><italic>i</italic></sub>(1 - <italic>p</italic><sub><italic>i</italic></sub>) [1 + (<italic>n</italic><sub><italic>i </italic></sub>- 1)<italic>&#x003c6;</italic>]</td><td align="right"><graphic xlink:href="1471-2105-5-144-i14.gif"/> = 3.4<italic>e </italic>- 03</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="center">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-4.656</td><td align="center">0.428</td><td align="right">-10.874</td><td align="right">3.6<italic>e </italic>- 05</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">-0.850</td><td align="center">0.570</td><td align="right">-1.492</td><td align="right">0.186</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T4"><label>Table 4</label><caption><p>Expanding contrasts from two to three groups. Logistic regression models testing the significance of a difference between normal colon and primary tumor (<italic>&#x003b2;</italic><sub>1</sub>) for tag TGCTGCCTGT from Table 2. In the first model, only data from the four libraries directly involved are used. In the second model, data from the four cell line libraries are also included, providing a more stable estimate of the overdispersion parameter <italic>&#x003c6;</italic>.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Model 1:</td><td align="right">Two Groups</td><td align="right" colspan="2"><graphic xlink:href="1471-2105-5-144-i14.gif"/> = 8.938<italic>e </italic>- 05</td><td align="right"><italic>df </italic>= 2</td></tr></thead><tbody><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="right">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-11.484</td><td align="right">2.309</td><td align="right">-4.973</td><td align="right">0.038</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">2.681</td><td align="right">2.388</td><td align="right">1.123</td><td align="right">0.378</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Model 2:</td><td align="right">Three Groups</td><td align="right" colspan="2"><graphic xlink:href="1471-2105-5-144-i14.gif"/> = 1.160<italic>e </italic>- 04</td><td align="right"><italic>df </italic>= 5</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="right">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-11.484</td><td align="right">2.574</td><td align="right">-4.462</td><td align="right">0.007</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">2.676</td><td align="right">2.661</td><td align="right">1.005</td><td align="right">0.361</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>2</sub></td><td align="right">3.020</td><td align="right">2.604</td><td align="right">1.159</td><td align="right">0.299</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T5"><label>Table 5</label><caption><p>Analysis of deviance. Deviance table for various submodels fit to the data for tag TGCTGCCTGT given in Table 2. All of these models use the value for overdispersion found for the most extensive model, <graphic xlink:href="1471-2105-5-144-i14.gif"/> = 1.160<italic>e </italic>- 04.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Terms Fitted</td><td align="center">Deviance</td><td align="right">d.f.</td></tr></thead><tbody><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="center">9.7433</td><td align="right">7</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1</sub></td><td align="center">9.7418</td><td align="right">6</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>2</sub></td><td align="center">7.9826</td><td align="right">6</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0 </sub>+ <italic>&#x003b2;</italic><sub>1 </sub>+ <italic>&#x003b2;</italic><sub>2</sub></td><td align="center">5.7866</td><td align="right">5</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T6"><label>Table 6</label><caption><p>Incorporating covariates into the model. Models treating the fitting of counts for tag GCGAAACCCT from Table 2, with the cell lines hypothetically allocated to normal tissue B (libraries 5 and 6) and cancer tissue B (libraries 7 and 8). This division is made to illustrate how the effects of two differences, normal vs cancer and tissue A vs tissue B (<italic>&#x003b2;</italic><sub>1 </sub>and <italic>&#x003b2;</italic><sub>2 </sub>respectively) can be partitioned according to their importance. In Model 2, we have further introduced a continuous covariate (<italic>&#x003b2;</italic><sub>3</sub>) corresponding to the levels of a biomarker to show how that can be figured in as well.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Model 1:</td><td align="right">Hypothetical Cov.</td><td align="right" colspan="2"><graphic xlink:href="1471-2105-5-144-i14.gif"/> = 1.224<italic>e </italic>- 03</td><td align="right">df = 5</td></tr></thead><tbody><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="right">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-4.928</td><td align="right">0.291</td><td align="right">-16.921</td><td align="right">1.318e - 05</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">-1.293</td><td align="right">0.593</td><td align="right">-2.181</td><td align="right">0.0810</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>2</sub></td><td align="right">-1.956</td><td align="right">0.738</td><td align="right">-2.650</td><td align="right">0.0454</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Model 2:</td><td align="right">Hypothetical Biom.</td><td align="right" colspan="2"><graphic xlink:href="1471-2105-5-144-i14.gif"/> = 1.254<italic>e </italic>- 03</td><td align="right">df = 4</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="right">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-4.167</td><td align="right">0.608</td><td align="right">-6.851</td><td align="right">1.012e-03</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">-1.423</td><td align="right">0.611</td><td align="right">-2.328</td><td align="right">0.0674</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>2</sub></td><td align="right">-2.031</td><td align="right">0.752</td><td align="right">-2.700</td><td align="right">0.0428</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>3</sub></td><td align="right">-1.365</td><td align="right">1.028</td><td align="right">-1.328</td><td align="right">0.2417</td></tr></tbody></table></table-wrap><table-wrap position="float" id="T7"><label>Table 7</label><caption><p>Fitting nested deviance models. Fitting nested models to the data in order to get deviance scores. The difference in deviance between models is a better indicator of the significance of the associated effect (<italic>&#x003b2;</italic><sub>1</sub>) when the logistic regression fits are near the boundary of the space, giving proportions close to zero.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left">Model 1:</td><td align="right">Full Model</td><td align="left" colspan="2">Deviance = 5.0742</td><td></td></tr></thead><tbody><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="left">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-11.494</td><td align="left">13.518</td><td align="right">-0.06</td><td align="right">0.9519</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>1</sub></td><td align="right">5.987</td><td align="left">13.524</td><td align="right">-0.03</td><td align="right">0.9750</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Model 2:</td><td align="right">Null Model</td><td align="left" colspan="2">Deviance = 8.7541</td><td></td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="left">Coefficients</td><td align="right">Estimate</td><td align="left">(s.e)</td><td align="right">t-value</td><td align="right">p-value</td></tr><tr><td align="left"><italic>&#x003b2;</italic><sub>0</sub></td><td align="right">-5.794</td><td align="left">0.392</td><td align="right">-14.772</td><td align="right">6.05e-06</td></tr></tbody></table></table-wrap></sec></back></article>



