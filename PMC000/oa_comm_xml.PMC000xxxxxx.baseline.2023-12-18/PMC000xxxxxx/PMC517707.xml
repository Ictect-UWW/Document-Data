<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">15339345</article-id><article-id pub-id-type="pmc">PMC517707</article-id><article-id pub-id-type="publisher-id">1471-2105-5-119</article-id><article-id pub-id-type="doi">10.1186/1471-2105-5-119</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Bayesian model accounting for within-class biological variability in Serial Analysis of Gene Expression (SAGE)</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>V&#x000ea;ncio</surname><given-names>Ricardo ZN</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>rvencio@vision.ime.usp.br</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Brentani</surname><given-names>Helena</given-names></name><xref ref-type="aff" rid="I3">3</xref><xref ref-type="aff" rid="I4">4</xref><email>helena@lbc.ludwig.org.br</email></contrib><contrib id="A3" contrib-type="author"><name><surname>Patr&#x000e3;o</surname><given-names>Diogo FC</given-names></name><xref ref-type="aff" rid="I3">3</xref><email>djogo@lbc.ludwig.org.br</email></contrib><contrib id="A4" contrib-type="author"><name><surname>Pereira</surname><given-names>Carlos AB</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>cpereira@ime.usp.br</email></contrib></contrib-group><aff id="I1"><label>1</label>Statistics Department, Instituto de Matem&#x000e1;tica e Estat&#x000ed;stica &#x02013; Universidade de S&#x000e3;o Paulo, Rua do Mat&#x000e3;o 1010, 05508-090 S&#x000e3;o Paulo, BRAZIL</aff><aff id="I2"><label>2</label>BIOINFO-USP &#x02013; N&#x000fa;cleo de Pesquisas em Bioinform&#x000e1;tica da Universidade de S&#x000e3;o Paulo, Rua do Mat&#x000e3;o 1010, 05508-090 S&#x000e3;o Paulo, BRAZIL</aff><aff id="I3"><label>3</label>Ludwig Institute for Cancer Research &#x02013; S&#x000e3;o Paulo Branch, Rua Prof. Ant&#x000f4;nio Prudente 109, 01519-010 S&#x000e3;o Paulo, BRAZIL</aff><aff id="I4"><label>4</label>Hospital do C&#x000e2;ncer A.C. Camargo, Rua Prof. Ant&#x000f4;nio Prudente 109, 01519-010 S&#x000e3;o Paulo, BRAZIL</aff><pub-date pub-type="collection"><year>2004</year></pub-date><pub-date pub-type="epub"><day>31</day><month>8</month><year>2004</year></pub-date><volume>5</volume><fpage>119</fpage><lpage>119</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/5/119"/><history><date date-type="received"><day>14</day><month>5</month><year>2004</year></date><date date-type="accepted"><day>31</day><month>8</month><year>2004</year></date></history><copyright-statement>Copyright &#x000a9; 2004 V&#x000ea;ncio et al; licensee BioMed Central Ltd.</copyright-statement><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p></license><abstract><sec><title>Background</title><p>An important challenge for transcript counting methods such as Serial Analysis of Gene Expression (SAGE), "Digital Northern" or Massively Parallel Signature Sequencing (MPSS), is to carry out statistical analyses that account for the within-class variability, i.e., variability due to the intrinsic biological differences among sampled individuals of the same class, and not only variability due to technical sampling error.</p></sec><sec><title>Results</title><p>We introduce a Bayesian model that accounts for the within-class variability by means of mixture distribution. We show that the previously available approaches of aggregation in pools ("pseudo-libraries") and the Beta-Binomial model, are particular cases of the mixture model. We illustrate our method with a brain tumor vs. normal comparison using SAGE data from public databases. We show examples of tags regarded as differentially expressed with high significance if the within-class variability is ignored, but clearly not so significant if one accounts for it.</p></sec><sec><title>Conclusion</title><p>Using available information about biological replicates, one can transform a list of candidate transcripts showing differential expression to a more reliable one. Our method is freely available, under GPL/GNU copyleft, through a user friendly web-based on-line tool or as R language scripts at supplemental web-site.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>An important challenge in Serial Analysis of Gene Expression (SAGE) [<xref ref-type="bibr" rid="B1">1</xref>] analysis is the decision whether a gene is differentially expressed between two classes, for example tumoral vs. normal classes. In statistical terms, this essential step is to test the null hypothesis H<sub>0</sub>: "gene has no differential expression between the two probed classes". A much more usual approach is to assign an index (<italic>P</italic>-value or Bayes factor, for example) that measures the confidence/significance of the hypothesis and let the biologists themselves to establish a cutoff of what they call significant.</p><p>This necessity arises because counting sequenced SAGE tags is a process prone to random and systematic errors that affect gene expression abundance estimates. Systematic errors may come from various sources such as GC content bias [<xref ref-type="bibr" rid="B2">2</xref>], sequencing errors [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>] as well as the possibility of non unique tags. This kind of error can be detected/corrected using some bioinformatics procedures such as quality control of automatic sequencing pipe-line [<xref ref-type="bibr" rid="B5">5</xref>], or statistical estimation procedures such as "denoising" [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]. Random errors are due to the inherent stochastic characteristic of SAGE data acquisition: sampling from automatic sequencing. Like colored balls in an urn, sampling and counting SAGE tags from a library is commonly modeled by a Bernoulli Process relying on an infinite population sampling approximation.</p><p>If an Expressed Sequence Tag (EST) library is non-normalized, its counting data, also known as "Digital-Northern", reflects the abundance of genes. Likewise, the Massively Parallel Signature Sequencing (MPSS) [<xref ref-type="bibr" rid="B8">8</xref>] technique counts tags to infer the transcriptome, but using a completely different strategy from traditional DNA sequencing methods, that allows augmented high-throughput capability. Therefore, all the results discussed here are readily applicable to "Digital-Northern" or MPSS context since, from a mathematical viewpoint, all represent the same bioinformatics problem: counting transcripts (as balls in urns).</p><p>Nowadays, the variability in SAGE abundance data is modeled only as due to sampling from sequencing, since almost all statistical procedures are performed after aggregation of observations from various libraries of the same class, creating a "pseudo-library". See [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>] for good reviews on statistical techniques used in SAGE analysis. This extensively used trick tacitly ignores the within-class variability, i.e., the biological variability among individuals within a class (different patients having the same cancer diagnosis, for example), and could lead to overconfident conclusions.</p></sec><sec><title>Results</title><p>Here we propose a Bayesian model of mixtures to account for within-class variability as a generalization of the Beta-Binomial model [<xref ref-type="bibr" rid="B12">12</xref>]. We also show that the usual "pseudo-library" construction is a particular case of our mixture model. Finally, we propose the use of the Bayes Error Rate to intuitively rank the differential expression hypothesis under a Bayesian framework, avoiding several technicalities and difficulties such as: typeI and typeII error analysis, Bonferroni-like multiple testing correction, asymptotic results evocation, imposition of a test statistic and null probability density function (pdf), and so on.</p><sec><title>Statistical model</title><p>The counting process from automatic sequencing of one single <italic>i</italic>-th library is often modeled as a Bernoulli Process and a fixed unknown tag abundance <italic>&#x003c0;</italic><sub><italic>i </italic></sub>is implicitly assumed. The pdf of the random variable of interest, "expression abundance" <italic>&#x003c0; </italic>&#x02208; [0;1] among all <italic>n </italic>libraries is unknown, thus each library could be regarded as being created by a realization of <italic>&#x003c0;</italic>. These features lead naturally to mixture models [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]:</p><p><inline-graphic xlink:href="1471-2105-5-119-i1.gif"/></p><p>where: <italic>f</italic>(&#x000b7;) is the unknown pdf of the abundance among same-class libraries parameterized by a vector <italic><bold>&#x003b8;</bold></italic>, <bold>X </bold>= (<italic>x</italic><sub>1</sub>,..., <italic>x</italic><sub><italic>n</italic></sub>) is the vector of counts in all <italic>n </italic>libraries of same class, <bold>M </bold>= (<italic>m</italic><sub>1</sub>,..., <italic>m</italic><sub><italic>n</italic></sub>) is the vector of library sizes and <italic>L </italic>is the likelihood of each <italic>i</italic>-th observation.</p><p>The common procedure of merging all observations from libraries of the same class, constructing a "pseudo-library" before statistical inference, is recognized as a particular case of this mixture model: just assume that all libraries have strictly the same abundance, with no biological variability. Mathematically, this is a function with infinite probability density over one single abundance value <italic>&#x003c0; </italic>= <italic>&#x003b8; </italic>and zero over every other <italic>&#x003c0; </italic>&#x02260; <italic>&#x003b8;</italic>, or a Dirac's Delta function. Using <italic>f</italic>(&#x000b7;) as a Dirac's Delta function constrained to [0;1], turn Eq.1 into the familiar and commonly used binomial distribution (see derivation in the Methods section).</p><p>We believe that Dirac's Delta is a naive description of real-life SAGE libraries. The Beta distribution is an alternative with non-zero within-class variance to account for intuitively expected biological differences among them. Using <italic>f</italic>(&#x000b7;) as a Beta in Eq.1, yields the so-called Beta-Binomial model (see derivation in the Methods section).</p><p>Given the parameter vector <italic><bold>&#x003b8; </bold></italic>that describes the random variable <italic>&#x003c0; </italic>of some fixed gene <italic>G</italic>, we must decide if there is a difference between A and B classes (e.g, tumor vs. normal classes). We propose to consider genes as being differentially expressed based on non-superposition of the predictive Beta pdfs of both A and B classes. By "predictive" we mean that we use the <italic>a posteriori </italic>mode in the Beta pdfs. The "non-superposition" intuitive feature is mathematically written as the Bayes Error Rate <italic>E </italic>[<xref ref-type="bibr" rid="B15">15</xref>]:</p><p><inline-graphic xlink:href="1471-2105-5-119-i2.gif"/></p><p>where <italic>f</italic>(&#x000b7;) is the Beta pdf and "hat" over the parameters indicate the values that lead to an <italic>a posteriori </italic>pdf maximum. The <italic>a posteriori </italic>distribution is obtained as usual from Bayesian Statistical Theory (<italic>a priori </italic>pdf choice and detailed derivation are in the Methods section).</p><p>Intuitively, if the pdfs are "far apart", the gene probably has reproducible differential expression between classes. In this case, rarely could one misclassify class A as B and vice-versa. Figure <xref ref-type="fig" rid="F1">1</xref> gives some insight about this fact. Using our proposed approach, the "far apart" notion means a small Bayes Error Rate <italic>E</italic>. For adepts of the Frequentist Statistics, this evidence measure could resemble a typeI and typeII errors sum, however it is just an illustrative analogy.</p><p>As in any significance test method, the experimenter must define what is a high significance <italic>E </italic>value. This cutoff should be guided by external and independent confirmatory assays. To avoid crude decision boundaries, one could rank their significance results but there is no way to avoid some arbitrariness in any kind of statistical test.</p><p>In the classical Frequentist Statistics framework, it is common to call a result as significant if it presents a <italic>P</italic>-value &#x02264; 0.01 in a <italic>t</italic>-like-test, hoping that this could control the error at this level. However, due to technical difficulties such as lack of sensitivity of posterior confirmatory methods or high absolute expression (not differential expression) necessity, this apparent statistically sound results could be not useful in a pragmatic sense. That is why we prefer to rank the differential expression results and allow researchers to establish a cutoff compatible with their subsequent application for the selected genes, rather than split them based in assumption-derived error-rate cutoffs. People familiar with the Frequentist Statistics framework could miss multiple testing considerations, typeI/typeII error studies, and so on. However, in the Bayesian framework, several of these concerns are meaningless since we work with parameters space and not with sample space. The bayesians avoid statements about "data that could be observed but was not" and work only with available information (prior and experimental), extracting all possible information from data effectively observed.</p><p>For those genes classified as differentially expressed, one should aggregate intuitive information adding "error-bars" to expression ratios. Recently we have developed a method to add credibility intervals to gene expression ratio [<xref ref-type="bibr" rid="B16">16</xref>], which could improve posterior analyses such as clustering [<xref ref-type="bibr" rid="B17">17</xref>] or comparison with microarray data.</p></sec><sec><title>Comparison with available methods using publically available data</title><p>To show the model is usefulness, we applied it to a tumor vs. normal two-classes comparison problem. We chose a subset of brain tumor SAGE data from The Cancer Genome Anatomy Project's SAGE Genie public database web-site [<xref ref-type="bibr" rid="B18">18</xref>]. The SAGE Genie performs several bioinformatics protocols to assure the quality of its data with systematic errors cleaning/correction [<xref ref-type="bibr" rid="B19">19</xref>].</p><p>We used all 4 available libraries in SAGE Genie until Jan/2004 from astrocytoma grade III tumors and almost all (except the fetal library) normal brain libraries (see Methods section for details about libraries).</p><p>We want to stress 3 typical and important cases: (i) when our measure agreed with other evidence measures accepting null hypothesis H<sub>0</sub>, i.e., there is no evidence of differential behavior between tumor and normal classes; (ii) when our method agreed with others rejecting H<sub>0</sub>, i.e., there is evidence of differential expression; and (iii) when our method showed evidence in favor but other evidence measures showed evidence against the H<sub>0</sub>. Case (iii) is the main motivation of our method since it reveals situations that researchers may call a gene differentially expressed and, in fact, it could be not so significant if biological replicates are taken into account. The other evidence measures used were: the Audic-Claverie bayesian evidence [<xref ref-type="bibr" rid="B20">20</xref>], the classical Fisher Exact Test <italic>P</italic>-value, and the classical <italic>&#x003c7;</italic><sup>2 </sup><italic>P</italic>-value, all obtained using the IDEG6 web-interface [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>] (see Methods section).</p><p>A case (i) prototype is the TTTCAATAGA tag with <bold>X</bold><sub>T </sub>= (0, 2, 5, 8) and <bold>X</bold><sub>N </sub>= (1, 1, 0, 0, 0, 7, 2). The Audic-Claverie, Fisher and <italic>&#x003c7;</italic><sup>2 </sup>methods yield <italic>P</italic>-values of 0.06, 0.44, 0.41, respectively, indicating low evidence against H<sub>0 </sub>for all mystical significance level cutoffs &#x02264; 0.01, &#x02264; 0.05 or &#x02264; 0.1. The Bayes Error Rate evidence is <italic>E </italic>= 0.61, an intuitively unacceptable superposition level between the normal and tumoral predictive Beta pdfs, showing that there is no separable behavior between classes. Figure <xref ref-type="fig" rid="F2">2a</xref> shows an obvious superposition between pdf and observations of this two classes.</p><p>A case (ii) prototype is the AAAAGAAACT tag with <bold>X</bold><sub>T </sub>= (7, 11, 18, 10) and <bold>X</bold><sub>N </sub>= (7, 1, 2, 1, 2, 0, 3). All <italic>P</italic>-values are 0.00 (zero), significant at any cutoff level. Our evidence is <italic>E </italic>= 0.03, showing safely that this gene behaves differentially between normal brain and astrocytoma grade III patients. Figure <xref ref-type="fig" rid="F2">2b</xref> shows that two Betas are apart from each other and, even observing clear within-class variability, the expression is different.</p><p>A case (iii) prototype is the TTGGAGATCT tag with <bold>X</bold><sub>T </sub>= (7, 239, 244, 123) and <bold>X</bold><sub>N </sub>= (54, 27, 33, 21, 40, 196, 28). All <italic>P</italic>-values are 0.00 (zero), indicating significant difference between classes. On the other hand, our evidence <italic>E </italic>= 0.73 indicates high superposition between tumor and normal classes. Figure <xref ref-type="fig" rid="F2">2c</xref> shows that within-class variability for tumor class is not negligible. It is obvious that individual libraries confound their results with normal brain libraries, and the Betas have a relatively high intersection. Using a common "pseudo-library" approach, one is lead to call this gene as a strong discriminator between classes. We believe that this is a suspect conclusion.</p><p>There are several other obvious case (iii) examples, such as tag TACAGTATGT in Figure <xref ref-type="fig" rid="F2">2d</xref>, that received <italic>P</italic>-values &#x0003c; 0.01 from all other methods, and they are the main concern of our method since they may lead to waste of resources in clinical validation efforts of genes that, by SAGE itself, could be left behind in favor of other promising genes. All tag results are available as additional file and graphics for all tags are at the supplemental web-site [<xref ref-type="bibr" rid="B23">23</xref>].</p><p>One could think about a case (iv) when considering within-class variability leads one to H<sub>0 </sub>rejection, but considering "pseudo-libraries" leads to H<sub>0 </sub>acceptance. This seems to be inconsistent since one expects that, once H<sub>0 </sub>is accepted in a simplified model, it should also be accepted in the complete model. In fact, we do not observe such a situation, except by tags with <italic>P</italic>-values or Bayes Error Rate very close to arbitrarily defined cutoff values. We believe that these occurrences are just "edge effect" manifestations.</p></sec></sec><sec><title>Discussion</title><p>In order to assure that we are dealing with a fundamental question in SAGE analysis, we show more insights analyzing the method's robustness using the same data but excluding "small" libraries. Also, we draw some parallels between our proposed method and the only available published solution for dealing with within-class variability, a <italic>t</italic>-test approximation [<xref ref-type="bibr" rid="B12">12</xref>].</p><p>We used our method with all available libraries but some of them are smaller than 50,000 tags (see Table <xref ref-type="table" rid="T1">1</xref>). In the SAGE community, libraries smaller than this arbitrary limit are considered "small". Several researchers claim that these are non-representative and should be excluded from analysis. We observed several case (iii) tag examples which remain as case (iii) if we use libraries with size &#x0003e; 40,000 and &#x0003e; 50,000 (shown at the supplemental web-site only). Figure <xref ref-type="fig" rid="F3">3</xref> shows a tag example analyzed in these tree setups and it is clear that inclusion of "small" libraries gave pretty much the same result, indicating robustness of our method against small class size variations and against "small" sized libraries. Moreover, these libraries are not always outliers from biological sampling but seem to be samples like any other. These results suggest that one can use the "small" libraries, jointly with non-"small" ones, because biological variability seems to be greater than binomial sampling variability.</p><p>Obviously, we are not recommending to use only "small" libraries in SAGE analysis, but suggesting that our method is relatively robust. For low expression genes, the binomial sampling variability should become more relevant as the library size decreases. Also, the results obtained using two/three libraries could be very different from using just one. These proprieties could be tag dependent since some tags could be much noisier than others for biological reasons. Some "denoising" procedure could be used before application of our method [<xref ref-type="bibr" rid="B7">7</xref>]. Therefore, our findings should be carefully interpreted.</p><p>To prove that the incoherence of using "pseudo-libraries" methods is not a prerogative of tags showing small fold-changes, we analyzed another three very illustrative examples: ATGGCAACAG, GGATGTGAAA, and GTATGGGCCC; which are case (iii) tags. These tags present high fold changes: 7.59, 8.15 and 25.80 fold-change respectively, augmented in pooled tumor libraries. Using the well-known Fisher Exact test, <italic>&#x003c7;</italic><sup>2 </sup>classical test and the Audic-Claverie's method, we get 0.00 (zero!) for all <italic>P</italic>-values of the no differential expression null hypothesis. Using the conceptually different Bayesian <italic>P</italic>-value implemented at SAGE Genie [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>] we obtain 0.01, 0.00 and 0.00 respectively for posterior probabilities of fold-changes greater than 4-fold. Finally, using our own proposed measure, applied to the pool, we get <italic>E </italic>= 0.00 meaning no superposition between the two classes pdfs. All these results indicate strong significance in differential expression of these tags.</p><p>However, if we consider within-class variability, the test proposed by Baggerly <italic>et al. </italic>[<xref ref-type="bibr" rid="B12">12</xref>] yields 0.08, 0.07 and 0.15 respectively for <italic>t</italic>-test <italic>P</italic>-values, and our method yields Bayes Error Rates of 0.38, 0.37, 0.43 respectively; indicating not so significant evidence in favor of the differentially expressed hypothesis. A closer look at the graphics of these tags induces one to believe that there is no reproducible differential expression because several observations of tumor and normal are superimposed (all graphics available at supplemental web-site [<xref ref-type="bibr" rid="B23">23</xref>]).</p><p>Since we show clearly that methods that use "pseudo-library" aggregation could be incoherent in some cases, a natural question is how our proposed method performs compared to the only published solution that accounts for within-class variability, the Baggerly <italic>et al. </italic>[<xref ref-type="bibr" rid="B12">12</xref>]<italic>t</italic>-test approximation. Without knowing the true state of all tags, it is impossible to carry out a serious benchmark. Since the interpretation of evidence measures is very different, the performance could be subjected to an arbitrary cutoff selection for each method. Figure <xref ref-type="fig" rid="F4">4</xref> shows a scatter-plot of evidence measures obtained for each of the two methods.</p><p>It is clear from this graphic that there are many more tags considered as differentially expressed using our method than the <italic>t</italic>-test approximation, considering <italic>E </italic>&#x02264; 0.1 and <italic>P</italic>-value &#x02264; 0.01. There are also some tags selected by <italic>t</italic>-test and ignored by ours. It is impossible to know which method perform better without the true unknown status of those tags. Looking at individual libraries results, constructed as depicted in Figure <xref ref-type="fig" rid="F2">2</xref> for example, could help in this analysis but this is a subjective procedure.</p><p>It is important to bear in mind that a difficulty is hidden in the Beta modeling imposed in the very first beginning. If Beta is not a good model for an unknown biological behavior, then some apparent inconsistency could appear in both Baggerly <italic>et al. </italic>[<xref ref-type="bibr" rid="B12">12</xref>] and our approaches. However, our general mixture model allows another propositions. Other simplex constrained pdfs, different from Beta, exist but the tractability is much more difficult [<xref ref-type="bibr" rid="B26">26</xref>]. We believe that to build a fully non-parametric approach to this problem is a very hard issue, but should be considered as a future challenge.</p></sec><sec><title>Conclusion</title><p>Until now, almost all statistical methods for SAGE data analysis tacitly ignore the within-class variability. To our knowledge, the firsts to formally address this issue was Baggerly <italic>et al. </italic>[<xref ref-type="bibr" rid="B12">12</xref>] who introduced the Beta-Binomial model as the correct way to model the probability of counting tags instead of Binomial models. They also proposed a <italic>t</italic>-like statistics, outlined a possible hypothesis test using the classical Frequentist Statistics framework and evoked some asymptotic results for <italic>t </italic>pdf justification.</p><p>In this work we presented the Bayesian alternative for this problem and defined a theoretical model that views Baggerly's Beta-Binomial approach or even the common Binomial approach as particular cases of mixture models. Other models are possible modifying the mixing distribution, such as Beta-Poisson [<xref ref-type="bibr" rid="B14">14</xref>], or using other simplex constrained pdf [<xref ref-type="bibr" rid="B26">26</xref>] to model expression abundance. At last, but not at least, we proposed a method for ranking differentially expressed genes between two classes using the Bayes Error Rate as an intuitive measure of separation between the classes pdfs, avoiding statistical test formalism and its conceptual/practical difficulties.</p><p>We show that there are cases in which approaches that ignore within-class variability will lead to high significance in differences between tumor and normal classes, but looking carefully at individual observations jointly, one should not attribute such high significance to them since abundance probability density functions have considerable superposition.</p><p>In conclusion, we recommend that within-class variability must be taken into account in any statistical analysis of SAGE data if replicates are available. We suggest that biological replication should be considered in planning new SAGE experiments.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>General bayesian model</title><p>To start generically, suppose that the probability density function (pdf) for the random variable of interest "expression abundance" <italic>&#x003c0; </italic>&#x02208; [0;1] of some gene <italic>G </italic>is indexed in a model family by means of a parameter vector <italic><bold>&#x003b8;</bold></italic>. Therefore, following the usual Bayesian framework, the <italic>a posteriori </italic>pdf that describes the class is:</p><p><inline-graphic xlink:href="1471-2105-5-119-i3.gif"/></p><p>where: <bold>X </bold>= (<italic>x</italic><sub>1</sub>,..., <italic>x</italic><sub><italic>n</italic></sub>) is the vector of counts in all <italic>n </italic>libraries of same class, <bold>M </bold>= (<italic>m</italic><sub>1</sub>,..., <italic>m</italic><sub><italic>n</italic></sub>) is the vector of total observations in all <italic>n </italic>libraries of same class, <italic>g</italic>(&#x000b7;) is the <italic>a priori </italic>pdf, and <italic>L </italic>is the likelihood of each <italic>i</italic>-th observation. Note that the product of all likelihood functions over all observations is the so-called Likelihood Function.</p><p>The counting process from automatic sequencing is often modeled as a Binomial. Since the sample size and the stopping rule are not known in advance the model is not strictly Binomial. We do not need the combinatorial constant in the model, but we write it just because it is commonly used and will vanish in <italic>posteriori </italic>expression anyway.</p></sec><sec><title>"Pseudo-Library" method as particular case</title><p>Merging all observations from the same class libraries and constructing "pseudo-libraries", with the sum of their components, is the standard procedure to use replicates. Our general model is reduced to this (unrealistic) one if one uses <italic>f</italic>(&#x000b7;) as a Dirac's Delta in Eq.1:</p><p><inline-graphic xlink:href="1471-2105-5-119-i4.gif"/></p><p>where: <bold>1</bold>{&#x000b7;} is the indicator function.</p><p>Using Eq.4 in Eq.3 yield:</p><p><inline-graphic xlink:href="1471-2105-5-119-i5.gif"/></p><p>where: g(<italic>&#x003b8;</italic>) = 1, the non-informative uniform <italic>a priori </italic>distribution.</p><p>The expert recognizes that <italic>&#x003b8; </italic>~ Beta(1 + <bold>&#x003a3;</bold><italic>x</italic><sub><italic>i</italic></sub>, 1 + <bold>&#x003a3;</bold><italic>m</italic><sub><italic>i </italic></sub>- <bold>&#x003a3;</bold><italic>x</italic><sub><italic>i</italic></sub>), and the sum of observations is the mathematical translation of "pseudo-libraries" construction.</p></sec><sec><title>Beta-Binomial method as particular case</title><p>The only published solution that allows non-zero within-class variance in SAGE analysis is the Beta-Binomial model [<xref ref-type="bibr" rid="B12">12</xref>]. Using <italic>f</italic>(&#x000b7;) as a Beta in Eq.1 we get the Beta-Binomial model as a particular case of general model:</p><p><inline-graphic xlink:href="1471-2105-5-119-i6.gif"/></p><p>where: <italic>B</italic>(&#x000b7;) is the beta special function, and:</p><p><inline-graphic xlink:href="1471-2105-5-119-i7.gif"/></p><p>Again, an expert recognizes <italic><bold>&#x003b8;</bold></italic> = (<italic>&#x003b8;</italic><sub>1</sub>, <italic>&#x003b8;</italic><sub>2</sub>) as the mean and standard deviation (stdv) of a Beta random variable. We prefer this parameterization of Beta distributions instead of the common (<italic>&#x003b1;</italic>, <italic>&#x003b2;</italic>) one because: (i) it is much more intuitive to biologists to deal with mean and stdv than with abstract <italic>&#x003b1; </italic>and <italic>&#x003b2;</italic>, and (ii) as <italic>&#x003b1;</italic>, <italic>&#x003b2; </italic>&#x0003e; 0, the domain &#x00398; = {(<italic>&#x003b8;</italic><sub>1</sub>, <italic>&#x003b8;</italic><sub>2</sub>): 0 &#x02264; <italic>&#x003b8;</italic><sub>1 </sub>&#x02264; 1, 0 &#x02264; <italic>&#x003b8;</italic><sub>2</sub><sup>2 </sup>&#x0003c;<italic>&#x003b8;</italic><sub>1 </sub>(1- <italic>&#x003b8;</italic><sub>1</sub>) &#x02264; 1/4} is bounded and much more amenable to perform the necessary numerical computations.</p><p>Using Eq.6 in Eq.3 yield:</p><p><inline-graphic xlink:href="1471-2105-5-119-i8.gif"/></p><p>where: <italic>g</italic>(<italic>&#x003b8;</italic><sub>1</sub>, <italic>&#x003b8;</italic><sub>2</sub>) is the <italic>priori </italic>pdf.</p></sec><sec><title><italic>A Priori </italic>distribution definition</title><p>To complete a Bayesian model, it is necessary to choose the <italic>a priori </italic>pdf. We use an uniform distribution over &#x00398;. On the other hand, we know in advance that variance of this model cannot be smaller than the variance eventually obtained if we do not consider within-class variability. Even if the within-class variability is very small, it cannot be estimated as being smaller than the simple sampling error because they are inseparable, and sampling error is the lower limit [<xref ref-type="bibr" rid="B12">12</xref>]. As an illustration, the same situation could occur if one takes several diameter measurements of a folded paper ball and a perfect sphere using a common ruler. In the first case, the intrinsic nature of the measured object dominates the measurement variability but, in the second case, we cannot know the diameter of the perfect sphere with better precision than our ruler can measure.</p><p>This kind of knowledge is naturally incorporated in Bayesian statistics by means of <italic>a priori </italic>distributions. To match our desired features, it is sufficient to define an uniform over the &#x00398; parameter space but constrained at a minimum stdv &#x003c3;, obtained from the result of no within-class variance model:</p><p><inline-graphic xlink:href="1471-2105-5-119-i9.gif"/></p><p>over domain &#x00398; = {(<italic>&#x003b8;</italic><sub>1</sub>, <italic>&#x003b8;</italic><sub>2</sub>): 0 &#x02264; <italic>&#x003b8;</italic><sub>1 </sub>&#x02264; 1, 0 &#x02264; <italic>&#x003b8;</italic><sub>2</sub><sup>2 </sup>&#x0003c;<italic>&#x003b8;</italic><sub>1 </sub>(1 - <italic>&#x003b8;</italic><sub>1</sub>) &#x02264; 1/4}.</p><p>Since we showed (Eq.5) that the no within-class variance model is <italic>&#x003b8; </italic>~ Beta(1 + &#x003a3;<italic>x</italic><sub><italic>i</italic></sub>, 1 + &#x003a3;<italic>m</italic><sub><italic>i </italic></sub>- &#x003a3;<italic>x</italic><sub><italic>i</italic></sub>), it is easy to obtain our lower stdv boundary from Beta variance:</p><p><inline-graphic xlink:href="1471-2105-5-119-i10.gif"/></p><p>Therefore, using Eq.9 and Eq.10 in Eq.8, our <italic>posteriori </italic>is completely defined.</p></sec><sec><title>Differential expression detection</title><p>We detect a tag as differentially expressed using the Bayes Error Rate <italic>E </italic>[<xref ref-type="bibr" rid="B15">15</xref>] in both predictive Beta pdfs:</p><p><inline-graphic xlink:href="1471-2105-5-119-i11.gif"/></p><p>where:</p><p><inline-graphic xlink:href="1471-2105-5-119-i12.gif"/></p><p>Note that <italic>f</italic>(&#x000b7;) is the Beta pdf, as in Eq.6 development. The "hat" over <italic><bold>&#x003b8;</bold></italic> = (<italic>&#x003b8;</italic><sub>1</sub>, <italic>&#x003b8;</italic><sub>2</sub>) indicates values that leads Eq.8 to maximum. As usual, the maximization, subject to constrain &#x00398; defined previously, is made upon logarithm of <italic>posteriori's </italic>core since it gives the same estimates as the <italic>posteriori </italic>itself:</p><p><inline-graphic xlink:href="1471-2105-5-119-i13.gif"/></p><p>Figure <xref ref-type="fig" rid="F5">5</xref> shows an example of this process. See Results section to get an intuitive notion of this evidence measure.</p></sec><sec><title>Implementation &#x02013; numerical analysis</title><p>The method was implemented as R language [<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B28">28</xref>] scripts which are freely available under GPL/GNU copyleft license at supplemental web site [<xref ref-type="bibr" rid="B23">23</xref>]. At this web page there are details on how to run it locally.</p><p>Our method is computer-intensive mainly because some numeric maximization and integration are needed. We used efficient R built-in routines to perform such numerical tasks. Remember that maximization needed in Eq.12 is constrained, thus we used simply auxiliary re-parameterization to obtain linear constrains and used the constrOptim R routine. For numerical integration we used the 1-dimensional gaussian quadrature integrate R built-in function. Although numerical integration of Eq.9 should be performed in all [0;1] support, the relevant contribution for this integral is concentrated in a much smaller region. Integrating over the formal limits will cause serious numerical errors, and to avoid this problem we approximate our integration region to an interval delimited by 0.005 and 0.995 quantile of each Beta pdf since the relevant density lie in there.</p><p>The credibility intervals ("error-bars") for the expression ratio of interesting tags were obtained as described in our recent work [<xref ref-type="bibr" rid="B16">16</xref>]. We chose arbitrarily 68% credibility intervals.</p></sec><sec><title>Implementation &#x02013; Web based interface</title><p>We have also developed an easy-to-use web-based service that performs all calculations at our server and provides password-protected results. Although desirable, for the sake of automatic web hyperlink with SAGE Genie database, it is not necessary to explicitly identify the tags analyzed but rather any (custom) i.d. string. This could increase privacy or make our web-interface useful for "Digital-Northern", MPSS or any mathematically related problem of mixtures from binomial sampling. Figure <xref ref-type="fig" rid="F6">6</xref> shows snapshots of the interface.</p></sec><sec><title>Publically available data</title><p>The Table <xref ref-type="table" rid="T1">1</xref> list the SAGE Genie's library name, Gene Expression Omnibus (GEO) [<xref ref-type="bibr" rid="B29">29</xref>] accession code and size of all used libraries.</p><p>For our aims, it is sufficient to focus the analysis at the tag level. Thus, we process the tag counts and let the identification of tag's best gene match as a posterior question that could be carefully done only to really interesting tags. We choose not to process tags whose counts appear only in libraries of one class. It is important to note that all libraries are from bulk material, without cell-lines, and came from patients with similar disease description. The normal libraries came from different normal regions of the brain.</p><p>We think that this data set is very illustrative since there are biological replicates in the tumor class allowing clear verification of within-class biological variability. On the other hand, taking only one kind of disease, astrocytoma grade III, instead of all brain tumors in the database, leads one to believe that the within-class variability is in fact due to biological diversity of the patients and not due to very distinct molecular profile of distinct brain tumors stored in SAGE Genie's database.</p><p>Therefore, we believe that this <italic>in silico </italic>comparison is well-suited to demonstrate the necessity of dealing with within-class effect, although it is not our aim here to make a detailed or biological analysis of brain tumor data.</p></sec><sec><title>Comparison with other methods</title><p>To bring some intuition about our differential expression evidence measure, we tabulated evidence measure obtained from the famous Fisher Exact Test, the classical Pearson's <italic>&#x003c7;</italic><sup>2 </sup>proportion test and the bayesian Audic-Claverie's method. All these tests were performed using the easy-to-use web-interface IDEG6 [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>].</p><p>The "<italic>P</italic>-values" are conceptually very different from our evidence measure but are the most used evidence measures. Although numbers cannot be compared, the conclusions obtained from these methods should be since graphical representation of each library observation gives clear indication of incoherence of "pseudo-library" methods. The results of the significance measures for all tags are available as additional Excel<sup>&#x000a9; </sup>or OpenOffice<sup>&#x000a9; </sup>interactive files in which the user can set cutoffs for the significance measures, and explore the differences in conclusions.</p><p>We carry out a qualitative comparison of our method with Baggerly <italic>et al. </italic>[<xref ref-type="bibr" rid="B12">12</xref>]<italic>t</italic>-test approximation in a graphical way since it is impossible to judge them without the unknown true status of analyzed tags, given the too different interpretation of numeric values returned. In their Frequentist framework, the estimator <italic>p</italic><sub><italic>i </italic></sub>= <italic>x</italic><sub><italic>i</italic></sub>/<italic>m</italic><sub><italic>i </italic></sub>is used for <italic>&#x003c0;</italic><sub><italic>i </italic></sub>and a linear combination of these abundances is proposed as the correct way to combine results from different libraries:</p><p><inline-graphic xlink:href="1471-2105-5-119-i14.gif"/></p><p>where <italic>w</italic><sub><italic>i </italic></sub>are the weights that yield an unbiased minimum variance estimator <italic>V</italic><sub><italic>u </italic></sub>for weighted proportion's variance and <italic><bold>&#x003b8;</bold></italic> = (<italic>&#x003b1;</italic>, <italic>&#x003b2;</italic>) are the Beta pdf parameters. However, this unbiased variance could be unrealistically small when it becomes smaller than the sampling variability. We know that the variance of this model cannot be smaller than the variance eventually obtained if we do not consider within-class variability. Therefore, they propose the final <italic>ad hoc </italic>estimator:</p><p><italic>V </italic>= max [<italic>V</italic><sub><italic>u</italic></sub>; <italic>V</italic><sub><italic>pseudo-lib</italic></sub>] &#x000a0;&#x000a0;&#x000a0; (14)</p><p>where:</p><p><inline-graphic xlink:href="1471-2105-5-119-i15.gif"/></p><p>The max(&#x000b7;) function assure that <italic>V </italic>is not unrealistic small when <italic>V</italic><sub><italic>u </italic></sub>is unrealistic small. To <italic>fit </italic>all these parameters, they used the computationally practical Method of Moments. Once <italic>p</italic><sub>A</sub>, <italic>p</italic><sub>B</sub>, <italic>V</italic><sub>A </sub>and <italic>V</italic><sub>B </sub>are found for classes A and B, these authors test if the proportions are significantly different proposing the use of a <italic>t</italic><sub><italic>w </italic></sub>statistics as following a Student's <italic>t</italic><sub><italic>df </italic></sub>pdf:</p><p><inline-graphic xlink:href="1471-2105-5-119-i16.gif"/></p></sec></sec><sec><title>List of Abbreviations</title><p>SAGE: Serial Analysis of Gene Expression</p><p>MPSS: Massively Parallel Signature Sequencing</p><p>EST: Expressed Sequence Tag</p><p>pdf: probability density function</p><p>GEO: Gene Expression Omnibus</p></sec><sec><title>Authors' Contributions</title><p>RV conceived and executed this work. HB helped with all biological issues. DFCP helped in differential expression detection methods and implemented the on-line web-based tool. CABP helped with Bayesian statistics and proposed the mixture ideas.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional File 1</title><p><bold>Results for all evidence measures</bold>. This file allows the user to interactively define significance cutoffs for ranked tags. The ranks are based on evidence measures against "no differential expression" hypothesis, i.e., evidences closer to 0 (zero) denote higher confidence in differential expression and closer to 1 (one) denote no evidence of differential expression.</p></caption><media xlink:href="1471-2105-5-119-S1.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><ack><sec><title>Acknowledgements</title><p>RV is supported by FAPESP 02/04698-8 fellowship. We thank Tie Koide for critical reading of the manuscript and BIOINFO-USP/Rede-Vision for computational support.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Velculescu</surname><given-names>VE</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name></person-group><article-title>Serial analysis of gene expression</article-title><source>Science</source><year>1995</year><volume>270</volume><fpage>484</fpage><lpage>487</lpage><pub-id pub-id-type="pmid">7570003</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Margulies</surname><given-names>EH</given-names></name><name><surname>Kardia</surname><given-names>SL</given-names></name><name><surname>Innis</surname><given-names>JW</given-names></name></person-group><article-title>Identification and prevention of a GC content bias in SAGE libraries</article-title><source>Nucleic Acids Res</source><year>2001</year><volume>29</volume><fpage>e60</fpage><pub-id pub-id-type="pmid">11410683</pub-id><pub-id pub-id-type="doi">10.1093/nar/29.12.e60</pub-id></citation></ref><ref id="B3"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stern</surname><given-names>MD</given-names></name><name><surname>Anisimov</surname><given-names>SV</given-names></name><name><surname>Boheler</surname><given-names>KR</given-names></name></person-group><article-title>Can transcriptome size be estimated from SAGE catalogs?</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>443</fpage><lpage>448</lpage><pub-id pub-id-type="pmid">12611798</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg018</pub-id></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Stollberg</surname><given-names>J</given-names></name><name><surname>Urschitz</surname><given-names>J</given-names></name><name><surname>Urban</surname><given-names>Z</given-names></name><name><surname>Boyd</surname><given-names>CD</given-names></name></person-group><article-title>A Quantitative Evaluation of SAGE</article-title><source>Genome Research</source><year>2000</year><volume>10</volume><fpage>1241</fpage><lpage>1248</lpage><pub-id pub-id-type="pmid">10958642</pub-id><pub-id pub-id-type="doi">10.1101/gr.10.8.1241</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Akmaev</surname><given-names>VR</given-names></name><name><surname>Wang</surname><given-names>CJ</given-names></name></person-group><article-title>Correction of sequence based artifacts in serial analysis of gene expression</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><fpage>1254</fpage><lpage>1263</lpage><pub-id pub-id-type="pmid">14871862</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/bth077</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>JS</given-names></name><name><surname>Baggerly</surname><given-names>KA</given-names></name><name><surname>Coombes</surname><given-names>KR</given-names></name></person-group><article-title>Bayesian shrinkage estimation of the relative abundance of mRNA transcipts using SAGE</article-title><source>Biometrics</source><year>2003</year><volume>59</volume><fpage>476</fpage><lpage>486</lpage><pub-id pub-id-type="pmid">14601748</pub-id><pub-id pub-id-type="doi">10.1111/1541-0420.00057</pub-id></citation></ref><ref id="B7"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Blades</surname><given-names>NJ</given-names></name><name><surname>Jones</surname><given-names>JB</given-names></name><name><surname>Kern</surname><given-names>SE</given-names></name><name><surname>Parmigiani</surname><given-names>G</given-names></name></person-group><article-title>Denoising of data from serial analysis of gene expression</article-title><source>Bioinformatics</source><comment></comment></citation></ref><ref id="B8"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname><given-names>S</given-names></name><name><surname>Johnson</surname><given-names>M</given-names></name><name><surname>Bridgham</surname><given-names>J</given-names></name></person-group><article-title>Gene expression analysis by massively parallel signature sequencing (MPSS) on microbead arrays</article-title><source>Nature Biotechnology</source><year>2000</year><volume>18</volume><fpage>630</fpage><lpage>634</lpage><pub-id pub-id-type="pmid">10835600</pub-id><pub-id pub-id-type="doi">10.1038/76469</pub-id></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Man</surname><given-names>MZ</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><article-title>POWER_SAGE: comparing statistical tests for SAGE experiments</article-title><source>Bioinfo matics</source><year>2000</year><volume>16</volume><fpage>953</fpage><lpage>959</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/16.11.953</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Romualdi</surname><given-names>C</given-names></name><name><surname>Bortoluzzi</surname><given-names>S</given-names></name><name><surname>Danieli</surname><given-names>GA</given-names></name></person-group><article-title>Detecting differentially expressed genes in multiple tag sampling experiments: comparative evaluation of statistical tests</article-title><source>Hum Mol Genet</source><year>2001</year><volume>19</volume><fpage>2133</fpage><lpage>2141</lpage><pub-id pub-id-type="doi">10.1093/hmg/10.19.2133</pub-id></citation></ref><ref id="B11"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ruijter</surname><given-names>JM</given-names></name><name><surname>Kampen</surname><given-names>AHC</given-names></name><name><surname>Baas</surname><given-names>F</given-names></name></person-group><article-title>Statistical evaluation of SAGE libraries: consequences for experimental design</article-title><source>Physiol Genomics</source><year>2002</year><volume>11</volume><fpage>37</fpage><lpage>44</lpage><pub-id pub-id-type="pmid">12407185</pub-id></citation></ref><ref id="B12"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Baggerly</surname><given-names>KA</given-names></name><name><surname>Deng</surname><given-names>L</given-names></name><name><surname>Morris</surname><given-names>JS</given-names></name><name><surname>Aldaz</surname><given-names>CM</given-names></name></person-group><article-title>Differential expression in SAGE: accounting for normal between-library variation</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>1477</fpage><lpage>1483</lpage><pub-id pub-id-type="pmid">12912827</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg173</pub-id></citation></ref><ref id="B13"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Aitchison</surname><given-names>J</given-names></name><name><surname>Dunsmore</surname><given-names>IR</given-names></name></person-group><source>Statistical Prediction Analysis</source><year>1975</year><publisher-name>Cambridge: Cambridge University Press</publisher-name></citation></ref><ref id="B14"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bueno</surname><given-names>AMS</given-names></name><name><surname>Pereira</surname><given-names>CAB</given-names></name><name><surname>Rabello-Gay</surname><given-names>MN</given-names></name><name><surname>Stern</surname><given-names>JM</given-names></name></person-group><article-title>Environmental genotoxicity evaluation: Bayesian approach for a mixture statistical model</article-title><source>Stochastic Environmental Research and Risk Assessment</source><year>2002</year><volume>16</volume><fpage>267</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1007/s00477-002-0100-x</pub-id></citation></ref><ref id="B15"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Duda</surname><given-names>RO</given-names></name><name><surname>Hart</surname><given-names>PE</given-names></name><name><surname>Stork</surname><given-names>DG</given-names></name></person-group><source>Pattern Classification</source><year>2000</year><edition>2</edition><publisher-name>New York: Wiley-Interscience Press</publisher-name></citation></ref><ref id="B16"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>V&#x000ea;ncio</surname><given-names>RZN</given-names></name><name><surname>Brentani</surname><given-names>H</given-names></name><name><surname>Pereira</surname><given-names>CAB</given-names></name></person-group><article-title>Using credibility intervals instead of hypothesis tests in SAGE analysis</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>2461</fpage><lpage>2464</lpage><pub-id pub-id-type="pmid">14668232</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg357</pub-id></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Yeung</surname><given-names>KY</given-names></name><name><surname>Medvedociv</surname><given-names>M</given-names></name><name><surname>Bumgarner</surname><given-names>RE</given-names></name></person-group><article-title>Clustering gene-expression data with repeated measurements</article-title><source>Genome Biology</source><year>2003</year><volume>4</volume><fpage>R34.1</fpage><lpage>R34.17</lpage><pub-id pub-id-type="pmid">12734014</pub-id></citation></ref><ref id="B18"><citation citation-type="other"><article-title>SAGE Genie Home Page</article-title><ext-link ext-link-type="uri" xlink:href="http://cgap.nci.nih.gov/SAGE"/></citation></ref><ref id="B19"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Boon</surname><given-names>K</given-names></name><name><surname>Os&#x000f3;rio</surname><given-names>EC</given-names></name><name><surname>Greenhut</surname><given-names>SF</given-names></name><name><surname>Schaefer</surname><given-names>CF</given-names></name><name><surname>Shoemaker</surname><given-names>J</given-names></name><name><surname>Polyak</surname><given-names>K</given-names></name><name><surname>Morin</surname><given-names>PJ</given-names></name><name><surname>Buetow</surname><given-names>KH</given-names></name><name><surname>Strausberg</surname><given-names>RL</given-names></name><name><surname>Souza</surname><given-names>SJ</given-names></name><name><surname>Riggins</surname><given-names>GJ</given-names></name></person-group><article-title>An anatomy of normal and malignant gene expression</article-title><source>Proc Natl Acad Sci USA</source><year>2002</year><volume>99</volume><fpage>11287</fpage><lpage>11292</lpage><pub-id pub-id-type="pmid">12119410</pub-id><pub-id pub-id-type="doi">10.1073/pnas.152324199</pub-id></citation></ref><ref id="B20"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Audic</surname><given-names>S</given-names></name><name><surname>Claverie</surname><given-names>J</given-names></name></person-group><article-title>The significance of digital gene expression profiles</article-title><source>Genome Research</source><year>1997</year><volume>7</volume><fpage>986</fpage><lpage>995</lpage><pub-id pub-id-type="pmid">9331369</pub-id></citation></ref><ref id="B21"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Romualdi</surname><given-names>C</given-names></name><name><surname>Bortoluzzi</surname><given-names>S</given-names></name><name><surname>D'Alessi</surname><given-names>F</given-names></name><name><surname>Danieli</surname><given-names>GA</given-names></name></person-group><article-title>IDEG6: a web tool for detection of differentially expressed genes in multiple tag sampling experiments</article-title><source>Physiol Genomics</source><year>2003</year><volume>12</volume><fpage>159</fpage><lpage>162</lpage><pub-id pub-id-type="pmid">12429865</pub-id></citation></ref><ref id="B22"><citation citation-type="other"><article-title>IDEG6 Home Page</article-title><ext-link ext-link-type="uri" xlink:href="http://telethon.bio.unipd.it/bioinfo/IDEG6_form/"/></citation></ref><ref id="B23"><citation citation-type="other"><article-title>SAGEbetaBin Home Page</article-title><ext-link ext-link-type="uri" xlink:href="http://www.vision.ime.usp.br/~rvencio/SAGEbetaBin"/></citation></ref><ref id="B24"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Lal</surname><given-names>A</given-names></name><name><surname>Lash</surname><given-names>AE</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Velculescu</surname><given-names>V</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>McLendon</surname><given-names>RE</given-names></name><name><surname>Marra</surname><given-names>MA</given-names></name><name><surname>Prange</surname><given-names>C</given-names></name><name><surname>Morin</surname><given-names>PJ</given-names></name><name><surname>Polyak</surname><given-names>K</given-names></name><name><surname>Papadopoulos</surname><given-names>N</given-names></name><name><surname>Vogelstein</surname><given-names>B</given-names></name><name><surname>Kinzler</surname><given-names>KW</given-names></name><name><surname>Strausberg</surname><given-names>RL</given-names></name><name><surname>Riggins</surname><given-names>GJ</given-names></name></person-group><article-title>A public database for gene expression in human cancers</article-title><source>Cancer Research</source><year>1999</year><volume>21</volume><fpage>5403</fpage><lpage>5407</lpage></citation></ref><ref id="B25"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Centola</surname><given-names>M</given-names></name><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Metzger</surname><given-names>H</given-names></name></person-group><article-title>Characterization of gene expression in resting and activated mast cells</article-title><source>J Exp Med</source><year>1998</year><volume>188</volume><fpage>1657</fpage><lpage>1668</lpage><pub-id pub-id-type="pmid">9802978</pub-id><pub-id pub-id-type="doi">10.1084/jem.188.9.1657</pub-id></citation></ref><ref id="B26"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Aitchison</surname><given-names>J</given-names></name></person-group><article-title>A General class of distributions on the simplex</article-title><source>J R Statistical Soc B</source><year>1985</year><volume>47</volume><fpage>136</fpage><lpage>146</lpage></citation></ref><ref id="B27"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Ihaka</surname><given-names>R</given-names></name><name><surname>Gentleman</surname><given-names>R</given-names></name></person-group><article-title>R: A language for data analysis and graphics</article-title><source>Journal of Computational and Graphical Statistics</source><year>1996</year><volume>5</volume><fpage>299</fpage><lpage>314</lpage></citation></ref><ref id="B28"><citation citation-type="other"><article-title>R project Home Page</article-title><ext-link ext-link-type="uri" xlink:href="http://r-project.org"/></citation></ref><ref id="B29"><citation citation-type="other"><article-title>Gene Expression Omnibus Home Page</article-title><ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo"/></citation></ref></ref-list><sec sec-type="display-objects"><title>Figures and Tables</title><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>The Bayes Error Rate illustration</bold>. This figure shows two illustrations of the proposed use of Bayes Error Rate <italic>E </italic>to define differentially expressing genes based on pdf of expression abundance <italic>&#x003c0;</italic>. The left example shows an obvious superposition of classes' pdf, thus a gene having this profile does not present evidence of differential expression between classes. The right example shows two pdfs "far apart" and genes with this kind of behaviour should be safely considered differentially expressing between two classes.</p></caption><graphic xlink:href="1471-2105-5-119-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Maximum <italic>a posteriori </italic>Beta pdfs of classes in main prototype cases</bold>. The predictive pdf and the Bayes Error Rate <italic>E </italic>of both tumoral (T) and normal (N) classes, for examples tags contained in the three important prototype cases described in text, are shown in the figure. The 'x' and 'o' marks represent observed abundances in each tumoral and normal. Frame a) shows case (i) example when methods agree with "no differential expression" conclusion. Frame b) shows case (ii) example when methods agree with "differential expression" conclusion. Frame c) and d) show case (iii) examples when classical <italic>P</italic>-value method leads to significant differential expression between classes and our method indicates pdf superposition if one take within-class variability into account. Individual observations indicate that the classes are not clearly divided, casting doubt on "differential expression" conclusion.</p></caption><graphic xlink:href="1471-2105-5-119-2"/></fig><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Effect of "small" size libraries on the final result. </bold>The predictive pdf and the Bayes Error Rate <italic>E </italic>of both tumoral (T) and normal (N) classes for examples tags contained in the three important prototype cases described in text are shown. The 'x' and 'o' marks represent observed abundances in each tumoral and normal libraries. Frame a) shows the result using all libraries. The "small" libraries (size &#x0003c; 50,000) are highlighted with their counts over library size. Frame b) shows results excluding those "small" libraries. It is clear that results are pretty much the same and that "small" libraries are not (necessarily) outliers of the sampling.</p></caption><graphic xlink:href="1471-2105-5-119-3"/></fig><fig position="float" id="F4"><label>Figure 4</label><caption><p><bold>Qualitative comparison of Bayes Error Rate and <italic>t</italic>-test approximation. </bold>It is shown the Bayes Error Rate (<italic>E</italic>) versus the <italic>t</italic>-test approximation <italic>P</italic>-value (Baggerly) [12] for each tag. The red lines are arbitrary cutoffs that define significance regions E &#x02264; 0.1 and Baggerly &#x02264; 0.01. The green line is a LOWESS trend fit.</p></caption><graphic xlink:href="1471-2105-5-119-4"/></fig><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Illustration of Maximum <italic>a Posteriori </italic>parameter estimation. </bold>The maximum a posteriori parameters of Eq.12 in an artificial example it is shown. The bi-dimensional pdf from which "hat" (pointed by the arrow) parameters are extracted is proportional to that described in Eq.8.</p></caption><graphic xlink:href="1471-2105-5-119-5"/></fig><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Snapshot of the web-interface for our SAGEbetaBin method. </bold>An illustration of on-line tool implemented to make our method easily available it is shown. Researchers submit their data (A) and receive, by e-mail, an alert when we finished the job along with instructions to get results in a password-protected web-page (B). If the ID supplied is a human tag (C), then results are linked with SAGE genies' tag-to-gene map. The individual observations graphics, as utilized in this work, is available on-demand (D).</p></caption><graphic xlink:href="1471-2105-5-119-6"/></fig><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Brain tumor and normal libraries from SAGE Genie used as real data application.</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="left"><bold>#</bold></td><td align="left"><bold>Library Name</bold></td><td align="center"><bold>GEO accession</bold></td><td align="center"><bold>Total Tags</bold></td></tr></thead><tbody><tr><td align="left">1</td><td align="left">SAGE_Brain_astrocytoma_grade_III_B_H1020</td><td align="center">GSM697</td><td align="right">51573</td></tr><tr><td align="left">2</td><td align="left">SAGE_Brain_astrocytoma_grade_III_B_H970</td><td align="center">GSM14763</td><td align="right">106982</td></tr><tr><td align="left">3</td><td align="left">SAGE_Brain_astrocytoma_grade_III_B_R140</td><td align="center">GSM14773</td><td align="right">118733</td></tr><tr><td align="left">4</td><td align="left">SAGE_Brain_astrocytoma_grade_III_B_R927</td><td align="center">GSM14766</td><td align="right">107344</td></tr><tr><td align="left">5</td><td align="left">SAGE_Brain_normal_cerebellum_B_1</td><td align="center">GSM761</td><td align="right">50385</td></tr><tr><td align="left">6</td><td align="left">SAGE_Brain_normal_cerebellum_B_BB542</td><td align="center">GSM695</td><td align="right">40500</td></tr><tr><td align="left">7</td><td align="left">SAGE_Brain_normal_cortex_B_BB542</td><td align="center">GSM676</td><td align="right">94233</td></tr><tr><td align="left">8</td><td align="left">SAGE_Brain_normal_cortex_B_pool6</td><td align="center">GSM763</td><td align="right">62451</td></tr><tr><td align="left">9</td><td align="left">SAGE_Brain_normal_peds_cortex_B_H1571</td><td align="center">GSM786</td><td align="right">77554</td></tr><tr><td align="left">10</td><td align="left">SAGE_Brain_normal_substantia_nigra_B_1</td><td align="center">GSM14796</td><td align="right">42498</td></tr><tr><td align="left">11</td><td align="left">SAGE_Brain_normal_thalamus_B_1</td><td align="center">GSM713</td><td align="right">24015</td></tr></tbody></table></table-wrap></sec></back></article>



